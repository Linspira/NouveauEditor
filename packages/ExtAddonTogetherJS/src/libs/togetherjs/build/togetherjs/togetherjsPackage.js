/*! togetherjs 2014-02-27 */
!function(){var a,b,c;!function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=s.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[];if(f=f||a,"function"==typeof c){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c.apply(q[a],u),a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){return"string"==typeof a?p[a]?p[a](b):j(o(a,b).f):(a.splice||(s=a,b.splice?(a=b,b=c,c=null):a=d),b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n)},n.config=function(a){return s=a,s.deps&&n(s.deps,s.callback),n},c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("libs/almond",function(){}),function(){!function(a,b){function d(a){var b=pb[a]={};return _.each(a.split(cb),function(a,c){b[c]=!0}),b}function e(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(rb,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:qb.test(d)?_.parseJSON(d):d}catch(f){}_.data(a,c,d)}else d=b}return d}function f(a){var b;for(b in a)if(("data"!==b||!_.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function g(){return!1}function h(){return!0}function i(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function j(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function k(a,b,c){if(b=b||0,_.isFunction(b))return _.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return _.grep(a,function(a){return a===b===c});if("string"==typeof b){var d=_.grep(a,function(a){return 1===a.nodeType});if(Lb.test(b))return _.filter(b,d,!c);b=_.filter(b,d)}return _.grep(a,function(a){return _.inArray(a,b)>=0===c})}function l(a){var b=Ob.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function m(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function n(a,b){if(1===b.nodeType&&_.hasData(a)){var c,d,e,f=_._data(a),g=_._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)_.event.add(b,c,h[c][d])}g.data&&(g.data=_.extend({},g.data))}}function o(a,b){var c;1===b.nodeType&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),_.support.html5Clone&&a.innerHTML&&!_.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&Yb.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.selected=a.defaultSelected:"input"===c||"textarea"===c?b.defaultValue=a.defaultValue:"script"===c&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(_.expando))}function p(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll("*"):[]}function q(a){Yb.test(a.type)&&(a.defaultChecked=a.checked)}function r(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=sc.length;e--;)if(b=sc[e]+c,b in a)return b;return d}function s(a,b){return a=b||a,"none"===_.css(a,"display")||!_.contains(a.ownerDocument,a)}function t(a,b){for(var c,d,e=[],f=0,g=a.length;g>f;f++)c=a[f],c.style&&(e[f]=_._data(c,"olddisplay"),b?(!e[f]&&"none"===c.style.display&&(c.style.display=""),""===c.style.display&&s(c)&&(e[f]=_._data(c,"olddisplay",x(c.nodeName)))):(d=dc(c,"display"),!e[f]&&"none"!==d&&_._data(c,"olddisplay",d)));for(f=0;g>f;f++)c=a[f],c.style&&(b&&"none"!==c.style.display&&""!==c.style.display||(c.style.display=b?e[f]||"":"none"));return a}function u(a,b,c){var d=lc.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function v(a,b,c,d){for(var e=c===(d?"border":"content")?4:"width"===b?1:0,f=0;4>e;e+=2)"margin"===c&&(f+=_.css(a,c+rc[e],!0)),d?("content"===c&&(f-=parseFloat(dc(a,"padding"+rc[e]))||0),"margin"!==c&&(f-=parseFloat(dc(a,"border"+rc[e]+"Width"))||0)):(f+=parseFloat(dc(a,"padding"+rc[e]))||0,"padding"!==c&&(f+=parseFloat(dc(a,"border"+rc[e]+"Width"))||0));return f}function w(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,e=!0,f=_.support.boxSizing&&"border-box"===_.css(a,"boxSizing");if(0>=d||null==d){if(d=dc(a,b),(0>d||null==d)&&(d=a.style[b]),mc.test(d))return d;e=f&&(_.support.boxSizingReliable||d===a.style[b]),d=parseFloat(d)||0}return d+v(a,b,c||(f?"border":"content"),e)+"px"}function x(a){if(oc[a])return oc[a];var b=_("<"+a+">").appendTo(Q.body),c=b.css("display");return b.remove(),("none"===c||""===c)&&(ec=Q.body.appendChild(ec||_.extend(Q.createElement("iframe"),{frameBorder:0,width:0,height:0})),fc&&ec.createElement||(fc=(ec.contentWindow||ec.contentDocument).document,fc.write("<!doctype html><html><body>"),fc.close()),b=fc.body.appendChild(fc.createElement(a)),c=dc(b,"display"),Q.body.removeChild(ec)),oc[a]=c,c}function y(a,b,c,d){var e;if(_.isArray(b))_.each(b,function(b,e){c||vc.test(a)?d(a,e):y(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==_.type(b))d(a,b);else for(e in b)y(a+"["+e+"]",b[e],c,d)}function z(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e,f,g=b.toLowerCase().split(cb),h=0,i=g.length;if(_.isFunction(c))for(;i>h;h++)d=g[h],f=/^\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}function A(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;for(var h,i=a[f],j=0,k=i?i.length:0,l=a===Lc;k>j&&(l||!h);j++)h=i[j](c,d,e),"string"==typeof h&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=A(a,c,d,e,h,g)));return(l||!h)&&!g["*"]&&(h=A(a,c,d,e,"*",g)),h}function B(a,c){var d,e,f=_.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&_.extend(!0,a,e)}function C(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k)f in d&&(c[k[f]]=d[f]);for(;"*"===j[0];)j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"));if(e)for(f in i)if(i[f]&&i[f].test(e)){j.unshift(f);break}if(j[0]in d)g=j[0];else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}return g?(g!==j[0]&&j.unshift(g),d[g]):void 0}function D(a,b){var c,d,e,f,g=a.dataTypes.slice(),h=g[0],i={},j=0;if(a.dataFilter&&(b=a.dataFilter(b,a.dataType)),g[1])for(c in a.converters)i[c.toLowerCase()]=a.converters[c];for(;e=g[++j];)if("*"!==e){if("*"!==h&&h!==e){if(c=i[h+" "+e]||i["* "+e],!c)for(d in i)if(f=d.split(" "),f[1]===e&&(c=i[h+" "+f[0]]||i["* "+f[0]])){c===!0?c=i[d]:i[d]!==!0&&(e=f[0],g.splice(j--,0,e));break}if(c!==!0)if(c&&a["throws"])b=c(b);else try{b=c(b)}catch(k){return{state:"parsererror",error:c?k:"No conversion from "+h+" to "+e}}}h=e}return{state:"success",data:b}}function E(){try{return new a.XMLHttpRequest}catch(b){}}function F(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function G(){return setTimeout(function(){Wc=b},0),Wc=_.now()}function H(a,b){_.each(b,function(b,c){for(var d=(ad[b]||[]).concat(ad["*"]),e=0,f=d.length;f>e;e++)if(d[e].call(a,b,c))return})}function I(a,b,c){var d,e=0,f=_c.length,g=_.Deferred().always(function(){delete h.elem}),h=function(){for(var b=Wc||G(),c=Math.max(0,i.startTime+i.duration-b),d=c/i.duration||0,e=1-d,f=0,h=i.tweens.length;h>f;f++)i.tweens[f].run(e);return g.notifyWith(a,[i,e,c]),1>e&&h?c:(g.resolveWith(a,[i]),!1)},i=g.promise({elem:a,props:_.extend({},b),opts:_.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Wc||G(),duration:c.duration,tweens:[],createTween:function(b,c){var d=_.Tween(a,i.opts,b,c,i.opts.specialEasing[b]||i.opts.easing);return i.tweens.push(d),d},stop:function(b){for(var c=0,d=b?i.tweens.length:0;d>c;c++)i.tweens[c].run(1);return b?g.resolveWith(a,[i,b]):g.rejectWith(a,[i,b]),this}}),j=i.props;for(J(j,i.opts.specialEasing);f>e;e++)if(d=_c[e].call(i,a,j,i.opts))return d;return H(i,j),_.isFunction(i.opts.start)&&i.opts.start.call(a,i),_.fx.timer(_.extend(h,{anim:i,queue:i.opts.queue,elem:a})),i.progress(i.opts.progress).done(i.opts.done,i.opts.complete).fail(i.opts.fail).always(i.opts.always)}function J(a,b){var c,d,e,f,g;for(c in a)if(d=_.camelCase(c),e=b[d],f=a[c],_.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=_.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function K(a,b,c){var d,e,f,g,h,i,j,k,l,m=this,n=a.style,o={},p=[],q=a.nodeType&&s(a);c.queue||(k=_._queueHooks(a,"fx"),null==k.unqueued&&(k.unqueued=0,l=k.empty.fire,k.empty.fire=function(){k.unqueued||l()}),k.unqueued++,m.always(function(){m.always(function(){k.unqueued--,_.queue(a,"fx").length||k.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],"inline"===_.css(a,"display")&&"none"===_.css(a,"float")&&(_.support.inlineBlockNeedsLayout&&"inline"!==x(a.nodeName)?n.zoom=1:n.display="inline-block")),c.overflow&&(n.overflow="hidden",_.support.shrinkWrapBlocks||m.done(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(f=b[d],Yc.exec(f)){if(delete b[d],i=i||"toggle"===f,f===(q?"hide":"show"))continue;p.push(d)}if(g=p.length){h=_._data(a,"fxshow")||_._data(a,"fxshow",{}),"hidden"in h&&(q=h.hidden),i&&(h.hidden=!q),q?_(a).show():m.done(function(){_(a).hide()}),m.done(function(){var b;_.removeData(a,"fxshow",!0);for(b in o)_.style(a,b,o[b])});for(d=0;g>d;d++)e=p[d],j=m.createTween(e,q?h[e]:0),o[e]=h[e]||_.style(a,e),e in h||(h[e]=j.start,q&&(j.end=j.start,j.start="width"===e||"height"===e?1:0))}}function L(a,b,c,d,e){return new L.prototype.init(a,b,c,d,e)}function M(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=rc[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function N(a){return _.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var O,P,Q=a.document,R=a.location,S=a.navigator,T=a.jQuery,U=a.$,V=Array.prototype.push,W=Array.prototype.slice,X=Array.prototype.indexOf,Y=Object.prototype.toString,Z=Object.prototype.hasOwnProperty,$=String.prototype.trim,_=function(a,b){return new _.fn.init(a,b,O)},ab=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,bb=/\S/,cb=/\s+/,db=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,eb=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,fb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,gb=/^[\],:{}\s]*$/,hb=/(?:^|:|,)(?:\s*\[)+/g,ib=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,jb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,kb=/^-ms-/,lb=/-([\da-z])/gi,mb=function(a,b){return(b+"").toUpperCase()},nb=function(){Q.addEventListener?(Q.removeEventListener("DOMContentLoaded",nb,!1),_.ready()):"complete"===Q.readyState&&(Q.detachEvent("onreadystatechange",nb),_.ready())},ob={};_.fn=_.prototype={constructor:_,init:function(a,c,d){var e,f,g;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("string"==typeof a){if(e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:eb.exec(a),e&&(e[1]||!c)){if(e[1])return c=c instanceof _?c[0]:c,g=c&&c.nodeType?c.ownerDocument||c:Q,a=_.parseHTML(e[1],g,!0),fb.test(e[1])&&_.isPlainObject(c)&&this.attr.call(a,c,!0),_.merge(this,a);if(f=Q.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return d.find(a);this.length=1,this[0]=f}return this.context=Q,this.selector=a,this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return _.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),_.makeArray(a,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return W.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=_.merge(this.constructor(),a);return d.prevObject=this,d.context=this.context,"find"===b?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return _.each(this,a,b)},ready:function(a){return _.ready.promise().done(a),this},eq:function(a){return a=+a,-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(W.apply(this,arguments),"slice",W.call(arguments).join(","))},map:function(a){return this.pushStack(_.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:[].sort,splice:[].splice},_.fn.init.prototype=_.fn,_.extend=_.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"!=typeof h&&!_.isFunction(h)&&(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(a=arguments[i]))for(c in a)d=h[c],e=a[c],h!==e&&(k&&e&&(_.isPlainObject(e)||(f=_.isArray(e)))?(f?(f=!1,g=d&&_.isArray(d)?d:[]):g=d&&_.isPlainObject(d)?d:{},h[c]=_.extend(k,g,e)):e!==b&&(h[c]=e));return h},_.extend({noConflict:function(b){return a.$===_&&(a.$=U),b&&a.jQuery===_&&(a.jQuery=T),_},isReady:!1,readyWait:1,holdReady:function(a){a?_.readyWait++:_.ready(!0)},ready:function(a){if(a===!0?!--_.readyWait:!_.isReady){if(!Q.body)return setTimeout(_.ready,1);_.isReady=!0,a!==!0&&--_.readyWait>0||(P.resolveWith(Q,[_]),_.fn.trigger&&_(Q).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===_.type(a)},isArray:Array.isArray||function(a){return"array"===_.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):ob[Y.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==_.type(a)||a.nodeType||_.isWindow(a))return!1;try{if(a.constructor&&!Z.call(a,"constructor")&&!Z.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||Z.call(a,d)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){var d;return a&&"string"==typeof a?("boolean"==typeof b&&(c=b,b=0),b=b||Q,(d=fb.exec(a))?[b.createElement(d[1])]:(d=_.buildFragment([a],b,c?null:[]),_.merge([],(d.cacheable?_.clone(d.fragment):d.fragment).childNodes))):null},parseJSON:function(b){return b&&"string"==typeof b?(b=_.trim(b),a.JSON&&a.JSON.parse?a.JSON.parse(b):gb.test(b.replace(ib,"@").replace(jb,"]").replace(hb,""))?new Function("return "+b)():void _.error("Invalid JSON: "+b)):null},parseXML:function(c){var d,e;if(!c||"string"!=typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&_.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&bb.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(kb,"ms-").replace(lb,mb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||_.isFunction(a);if(d)if(h){for(e in a)if(c.apply(a[e],d)===!1)break}else for(;g>f&&c.apply(a[f++],d)!==!1;);else if(h){for(e in a)if(c.call(a[e],e,a[e])===!1)break}else for(;g>f&&c.call(a[f],f,a[f++])!==!1;);return a},trim:$&&!$.call("﻿ ")?function(a){return null==a?"":$.call(a)}:function(a){return null==a?"":(a+"").replace(db,"")},makeArray:function(a,b){var c,d=b||[];return null!=a&&(c=_.type(a),null==a.length||"string"===c||"function"===c||"regexp"===c||_.isWindow(a)?V.call(d,a):_.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(X)return X.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof _||i!==b&&"number"==typeof i&&(i>0&&a[0]&&a[i-1]||0===i||_.isArray(a));if(j)for(;i>h;h++)e=c(a[h],h,d),null!=e&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return"string"==typeof c&&(d=a[c],c=a,a=d),_.isFunction(a)?(e=W.call(arguments,2),f=function(){return a.apply(c,e.concat(W.call(arguments)))},f.guid=a.guid=a.guid||_.guid++,f):b},access:function(a,c,d,e,f,g,h){var i,j=null==d,k=0,l=a.length;if(d&&"object"==typeof d){for(k in d)_.access(a,c,k,d[k],1,g,e);f=1}else if(e!==b){if(i=h===b&&_.isFunction(e),j&&(i?(i=c,c=function(a,b,c){return i.call(_(a),c)}):(c.call(a,e),c=null)),c)for(;l>k;k++)c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h);f=1}return f?a:j?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()}}),_.ready.promise=function(b){if(!P)if(P=_.Deferred(),"complete"===Q.readyState)setTimeout(_.ready,1);else if(Q.addEventListener)Q.addEventListener("DOMContentLoaded",nb,!1),a.addEventListener("load",_.ready,!1);else{Q.attachEvent("onreadystatechange",nb),a.attachEvent("onload",_.ready);var c=!1;try{c=null==a.frameElement&&Q.documentElement}catch(d){}c&&c.doScroll&&function e(){if(!_.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}_.ready()}}()}return P.promise(b)},_.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){ob["[object "+b+"]"]=b.toLowerCase()}),O=_(Q);var pb={};_.Callbacks=function(a){a="string"==typeof a?pb[a]||d(a):_.extend({},a);var c,e,f,g,h,i,j=[],k=!a.once&&[],l=function(b){for(c=a.memory&&b,e=!0,i=g||0,g=0,h=j.length,f=!0;j&&h>i;i++)if(j[i].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}f=!1,j&&(k?k.length&&l(k.shift()):c?j=[]:m.disable())},m={add:function(){if(j){var b=j.length;!function d(b){_.each(b,function(b,c){var e=_.type(c);"function"===e?(!a.unique||!m.has(c))&&j.push(c):c&&c.length&&"string"!==e&&d(c)})}(arguments),f?h=j.length:c&&(g=b,l(c))}return this},remove:function(){return j&&_.each(arguments,function(a,b){for(var c;(c=_.inArray(b,j,c))>-1;)j.splice(c,1),f&&(h>=c&&h--,i>=c&&i--)}),this},has:function(a){return _.inArray(a,j)>-1},empty:function(){return j=[],this},disable:function(){return j=k=c=b,this},disabled:function(){return!j},lock:function(){return k=b,c||m.disable(),this},locked:function(){return!k},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],j&&(!e||k)&&(f?k.push(b):l(b)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!e}};return m},_.extend({Deferred:function(a){var b=[["resolve","done",_.Callbacks("once memory"),"resolved"],["reject","fail",_.Callbacks("once memory"),"rejected"],["notify","progress",_.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return _.Deferred(function(c){_.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](_.isFunction(g)?function(){var a=g.apply(this,arguments);a&&_.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return null!=a?_.extend(a,d):d}},e={};return d.pipe=d.then,_.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=g.fire,e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=W.call(arguments),g=f.length,h=1!==g||a&&_.isFunction(a.promise)?g:0,i=1===h?a:_.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?W.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&_.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}}),_.support=function(){var b,c,d,e,f,g,h,i,j,k,l,m=Q.createElement("div");if(m.setAttribute("className","t"),m.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=m.getElementsByTagName("*"),d=m.getElementsByTagName("a")[0],!c||!d||!c.length)return{};e=Q.createElement("select"),f=e.appendChild(Q.createElement("option")),g=m.getElementsByTagName("input")[0],d.style.cssText="top:1px;float:left;opacity:.5",b={leadingWhitespace:3===m.firstChild.nodeType,tbody:!m.getElementsByTagName("tbody").length,htmlSerialize:!!m.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:"on"===g.value,optSelected:f.selected,getSetAttribute:"t"!==m.className,enctype:!!Q.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==Q.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===Q.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},g.checked=!0,b.noCloneChecked=g.cloneNode(!0).checked,e.disabled=!0,b.optDisabled=!f.disabled;try{delete m.test}catch(n){b.deleteExpando=!1}if(!m.addEventListener&&m.attachEvent&&m.fireEvent&&(m.attachEvent("onclick",l=function(){b.noCloneEvent=!1}),m.cloneNode(!0).fireEvent("onclick"),m.detachEvent("onclick",l)),g=Q.createElement("input"),g.value="t",g.setAttribute("type","radio"),b.radioValue="t"===g.value,g.setAttribute("checked","checked"),g.setAttribute("name","t"),m.appendChild(g),h=Q.createDocumentFragment(),h.appendChild(m.lastChild),b.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=g.checked,h.removeChild(g),h.appendChild(m),m.attachEvent)for(j in{submit:!0,change:!0,focusin:!0})i="on"+j,k=i in m,k||(m.setAttribute(i,"return;"),k="function"==typeof m[i]),b[j+"Bubbles"]=k;return _(function(){var c,d,e,f,g="padding:0;margin:0;border:0;display:block;overflow:hidden;",h=Q.getElementsByTagName("body")[0];h&&(c=Q.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",h.insertBefore(c,h.firstChild),d=Q.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=d.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",k=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",b.reliableHiddenOffsets=k&&0===e[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=4===d.offsetWidth,b.doesNotIncludeMarginInBodyOffset=1!==h.offsetTop,a.getComputedStyle&&(b.pixelPosition="1%"!==(a.getComputedStyle(d,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(d,null)||{width:"4px"}).width,f=Q.createElement("div"),f.style.cssText=d.style.cssText=g,f.style.marginRight=f.style.width="0",d.style.width="1px",d.appendChild(f),b.reliableMarginRight=!parseFloat((a.getComputedStyle(f,null)||{}).marginRight)),"undefined"!=typeof d.style.zoom&&(d.innerHTML="",d.style.cssText=g+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==d.offsetWidth,c.style.zoom=1),h.removeChild(c),c=d=e=f=null)}),h.removeChild(m),c=d=e=f=g=h=m=null,b}();var qb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rb=/([A-Z])/g;_.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(_.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?_.cache[a[_.expando]]:a[_.expando],!!a&&!f(a)},data:function(a,c,d,e){if(_.acceptData(a)){var f,g,h=_.expando,i="string"==typeof c,j=a.nodeType,k=j?_.cache:a,l=j?a[h]:a[h]&&h;if(l&&k[l]&&(e||k[l].data)||!i||d!==b)return l||(j?a[h]=l=_.deletedIds.pop()||_.guid++:l=h),k[l]||(k[l]={},j||(k[l].toJSON=_.noop)),("object"==typeof c||"function"==typeof c)&&(e?k[l]=_.extend(k[l],c):k[l].data=_.extend(k[l].data,c)),f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[_.camelCase(c)]=d),i?(g=f[c],null==g&&(g=f[_.camelCase(c)])):g=f,g}},removeData:function(a,b,c){if(_.acceptData(a)){var d,e,g,h=a.nodeType,i=h?_.cache:a,j=h?a[_.expando]:_.expando;if(i[j]){if(b&&(d=c?i[j]:i[j].data)){_.isArray(b)||(b in d?b=[b]:(b=_.camelCase(b),b=b in d?[b]:b.split(" ")));for(e=0,g=b.length;g>e;e++)delete d[b[e]];if(!(c?f:_.isEmptyObject)(d))return}(c||(delete i[j].data,f(i[j])))&&(h?_.cleanData([a],!0):_.support.deleteExpando||i!=i.window?delete i[j]:i[j]=null)}}},_data:function(a,b,c){return _.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&_.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),_.fn.extend({data:function(a,c){var d,f,g,h,i,j=this[0],k=0,l=null;if(a===b){if(this.length&&(l=_.data(j),1===j.nodeType&&!_._data(j,"parsedAttrs"))){for(g=j.attributes,i=g.length;i>k;k++)h=g[k].name,h.indexOf("data-")||(h=_.camelCase(h.substring(5)),e(j,h,l[h]));_._data(j,"parsedAttrs",!0)}return l}return"object"==typeof a?this.each(function(){_.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",f=d[1]+"!",_.access(this,function(c){return c===b?(l=this.triggerHandler("getData"+f,[d[0]]),l===b&&j&&(l=_.data(j,a),l=e(j,a,l)),l===b&&d[1]?this.data(d[0]):l):(d[1]=c,void this.each(function(){var b=_(this);b.triggerHandler("setData"+f,d),_.data(this,a,c),b.triggerHandler("changeData"+f,d)}))},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){_.removeData(this,a)})}}),_.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=_._data(a,b),c&&(!d||_.isArray(c)?d=_._data(a,b,_.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=_.queue(a,b),d=c.length,e=c.shift(),f=_._queueHooks(a,b),g=function(){_.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return _._data(a,c)||_._data(a,c,{empty:_.Callbacks("once memory").add(function(){_.removeData(a,b+"queue",!0),_.removeData(a,c,!0)})})}}),_.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),arguments.length<d?_.queue(this[0],a):c===b?this:this.each(function(){var b=_.queue(this,a,c);_._queueHooks(this,a),"fx"===a&&"inprogress"!==b[0]&&_.dequeue(this,a)})},dequeue:function(a){return this.each(function(){_.dequeue(this,a)})},delay:function(a,b){return a=_.fx?_.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=_.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!=typeof a&&(c=a,a=b),a=a||"fx";h--;)d=_._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var sb,tb,ub,vb=/[\t\r\n]/g,wb=/\r/g,xb=/^(?:button|input)$/i,yb=/^(?:button|input|object|select|textarea)$/i,zb=/^a(?:rea|)$/i,Ab=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Bb=_.support.getSetAttribute;_.fn.extend({attr:function(a,b){return _.access(this,_.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){_.removeAttr(this,a)})},prop:function(a,b){return _.access(this,_.prop,a,b,arguments.length>1)},removeProp:function(a){return a=_.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(_.isFunction(a))return this.each(function(b){_(this).addClass(a.call(this,b,this.className))});if(a&&"string"==typeof a)for(b=a.split(cb),c=0,d=this.length;d>c;c++)if(e=this[c],1===e.nodeType)if(e.className||1!==b.length){for(f=" "+e.className+" ",g=0,h=b.length;h>g;g++)f.indexOf(" "+b[g]+" ")<0&&(f+=b[g]+" ");e.className=_.trim(f)}else e.className=a;return this},removeClass:function(a){var c,d,e,f,g,h,i;if(_.isFunction(a))return this.each(function(b){_(this).removeClass(a.call(this,b,this.className))});if(a&&"string"==typeof a||a===b)for(c=(a||"").split(cb),h=0,i=this.length;i>h;h++)if(e=this[h],1===e.nodeType&&e.className){for(d=(" "+e.className+" ").replace(vb," "),f=0,g=c.length;g>f;f++)for(;d.indexOf(" "+c[f]+" ")>=0;)d=d.replace(" "+c[f]+" "," ");e.className=a?_.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return this.each(_.isFunction(a)?function(c){_(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var e,f=0,g=_(this),h=b,i=a.split(cb);e=i[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else("undefined"===c||"boolean"===c)&&(this.className&&_._data(this,"__className__",this.className),this.className=this.className||a===!1?"":_._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(vb," ").indexOf(b)>=0)return!0;return!1},val:function(a){var c,d,e,f=this[0];{if(arguments.length)return e=_.isFunction(a),this.each(function(d){var f,g=_(this);1===this.nodeType&&(f=e?a.call(this,d,g.val()):a,null==f?f="":"number"==typeof f?f+="":_.isArray(f)&&(f=_.map(f,function(a){return null==a?"":a+""})),c=_.valHooks[this.type]||_.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&c.set(this,f,"value")!==b||(this.value=f))});if(f)return c=_.valHooks[f.type]||_.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,"string"==typeof d?d.replace(wb,""):null==d?"":d)}}}),_.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(_.support.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&_.nodeName(c.parentNode,"optgroup"))){if(b=_(c).val(),f)return b;
g.push(b)}return g},set:function(a,b){var c=_.makeArray(b);return _(a).find("option").each(function(){this.selected=_.inArray(_(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(a&&3!==i&&8!==i&&2!==i)return e&&_.isFunction(_.fn[c])?_(a)[c](d):"undefined"==typeof a.getAttribute?_.prop(a,c,d):(h=1!==i||!_.isXMLDoc(a),h&&(c=c.toLowerCase(),g=_.attrHooks[c]||(Ab.test(c)?tb:sb)),d!==b?null===d?void _.removeAttr(a,c):g&&"set"in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,d+""),d):g&&"get"in g&&h&&null!==(f=g.get(a,c))?f:(f=a.getAttribute(c),null===f?b:f))},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&1===a.nodeType)for(d=b.split(cb);g<d.length;g++)e=d[g],e&&(c=_.propFix[e]||e,f=Ab.test(e),f||_.attr(a,e,""),a.removeAttribute(Bb?e:c),f&&c in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(xb.test(a.nodeName)&&a.parentNode)_.error("type property can't be changed");else if(!_.support.radioValue&&"radio"===b&&_.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return sb&&_.nodeName(a,"button")?sb.get(a,b):b in a?a.value:null},set:function(a,b,c){return sb&&_.nodeName(a,"button")?sb.set(a,b,c):void(a.value=b)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h)return g=1!==h||!_.isXMLDoc(a),g&&(c=_.propFix[c]||c,f=_.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):yb.test(a.nodeName)||zb.test(a.nodeName)&&a.href?0:b}}}}),tb={get:function(a,c){var d,e=_.prop(a,c);return e===!0||"boolean"!=typeof e&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?_.removeAttr(a,c):(d=_.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},Bb||(ub={name:!0,id:!0,coords:!0},sb=_.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(ub[c]?""!==d.value:d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=Q.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},_.each(["width","height"],function(a,b){_.attrHooks[b]=_.extend(_.attrHooks[b],{set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}})}),_.attrHooks.contenteditable={get:sb.get,set:function(a,b,c){""===b&&(b="false"),sb.set(a,b,c)}}),_.support.hrefNormalized||_.each(["href","src","width","height"],function(a,c){_.attrHooks[c]=_.extend(_.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return null===d?b:d}})}),_.support.style||(_.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=b+""}}),_.support.optSelected||(_.propHooks.selected=_.extend(_.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),_.support.enctype||(_.propFix.enctype="encoding"),_.support.checkOn||_.each(["radio","checkbox"],function(){_.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}}),_.each(["radio","checkbox"],function(){_.valHooks[this]=_.extend(_.valHooks[this],{set:function(a,b){return _.isArray(b)?a.checked=_.inArray(_(a).val(),b)>=0:void 0}})});var Cb=/^(?:textarea|input|select)$/i,Db=/^([^\.]*|)(?:\.(.+)|)$/,Eb=/(?:^|\s)hover(\.\S+|)\b/,Fb=/^key/,Gb=/^(?:mouse|contextmenu)|click/,Hb=/^(?:focusinfocus|focusoutblur)$/,Ib=function(a){return _.event.special.hover?a:a.replace(Eb,"mouseenter$1 mouseleave$1")};_.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q;if(3!==a.nodeType&&8!==a.nodeType&&c&&d&&(g=_._data(a))){for(d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=_.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return"undefined"==typeof _||a&&_.event.triggered===a.type?b:_.event.dispatch.apply(h.elem,arguments)},h.elem=a),c=_.trim(Ib(c)).split(" "),j=0;j<c.length;j++)k=Db.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),q=_.event.special[l]||{},l=(f?q.delegateType:q.bindType)||l,q=_.event.special[l]||{},n=_.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&_.expr.match.needsContext.test(f),namespace:m.join(".")},o),p=i[l],p||(p=i[l]=[],p.delegateCount=0,q.setup&&q.setup.call(a,e,m,h)!==!1||(a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h))),q.add&&(q.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?p.splice(p.delegateCount++,0,n):p.push(n),_.event.global[l]=!0;a=null}},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=_.hasData(a)&&_._data(a);if(q&&(m=q.events)){for(b=_.trim(Ib(b||"")).split(" "),f=0;f<b.length;f++)if(g=Db.exec(b[f])||[],h=i=g[1],j=g[2],h){for(n=_.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,o=m[h]||[],k=o.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,l=0;l<o.length;l++)p=o[l],!(!e&&i!==p.origType||c&&c.guid!==p.guid||j&&!j.test(p.namespace)||d&&d!==p.selector&&("**"!==d||!p.selector)||(o.splice(l--,1),p.selector&&o.delegateCount--,!n.remove||!n.remove.call(a,p)));0===o.length&&k!==o.length&&((!n.teardown||n.teardown.call(a,j,q.handle)===!1)&&_.removeEvent(a,h,q.handle),delete m[h])}else for(h in m)_.event.remove(a,h+b[f],c,d,!0);_.isEmptyObject(m)&&(delete q.handle,_.removeData(a,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,f){if(!e||3!==e.nodeType&&8!==e.nodeType){var g,h,i,j,k,l,m,n,o,p,q=c.type||c,r=[];if(Hb.test(q+_.event.triggered))return;if(q.indexOf("!")>=0&&(q=q.slice(0,-1),h=!0),q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),(!e||_.event.customEvent[q])&&!_.event.global[q])return;if(c="object"==typeof c?c[_.expando]?c:new _.Event(q,c):new _.Event(q),c.type=q,c.isTrigger=!0,c.exclusive=h,c.namespace=r.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,l=q.indexOf(":")<0?"on"+q:"",!e){g=_.cache;for(i in g)g[i].events&&g[i].events[q]&&_.event.trigger(c,d,g[i].handle.elem,!0);return}if(c.result=b,c.target||(c.target=e),d=null!=d?_.makeArray(d):[],d.unshift(c),m=_.event.special[q]||{},m.trigger&&m.trigger.apply(e,d)===!1)return;if(o=[[e,m.bindType||q]],!f&&!m.noBubble&&!_.isWindow(e)){for(p=m.delegateType||q,j=Hb.test(p+q)?e:e.parentNode,k=e;j;j=j.parentNode)o.push([j,p]),k=j;k===(e.ownerDocument||Q)&&o.push([k.defaultView||k.parentWindow||a,p])}for(i=0;i<o.length&&!c.isPropagationStopped();i++)j=o[i][0],c.type=o[i][1],n=(_._data(j,"events")||{})[c.type]&&_._data(j,"handle"),n&&n.apply(j,d),n=l&&j[l],n&&_.acceptData(j)&&n.apply&&n.apply(j,d)===!1&&c.preventDefault();return c.type=q,!(f||c.isDefaultPrevented()||m._default&&m._default.apply(e.ownerDocument,d)!==!1||"click"===q&&_.nodeName(e,"a")||!_.acceptData(e)||!l||!e[q]||("focus"===q||"blur"===q)&&0===c.target.offsetWidth||_.isWindow(e)||(k=e[l],k&&(e[l]=null),_.event.triggered=q,e[q](),_.event.triggered=b,!k||!(e[l]=k))),c.result}},dispatch:function(c){c=_.event.fix(c||a.event);var d,e,f,g,h,i,j,k,l,m=(_._data(this,"events")||{})[c.type]||[],n=m.delegateCount,o=W.call(arguments),p=!c.exclusive&&!c.namespace,q=_.event.special[c.type]||{},r=[];if(o[0]=c,c.delegateTarget=this,!q.preDispatch||q.preDispatch.call(this,c)!==!1){if(n&&(!c.button||"click"!==c.type))for(f=c.target;f!=this;f=f.parentNode||this)if(f.disabled!==!0||"click"!==c.type){for(h={},j=[],d=0;n>d;d++)k=m[d],l=k.selector,h[l]===b&&(h[l]=k.needsContext?_(l,this).index(f)>=0:_.find(l,this,null,[f]).length),h[l]&&j.push(k);j.length&&r.push({elem:f,matches:j})}for(m.length>n&&r.push({elem:this,matches:m.slice(n)}),d=0;d<r.length&&!c.isPropagationStopped();d++)for(i=r[d],c.currentTarget=i.elem,e=0;e<i.matches.length&&!c.isImmediatePropagationStopped();e++)k=i.matches[e],(p||!c.namespace&&!k.namespace||c.namespace_re&&c.namespace_re.test(k.namespace))&&(c.data=k.data,c.handleObj=k,g=((_.event.special[k.origType]||{}).handle||k.handler).apply(i.elem,o),g!==b&&(c.result=g,g===!1&&(c.preventDefault(),c.stopPropagation())));return q.postDispatch&&q.postDispatch.call(this,c),c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return null==a.pageX&&null!=c.clientX&&(d=a.target.ownerDocument||Q,e=d.documentElement,f=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),!a.which&&g!==b&&(a.which=1&g?1:2&g?3:4&g?2:0),a}},fix:function(a){if(a[_.expando])return a;var b,c,d=a,e=_.event.fixHooks[a.type]||{},f=e.props?this.props.concat(e.props):this.props;for(a=_.Event(d),b=f.length;b;)c=f[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||Q),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,e.filter?e.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){_.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=_.extend(new _.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?_.event.trigger(e,null,b):_.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},_.event.handle=_.event.dispatch,_.removeEvent=Q.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&("undefined"==typeof a[d]&&(a[d]=null),a.detachEvent(d,c))},_.Event=function(a,b){return this instanceof _.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?h:g):this.type=a,b&&_.extend(this,b),this.timeStamp=a&&a.timeStamp||_.now(),this[_.expando]=!0,void 0):new _.Event(a,b)},_.Event.prototype={preventDefault:function(){this.isDefaultPrevented=h;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=h;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h,this.stopPropagation()},isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g},_.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){_.event.special[a]={delegateType:b,bindType:b,handle:function(a){{var c,d=this,e=a.relatedTarget,f=a.handleObj;f.selector}return(!e||e!==d&&!_.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),_.support.submitBubbles||(_.event.special.submit={setup:function(){return _.nodeName(this,"form")?!1:void _.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=_.nodeName(c,"input")||_.nodeName(c,"button")?c.form:b;d&&!_._data(d,"_submit_attached")&&(_.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),_._data(d,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&_.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return _.nodeName(this,"form")?!1:void _.event.remove(this,"._submit")}}),_.support.changeBubbles||(_.event.special.change={setup:function(){return Cb.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(_.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),_.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),_.event.simulate("change",this,a,!0)})),!1):void _.event.add(this,"beforeactivate._change",function(a){var b=a.target;Cb.test(b.nodeName)&&!_._data(b,"_change_attached")&&(_.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&_.event.simulate("change",this.parentNode,a,!0)}),_._data(b,"_change_attached",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return _.event.remove(this,"._change"),!Cb.test(this.nodeName)}}),_.support.focusinBubbles||_.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){_.event.simulate(b,a.target,_.event.fix(a),!0)};_.event.special[b]={setup:function(){0===c++&&Q.addEventListener(a,d,!0)},teardown:function(){0===--c&&Q.removeEventListener(a,d,!0)}}}),_.fn.extend({on:function(a,c,d,e,f){var h,i;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=g;else if(!e)return this;return 1===f&&(h=e,e=function(a){return _().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=_.guid++)),this.each(function(){_.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,_(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(f in a)this.off(f,c,a[f]);return this}return(c===!1||"function"==typeof c)&&(d=c,c=b),d===!1&&(d=g),this.each(function(){_.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return _(this.context).on(a,this.selector,b,c),this},die:function(a,b){return _(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){_.event.trigger(a,b,this)})},triggerHandler:function(a,b){return this[0]?_.event.trigger(a,b,this[0],!0):void 0},toggle:function(a){var b=arguments,c=a.guid||_.guid++,d=0,e=function(c){var e=(_._data(this,"lastToggle"+a.guid)||0)%d;return _._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),_.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){_.fn[b]=function(a,c){return null==c&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},Fb.test(b)&&(_.event.fixHooks[b]=_.event.keyHooks),Gb.test(b)&&(_.event.fixHooks[b]=_.event.mouseHooks)}),function(a,b){function c(a,b,c,d){c=c||[],b=b||F;var e,f,g,h,i=b.nodeType;if(!a||"string"!=typeof a)return c;if(1!==i&&9!==i)return[];if(g=v(b),!g&&!d&&(e=cb.exec(a)))if(h=e[1]){if(9===i){if(f=b.getElementById(h),!f||!f.parentNode)return c;if(f.id===h)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(h))&&w(b,f)&&f.id===h)return c.push(f),c}else{if(e[2])return K.apply(c,L.call(b.getElementsByTagName(a),0)),c;if((h=e[3])&&mb&&b.getElementsByClassName)return K.apply(c,L.call(b.getElementsByClassName(h),0)),c}return p(a.replace(Z,"$1"),b,c,d,g)}function d(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function e(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function f(a){return N(function(b){return b=+b,N(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function g(a,b,c){if(a===b)return c;for(var d=a.nextSibling;d;){if(d===b)return-1;d=d.nextSibling}return 1}function h(a,b){var d,e,f,g,h,i,j,k=Q[D][a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=t.preFilter;h;){(!d||(e=$.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ab.exec(h))&&(f.push(d=new E(e.shift())),h=h.slice(d.length),d.type=e[0].replace(Z," "));for(g in t.filter)(e=hb[g].exec(h))&&(!j[g]||(e=j[g](e)))&&(f.push(d=new E(e.shift())),h=h.slice(d.length),d.type=g,d.matches=e);if(!d)break}return b?h.length:h?c.error(a):Q(a,i).slice(0)}function i(a,b,c){var d=b.dir,e=c&&"parentNode"===b.dir,f=I++;return b.first?function(b,c,f){for(;b=b[d];)if(e||1===b.nodeType)return a(b,c,f)}:function(b,c,g){if(g){for(;b=b[d];)if((e||1===b.nodeType)&&a(b,c,g))return b}else for(var h,i=H+" "+f+" ",j=i+r;b=b[d];)if(e||1===b.nodeType){if((h=b[D])===j)return b.sizset;if("string"==typeof h&&0===h.indexOf(i)){if(b.sizset)return b}else{if(b[D]=j,a(b,c,g))return b.sizset=!0,b;b.sizset=!1}}}}function j(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function k(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function l(a,b,c,d,e,f){return d&&!d[D]&&(d=l(d)),e&&!e[D]&&(e=l(e,f)),N(function(f,g,h,i){var j,l,m,n=[],p=[],q=g.length,r=f||o(b||"*",h.nodeType?[h]:h,[]),s=!a||!f&&b?r:k(r,n,a,h,i),t=c?e||(f?a:q||d)?[]:g:s;if(c&&c(s,t,h,i),d)for(j=k(t,p),d(j,[],h,i),l=j.length;l--;)(m=j[l])&&(t[p[l]]=!(s[p[l]]=m));if(f){if(e||a){if(e){for(j=[],l=t.length;l--;)(m=t[l])&&j.push(s[l]=m);e(null,t=[],j,i)}for(l=t.length;l--;)(m=t[l])&&(j=e?M.call(f,m):n[l])>-1&&(f[j]=!(g[j]=m))}}else t=k(t===g?t.splice(q,t.length):t),e?e(null,g,t,i):K.apply(g,t)})}function m(a){for(var b,c,d,e=a.length,f=t.relative[a[0].type],g=f||t.relative[" "],h=f?1:0,k=i(function(a){return a===b},g,!0),n=i(function(a){return M.call(b,a)>-1},g,!0),o=[function(a,c,d){return!f&&(d||c!==A)||((b=c).nodeType?k(a,c,d):n(a,c,d))}];e>h;h++)if(c=t.relative[a[h].type])o=[i(j(o),c)];else{if(c=t.filter[a[h].type].apply(null,a[h].matches),c[D]){for(d=++h;e>d&&!t.relative[a[d].type];d++);return l(h>1&&j(o),h>1&&a.slice(0,h-1).join("").replace(Z,"$1"),c,d>h&&m(a.slice(h,d)),e>d&&m(a=a.slice(d)),e>d&&a.join(""))}o.push(c)}return j(o)}function n(a,b){var d=b.length>0,e=a.length>0,f=function(g,h,i,j,l){var m,n,o,p=[],q=0,s="0",u=g&&[],v=null!=l,w=A,x=g||e&&t.find.TAG("*",l&&h.parentNode||h),y=H+=null==w?1:Math.E;for(v&&(A=h!==F&&h,r=f.el);null!=(m=x[s]);s++){if(e&&m){for(n=0;o=a[n];n++)if(o(m,h,i)){j.push(m);break}v&&(H=y,r=++f.el)}d&&((m=!o&&m)&&q--,g&&u.push(m))}if(q+=s,d&&s!==q){for(n=0;o=b[n];n++)o(u,p,h,i);if(g){if(q>0)for(;s--;)!u[s]&&!p[s]&&(p[s]=J.call(j));p=k(p)}K.apply(j,p),v&&!g&&p.length>0&&q+b.length>1&&c.uniqueSort(j)}return v&&(H=y,A=w),u};return f.el=0,d?N(f):f}function o(a,b,d){for(var e=0,f=b.length;f>e;e++)c(a,b[e],d);return d}function p(a,b,c,d,e){{var f,g,i,j,k,l=h(a);l.length}if(!d&&1===l.length){if(g=l[0]=l[0].slice(0),g.length>2&&"ID"===(i=g[0]).type&&9===b.nodeType&&!e&&t.relative[g[1].type]){if(b=t.find.ID(i.matches[0].replace(gb,""),b,e)[0],!b)return c;a=a.slice(g.shift().length)}for(f=hb.POS.test(a)?-1:g.length-1;f>=0&&(i=g[f],!t.relative[j=i.type]);f--)if((k=t.find[j])&&(d=k(i.matches[0].replace(gb,""),db.test(g[0].type)&&b.parentNode||b,e))){if(g.splice(f,1),a=d.length&&g.join(""),!a)return K.apply(c,L.call(d,0)),c;break}}return x(a,l)(d,b,e,c,db.test(a)),c}function q(){}var r,s,t,u,v,w,x,y,z,A,B=!0,C="undefined",D=("sizcache"+Math.random()).replace(".",""),E=String,F=a.document,G=F.documentElement,H=0,I=0,J=[].pop,K=[].push,L=[].slice,M=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},N=function(a,b){return a[D]=null==b||b,a},O=function(){var a={},b=[];return N(function(c,d){return b.push(c)>t.cacheLength&&delete a[b.shift()],a[c+" "]=d},a)},P=O(),Q=O(),R=O(),S="[\\x20\\t\\r\\n\\f]",T="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",U=T.replace("w","w#"),V="([*^$|!~]?=)",W="\\["+S+"*("+T+")"+S+"*(?:"+V+S+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+U+")|)|)"+S+"*\\]",X=":("+T+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+W+")|[^:]|\\\\.)*|.*))\\)|)",Y=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+S+"*((?:-\\d)?\\d*)"+S+"*\\)|)(?=[^-]|$)",Z=new RegExp("^"+S+"+|((?:^|[^\\\\])(?:\\\\.)*)"+S+"+$","g"),$=new RegExp("^"+S+"*,"+S+"*"),ab=new RegExp("^"+S+"*([\\x20\\t\\r\\n\\f>+~])"+S+"*"),bb=new RegExp(X),cb=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,db=/[\x20\t\r\n\f]*[+~]/,eb=/h\d/i,fb=/input|select|textarea|button/i,gb=/\\(?!\\)/g,hb={ID:new RegExp("^#("+T+")"),CLASS:new RegExp("^\\.("+T+")"),NAME:new RegExp("^\\[name=['\"]?("+T+")['\"]?\\]"),TAG:new RegExp("^("+T.replace("w","w*")+")"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+X),POS:new RegExp(Y,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+S+"*(even|odd|(([+-]|)(\\d*)n|)"+S+"*(?:([+-]|)"+S+"*(\\d+)|))"+S+"*\\)|)","i"),needsContext:new RegExp("^"+S+"*[>+~]|"+Y,"i")},ib=function(a){var b=F.createElement("div");try{return a(b)}catch(c){return!1}finally{b=null}},jb=ib(function(a){return a.appendChild(F.createComment("")),!a.getElementsByTagName("*").length}),kb=ib(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==C&&"#"===a.firstChild.getAttribute("href")}),lb=ib(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return"boolean"!==b&&"string"!==b}),mb=ib(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",a.getElementsByClassName&&a.getElementsByClassName("e").length?(a.lastChild.className="e",2===a.getElementsByClassName("e").length):!1}),nb=ib(function(a){a.id=D+0,a.innerHTML="<a name='"+D+"'></a><div name='"+D+"'></div>",G.insertBefore(a,G.firstChild);var b=F.getElementsByName&&F.getElementsByName(D).length===2+F.getElementsByName(D+0).length;return s=!F.getElementById(D),G.removeChild(a),b});try{L.call(G.childNodes,0)[0].nodeType}catch(ob){L=function(a){for(var b,c=[];b=this[a];a++)c.push(b);return c}}c.matches=function(a,b){return c(a,null,null,b)},c.matchesSelector=function(a,b){return c(b,null,null,[a]).length>0},u=c.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=u(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d];d++)c+=u(b);return c},v=c.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},w=c.contains=G.contains?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&1===d.nodeType&&c.contains&&c.contains(d))}:G.compareDocumentPosition?function(a,b){return b&&!!(16&a.compareDocumentPosition(b))}:function(a,b){for(;b=b.parentNode;)if(b===a)return!0;return!1},c.attr=function(a,b){var c,d=v(a);return d||(b=b.toLowerCase()),(c=t.attrHandle[b])?c(a):d||lb?a.getAttribute(b):(c=a.getAttributeNode(b),c?"boolean"==typeof a[b]?a[b]?b:null:c.specified?c.value:null:null)},t=c.selectors={cacheLength:50,createPseudo:N,match:hb,attrHandle:kb?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},find:{ID:s?function(a,b,c){if(typeof b.getElementById!==C&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==C&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==C&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:jb?function(a,b){return typeof b.getElementsByTagName!==C?b.getElementsByTagName(a):void 0}:function(a,b){var c=b.getElementsByTagName(a);if("*"===a){for(var d,e=[],f=0;d=c[f];f++)1===d.nodeType&&e.push(d);return e}return c},NAME:nb&&function(a,b){return typeof b.getElementsByName!==C?b.getElementsByName(name):void 0},CLASS:mb&&function(a,b,c){return typeof b.getElementsByClassName===C||c?void 0:b.getElementsByClassName(a)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(gb,""),a[3]=(a[4]||a[5]||"").replace(gb,""),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1]?(a[2]||c.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*("even"===a[2]||"odd"===a[2])),a[4]=+(a[6]+a[7]||"odd"===a[2])):a[2]&&c.error(a[0]),a},PSEUDO:function(a){var b,c;return hb.CHILD.test(a[0])?null:(a[3]?a[2]=a[3]:(b=a[4])&&(bb.test(b)&&(c=h(b,!0))&&(c=b.indexOf(")",b.length-c)-b.length)&&(b=b.slice(0,c),a[0]=a[0].slice(0,c)),a[2]=b),a.slice(0,3))}},filter:{ID:s?function(a){return a=a.replace(gb,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(gb,""),function(b){var c=typeof b.getAttributeNode!==C&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(gb,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=P[D][a+" "];return b||(b=new RegExp("(^|"+S+")"+a+"("+S+"|$)"))&&P(a,function(a){return b.test(a.className||typeof a.getAttribute!==C&&a.getAttribute("class")||"")})},ATTR:function(a,b,d){return function(e){var f=c.attr(e,a);return null==f?"!="===b:b?(f+="","="===b?f===d:"!="===b?f!==d:"^="===b?d&&0===f.indexOf(d):"*="===b?d&&f.indexOf(d)>-1:"$="===b?d&&f.substr(f.length-d.length)===d:"~="===b?(" "+f+" ").indexOf(d)>-1:"|="===b?f===d||f.substr(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d){return"nth"===a?function(a){var b,e,f=a.parentNode;if(1===c&&0===d)return!0;if(f)for(e=0,b=f.firstChild;b&&(1!==b.nodeType||(e++,a!==b));b=b.nextSibling);return e-=d,e===c||e%c===0&&e/c>=0}:function(b){var c=b;switch(a){case"only":case"first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===a)return!0;c=b;case"last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(a,b){var d,e=t.pseudos[a]||t.setFilters[a.toLowerCase()]||c.error("unsupported pseudo: "+a);return e[D]?e(b):e.length>1?(d=[a,a,"",b],t.setFilters.hasOwnProperty(a.toLowerCase())?N(function(a,c){for(var d,f=e(a,b),g=f.length;g--;)d=M.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,d)}):e}},pseudos:{not:N(function(a){var b=[],c=[],d=x(a.replace(Z,"$1"));return d[D]?N(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:N(function(a){return function(b){return c(a,b).length>0}}),contains:N(function(a){return function(b){return(b.textContent||b.innerText||u(b)).indexOf(a)>-1}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!t.pseudos.empty(a)},empty:function(a){var b;for(a=a.firstChild;a;){if(a.nodeName>"@"||3===(b=a.nodeType)||4===b)return!1;a=a.nextSibling}return!0},header:function(a){return eb.test(a.nodeName)},text:function(a){var b,c;return"input"===a.nodeName.toLowerCase()&&"text"===(b=a.type)&&(null==(c=a.getAttribute("type"))||c.toLowerCase()===b)},radio:d("radio"),checkbox:d("checkbox"),file:d("file"),password:d("password"),image:d("image"),submit:e("submit"),reset:e("reset"),button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return fb.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},active:function(a){return a===a.ownerDocument.activeElement},first:f(function(){return[0]}),last:f(function(a,b){return[b-1]}),eq:f(function(a,b,c){return[0>c?c+b:c]}),even:f(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:f(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:f(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:f(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},y=G.compareDocumentPosition?function(a,b){return a===b?(z=!0,0):(a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b):a.compareDocumentPosition)?-1:1}:function(a,b){if(a===b)return z=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return g(a,b);if(!h)return-1;if(!i)return 1;for(;j;)e.unshift(j),j=j.parentNode;for(j=i;j;)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;c>k&&d>k;k++)if(e[k]!==f[k])return g(e[k],f[k]);return k===c?g(a,f[k],-1):g(e[k],b,1)},[0,0].sort(y),B=!z,c.uniqueSort=function(a){var b,c=[],d=1,e=0;if(z=B,a.sort(y),z){for(;b=a[d];d++)b===a[d-1]&&(e=c.push(d));for(;e--;)a.splice(c[e],1)}return a},c.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},x=c.compile=function(a,b){var c,d=[],e=[],f=R[D][a+" "];if(!f){for(b||(b=h(a)),c=b.length;c--;)f=m(b[c]),f[D]?d.push(f):e.push(f);f=R(a,n(e,d))}return f},F.querySelectorAll&&function(){var a,b=p,d=/'|\\/g,e=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,f=[":focus"],g=[":active"],i=G.matchesSelector||G.mozMatchesSelector||G.webkitMatchesSelector||G.oMatchesSelector||G.msMatchesSelector;ib(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||f.push("\\["+S+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||f.push(":checked")}),ib(function(a){a.innerHTML="<p test=''></p>",a.querySelectorAll("[test^='']").length&&f.push("[*^$]="+S+"*(?:\"\"|'')"),a.innerHTML="<input type='hidden'/>",a.querySelectorAll(":enabled").length||f.push(":enabled",":disabled")}),f=new RegExp(f.join("|")),p=function(a,c,e,g,i){if(!g&&!i&&!f.test(a)){var j,k,l=!0,m=D,n=c,o=9===c.nodeType&&a;if(1===c.nodeType&&"object"!==c.nodeName.toLowerCase()){for(j=h(a),(l=c.getAttribute("id"))?m=l.replace(d,"\\$&"):c.setAttribute("id",m),m="[id='"+m+"'] ",k=j.length;k--;)j[k]=m+j[k].join("");n=db.test(a)&&c.parentNode||c,o=j.join(",")}if(o)try{return K.apply(e,L.call(n.querySelectorAll(o),0)),e}catch(p){}finally{l||c.removeAttribute("id")}}return b(a,c,e,g,i)},i&&(ib(function(b){a=i.call(b,"div");try{i.call(b,"[test!='']:sizzle"),g.push("!=",X)}catch(c){}}),g=new RegExp(g.join("|")),c.matchesSelector=function(b,d){if(d=d.replace(e,"='$1']"),!v(b)&&!g.test(d)&&!f.test(d))try{var h=i.call(b,d);if(h||a||b.document&&11!==b.document.nodeType)return h}catch(j){}return c(d,null,null,[b]).length>0})}(),t.pseudos.nth=t.pseudos.eq,t.filters=q.prototype=t.pseudos,t.setFilters=new q,c.attr=_.attr,_.find=c,_.expr=c.selectors,_.expr[":"]=_.expr.pseudos,_.unique=c.uniqueSort,_.text=c.getText,_.isXMLDoc=c.isXML,_.contains=c.contains}(a);var Jb=/Until$/,Kb=/^(?:parents|prev(?:Until|All))/,Lb=/^.[^:#\[\.,]*$/,Mb=_.expr.match.needsContext,Nb={children:!0,contents:!0,next:!0,prev:!0};_.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if("string"!=typeof a)return _(a).filter(function(){for(b=0,c=h.length;c>b;b++)if(_.contains(h[b],this))return!0});for(g=this.pushStack("","find",a),b=0,c=this.length;c>b;b++)if(d=g.length,_.find(a,this[b],g),b>0)for(e=d;e<g.length;e++)for(f=0;d>f;f++)if(g[f]===g[e]){g.splice(e--,1);break}return g},has:function(a){var b,c=_(a,this),d=c.length;
return this.filter(function(){for(b=0;d>b;b++)if(_.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(k(this,a,!1),"not",a)},filter:function(a){return this.pushStack(k(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"==typeof a?Mb.test(a)?_(a,this.context).index(this[0])>=0:_.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Mb.test(a)||"string"!=typeof a?_(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?g.index(c)>-1:_.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}return f=f.length>1?_.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?"string"==typeof a?_.inArray(this[0],_(a)):_.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c="string"==typeof a?_(a,b):_.makeArray(a&&a.nodeType?[a]:a),d=_.merge(this.get(),c);return this.pushStack(i(c[0])||i(d[0])?d:_.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),_.fn.andSelf=_.fn.addBack,_.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return _.dir(a,"parentNode")},parentsUntil:function(a,b,c){return _.dir(a,"parentNode",c)},next:function(a){return j(a,"nextSibling")},prev:function(a){return j(a,"previousSibling")},nextAll:function(a){return _.dir(a,"nextSibling")},prevAll:function(a){return _.dir(a,"previousSibling")},nextUntil:function(a,b,c){return _.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return _.dir(a,"previousSibling",c)},siblings:function(a){return _.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return _.sibling(a.firstChild)},contents:function(a){return _.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:_.merge([],a.childNodes)}},function(a,b){_.fn[a]=function(c,d){var e=_.map(this,b,c);return Jb.test(a)||(d=c),d&&"string"==typeof d&&(e=_.filter(d,e)),e=this.length>1&&!Nb[a]?_.unique(e):e,this.length>1&&Kb.test(a)&&(e=e.reverse()),this.pushStack(e,a,W.call(arguments).join(","))}}),_.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?_.find.matchesSelector(b[0],a)?[b[0]]:[]:_.find.matches(a,b)},dir:function(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(d===b||1!==f.nodeType||!_(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Ob="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Pb=/ jQuery\d+="(?:null|\d+)"/g,Qb=/^\s+/,Rb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Sb=/<([\w:]+)/,Tb=/<tbody/i,Ub=/<|&#?\w+;/,Vb=/<(?:script|style|link)/i,Wb=/<(?:script|object|embed|option|style)/i,Xb=new RegExp("<(?:"+Ob+")[\\s/>]","i"),Yb=/^(?:checkbox|radio)$/,Zb=/checked\s*(?:[^=]|=\s*.checked.)/i,$b=/\/(java|ecma)script/i,_b=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,ac={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bc=l(Q),cc=bc.appendChild(Q.createElement("div"));ac.optgroup=ac.option,ac.tbody=ac.tfoot=ac.colgroup=ac.caption=ac.thead,ac.th=ac.td,_.support.htmlSerialize||(ac._default=[1,"X<div>","</div>"]),_.fn.extend({text:function(a){return _.access(this,function(a){return a===b?_.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Q).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(_.isFunction(a))return this.each(function(b){_(this).wrapAll(a.call(this,b))});if(this[0]){var b=_(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(_.isFunction(a)?function(b){_(this).wrapInner(a.call(this,b))}:function(){var b=_(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=_.isFunction(a);return this.each(function(c){_(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){_.nodeName(this,"body")||_(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!i(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=_.clean(arguments);return this.pushStack(_.merge(a,this),"before",this.selector)}},after:function(){if(!i(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=_.clean(arguments);return this.pushStack(_.merge(this,a),"after",this.selector)}},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)(!a||_.filter(a,[c]).length)&&(!b&&1===c.nodeType&&(_.cleanData(c.getElementsByTagName("*")),_.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)for(1===a.nodeType&&_.cleanData(a.getElementsByTagName("*"));a.firstChild;)a.removeChild(a.firstChild);return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return _.clone(this,a,b)})},html:function(a){return _.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(Pb,""):b;if(!("string"!=typeof a||Vb.test(a)||!_.support.htmlSerialize&&Xb.test(a)||!_.support.leadingWhitespace&&Qb.test(a)||ac[(Sb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Rb,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(_.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return i(this[0])?this.length?this.pushStack(_(_.isFunction(a)?a():a),"replaceWith",a):this:_.isFunction(a)?this.each(function(b){var c=_(this),d=c.html();c.replaceWith(a.call(this,b,d))}):("string"!=typeof a&&(a=_(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;_(this).remove(),b?_(b).before(a):_(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,h,i=0,j=a[0],k=[],l=this.length;if(!_.support.checkClone&&l>1&&"string"==typeof j&&Zb.test(j))return this.each(function(){_(this).domManip(a,c,d)});if(_.isFunction(j))return this.each(function(e){var f=_(this);a[0]=j.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){if(e=_.buildFragment(a,this,k),g=e.fragment,f=g.firstChild,1===g.childNodes.length&&(g=f),f)for(c=c&&_.nodeName(f,"tr"),h=e.cacheable||l-1;l>i;i++)d.call(c&&_.nodeName(this[i],"table")?m(this[i],"tbody"):this[i],i===h?g:_.clone(g,!0,!0));g=f=null,k.length&&_.each(k,function(a,b){b.src?_.ajax?_.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):_.error("no ajax"):_.globalEval((b.text||b.textContent||b.innerHTML||"").replace(_b,"")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),_.buildFragment=function(a,c,d){var e,f,g,h=a[0];return c=c||Q,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,1===a.length&&"string"==typeof h&&h.length<512&&c===Q&&"<"===h.charAt(0)&&!Wb.test(h)&&(_.support.checkClone||!Zb.test(h))&&(_.support.html5Clone||!Xb.test(h))&&(f=!0,e=_.fragments[h],g=e!==b),e||(e=c.createDocumentFragment(),_.clean(a,c,e,d),f&&(_.fragments[h]=g&&e)),{fragment:e,cacheable:f}},_.fragments={},_.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){_.fn[a]=function(c){var d,e=0,f=[],g=_(c),h=g.length,i=1===this.length&&this[0].parentNode;if((null==i||i&&11===i.nodeType&&1===i.childNodes.length)&&1===h)return g[b](this[0]),this;for(;h>e;e++)d=(e>0?this.clone(!0):this).get(),_(g[e])[b](d),f=f.concat(d);return this.pushStack(f,a,g.selector)}}),_.extend({clone:function(a,b,c){var d,e,f,g;if(_.support.html5Clone||_.isXMLDoc(a)||!Xb.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(cc.innerHTML=a.outerHTML,cc.removeChild(g=cc.firstChild)),!(_.support.noCloneEvent&&_.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||_.isXMLDoc(a)))for(o(a,g),d=p(a),e=p(g),f=0;d[f];++f)e[f]&&o(d[f],e[f]);if(b&&(n(a,g),c))for(d=p(a),e=p(g),f=0;d[f];++f)n(d[f],e[f]);return d=e=null,g},clean:function(a,b,c,d){var e,f,g,h,i,j,k,m,n,o,p,r=b===Q&&bc,s=[];for(b&&"undefined"!=typeof b.createDocumentFragment||(b=Q),e=0;null!=(g=a[e]);e++)if("number"==typeof g&&(g+=""),g){if("string"==typeof g)if(Ub.test(g)){for(r=r||l(b),k=b.createElement("div"),r.appendChild(k),g=g.replace(Rb,"<$1></$2>"),h=(Sb.exec(g)||["",""])[1].toLowerCase(),i=ac[h]||ac._default,j=i[0],k.innerHTML=i[1]+g+i[2];j--;)k=k.lastChild;if(!_.support.tbody)for(m=Tb.test(g),n="table"!==h||m?"<table>"!==i[1]||m?[]:k.childNodes:k.firstChild&&k.firstChild.childNodes,f=n.length-1;f>=0;--f)_.nodeName(n[f],"tbody")&&!n[f].childNodes.length&&n[f].parentNode.removeChild(n[f]);!_.support.leadingWhitespace&&Qb.test(g)&&k.insertBefore(b.createTextNode(Qb.exec(g)[0]),k.firstChild),g=k.childNodes,k.parentNode.removeChild(k)}else g=b.createTextNode(g);g.nodeType?s.push(g):_.merge(s,g)}if(k&&(g=k=r=null),!_.support.appendChecked)for(e=0;null!=(g=s[e]);e++)_.nodeName(g,"input")?q(g):"undefined"!=typeof g.getElementsByTagName&&_.grep(g.getElementsByTagName("input"),q);if(c)for(o=function(a){return!a.type||$b.test(a.type)?d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a):void 0},e=0;null!=(g=s[e]);e++)_.nodeName(g,"script")&&o(g)||(c.appendChild(g),"undefined"!=typeof g.getElementsByTagName&&(p=_.grep(_.merge([],g.getElementsByTagName("script")),o),s.splice.apply(s,[e+1,0].concat(p)),e+=p.length));return s},cleanData:function(a,b){for(var c,d,e,f,g=0,h=_.expando,i=_.cache,j=_.support.deleteExpando,k=_.event.special;null!=(e=a[g]);g++)if((b||_.acceptData(e))&&(d=e[h],c=d&&i[d])){if(c.events)for(f in c.events)k[f]?_.event.remove(e,f):_.removeEvent(e,f,c.handle);i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,_.deletedIds.push(d))}}}),function(){var a,b;_.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=_.uaMatch(S.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0),_.browser=b,_.sub=function(){function a(b,c){return new a.fn.init(b,c)}_.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(c,d){return d&&d instanceof _&&!(d instanceof a)&&(d=a(d)),_.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(Q);return a}}();var dc,ec,fc,gc=/alpha\([^)]*\)/i,hc=/opacity=([^)]*)/,ic=/^(top|right|bottom|left)$/,jc=/^(none|table(?!-c[ea]).+)/,kc=/^margin/,lc=new RegExp("^("+ab+")(.*)$","i"),mc=new RegExp("^("+ab+")(?!px)[a-z%]+$","i"),nc=new RegExp("^([-+])=("+ab+")","i"),oc={BODY:"block"},pc={position:"absolute",visibility:"hidden",display:"block"},qc={letterSpacing:0,fontWeight:400},rc=["Top","Right","Bottom","Left"],sc=["Webkit","O","Moz","ms"],tc=_.fn.toggle;_.fn.extend({css:function(a,c){return _.access(this,function(a,c,d){return d!==b?_.style(a,c,d):_.css(a,c)},a,c,arguments.length>1)},show:function(){return t(this,!0)},hide:function(){return t(this)},toggle:function(a,b){var c="boolean"==typeof a;return _.isFunction(a)&&_.isFunction(b)?tc.apply(this,arguments):this.each(function(){(c?a:s(this))?_(this).show():_(this).hide()})}}),_.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=dc(a,"opacity");return""===c?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":_.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=_.camelCase(c),j=a.style;if(c=_.cssProps[i]||(_.cssProps[i]=r(j,i)),h=_.cssHooks[c]||_.cssHooks[i],d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];if(g=typeof d,"string"===g&&(f=nc.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(_.css(a,c)),g="number"),!(null==d||"number"===g&&isNaN(d)||("number"===g&&!_.cssNumber[i]&&(d+="px"),h&&"set"in h&&(d=h.set(a,d,e))===b)))try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=_.camelCase(c);return c=_.cssProps[i]||(_.cssProps[i]=r(a.style,i)),h=_.cssHooks[c]||_.cssHooks[i],h&&"get"in h&&(f=h.get(a,!0,e)),f===b&&(f=dc(a,c)),"normal"===f&&c in qc&&(f=qc[c]),d||e!==b?(g=parseFloat(f),d||_.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];d=c.call(a);for(e in b)a.style[e]=f[e];return d}}),a.getComputedStyle?dc=function(b,c){var d,e,f,g,h=a.getComputedStyle(b,null),i=b.style;return h&&(d=h.getPropertyValue(c)||h[c],""===d&&!_.contains(b.ownerDocument,b)&&(d=_.style(b,c)),mc.test(d)&&kc.test(c)&&(e=i.width,f=i.minWidth,g=i.maxWidth,i.minWidth=i.maxWidth=i.width=d,d=h.width,i.width=e,i.minWidth=f,i.maxWidth=g)),d}:Q.documentElement.currentStyle&&(dc=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return null==e&&f&&f[b]&&(e=f[b]),mc.test(e)&&!ic.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),""===e?"auto":e}),_.each(["height","width"],function(a,b){_.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&jc.test(dc(a,"display"))?_.swap(a,pc,function(){return w(a,b,d)}):w(a,b,d):void 0},set:function(a,c,d){return u(a,c,d?v(a,b,d,_.support.boxSizing&&"border-box"===_.css(a,"boxSizing")):0)}}}),_.support.opacity||(_.cssHooks.opacity={get:function(a,b){return hc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=_.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,b>=1&&""===_.trim(f.replace(gc,""))&&c.removeAttribute&&(c.removeAttribute("filter"),d&&!d.filter)||(c.filter=gc.test(f)?f.replace(gc,e):f+" "+e)}}),_(function(){_.support.reliableMarginRight||(_.cssHooks.marginRight={get:function(a,b){return _.swap(a,{display:"inline-block"},function(){return b?dc(a,"marginRight"):void 0})}}),!_.support.pixelPosition&&_.fn.position&&_.each(["top","left"],function(a,b){_.cssHooks[b]={get:function(a,c){if(c){var d=dc(a,b);return mc.test(d)?_(a).position()[b]+"px":d}}}})}),_.expr&&_.expr.filters&&(_.expr.filters.hidden=function(a){return 0===a.offsetWidth&&0===a.offsetHeight||!_.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||dc(a,"display"))},_.expr.filters.visible=function(a){return!_.expr.filters.hidden(a)}),_.each({margin:"",padding:"",border:"Width"},function(a,b){_.cssHooks[a+b]={expand:function(c){var d,e="string"==typeof c?c.split(" "):[c],f={};for(d=0;4>d;d++)f[a+rc[d]+b]=e[d]||e[d-2]||e[0];return f}},kc.test(a)||(_.cssHooks[a+b].set=u)});var uc=/%20/g,vc=/\[\]$/,wc=/\r?\n/g,xc=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,yc=/^(?:select|textarea)/i;_.fn.extend({serialize:function(){return _.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?_.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||yc.test(this.nodeName)||xc.test(this.type))}).map(function(a,b){var c=_(this).val();return null==c?null:_.isArray(c)?_.map(c,function(a){return{name:b.name,value:a.replace(wc,"\r\n")}}):{name:b.name,value:c.replace(wc,"\r\n")}}).get()}}),_.param=function(a,c){var d,e=[],f=function(a,b){b=_.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=_.ajaxSettings&&_.ajaxSettings.traditional),_.isArray(a)||a.jquery&&!_.isPlainObject(a))_.each(a,function(){f(this.name,this.value)});else for(d in a)y(d,a[d],c,f);return e.join("&").replace(uc,"+")};var zc,Ac,Bc=/#.*$/,Cc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Dc=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Ec=/^(?:GET|HEAD)$/,Fc=/^\/\//,Gc=/\?/,Hc=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ic=/([?&])_=[^&]*/,Jc=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Kc=_.fn.load,Lc={},Mc={},Nc=["*/"]+["*"];try{Ac=R.href}catch(Oc){Ac=Q.createElement("a"),Ac.href="",Ac=Ac.href}zc=Jc.exec(Ac.toLowerCase())||[],_.fn.load=function(a,c,d){if("string"!=typeof a&&Kc)return Kc.apply(this,arguments);if(!this.length)return this;var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),_.isFunction(c)?(d=c,c=b):c&&"object"==typeof c&&(f="POST"),_.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments,h.html(e?_("<div>").append(a.replace(Hc,"")).find(e):a)}),this},_.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){_.fn[b]=function(a){return this.on(b,a)}}),_.each(["get","post"],function(a,c){_[c]=function(a,d,e,f){return _.isFunction(d)&&(f=f||e,e=d,d=b),_.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),_.extend({getScript:function(a,c){return _.get(a,b,c,"script")},getJSON:function(a,b,c){return _.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?B(a,_.ajaxSettings):(b=a,a=_.ajaxSettings),B(a,b),a},ajaxSettings:{url:Ac,isLocal:Dc.test(zc[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Nc},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":_.parseJSON,"text xml":_.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:z(Lc),ajaxTransport:z(Mc),ajax:function(a,c){function d(a,c,d,g){var j,l,s,t,v,x=c;2!==u&&(u=2,i&&clearTimeout(i),h=b,f=g||"",w.readyState=a>0?4:0,d&&(t=C(m,w,d)),a>=200&&300>a||304===a?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(_.lastModified[e]=v),v=w.getResponseHeader("Etag"),v&&(_.etag[e]=v)),304===a?(x="notmodified",j=!0):(j=D(m,t),x=j.state,l=j.data,s=j.error,j=!s)):(s=x,(!x||a)&&(x="error",0>a&&(a=0))),w.status=a,w.statusText=(c||x)+"",j?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=b,k&&o.trigger("ajax"+(j?"Success":"Error"),[w,m,j?l:s]),q.fireWith(n,[w,x]),k&&(o.trigger("ajaxComplete",[w,m]),--_.active||_.event.trigger("ajaxStop")))}"object"==typeof a&&(c=a,a=b),c=c||{};var e,f,g,h,i,j,k,l,m=_.ajaxSetup({},c),n=m.context||m,o=n!==m&&(n.nodeType||n instanceof _)?_(n):_.event,p=_.Deferred(),q=_.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,setRequestHeader:function(a,b){if(!u){var c=a.toLowerCase();a=t[c]=t[c]||a,s[a]=b}return this},getAllResponseHeaders:function(){return 2===u?f:null},getResponseHeader:function(a){var c;if(2===u){if(!g)for(g={};c=Cc.exec(f);)g[c[1].toLowerCase()]=c[2];c=g[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return u||(m.mimeType=a),this},abort:function(a){return a=a||v,h&&h.abort(a),d(0,a),this}};if(p.promise(w),w.success=w.done,w.error=w.fail,w.complete=q.add,w.statusCode=function(a){if(a){var b;if(2>u)for(b in a)r[b]=[r[b],a[b]];else b=a[w.status],w.always(b)}return this},m.url=((a||m.url)+"").replace(Bc,"").replace(Fc,zc[1]+"//"),m.dataTypes=_.trim(m.dataType||"*").toLowerCase().split(cb),null==m.crossDomain&&(j=Jc.exec(m.url.toLowerCase()),m.crossDomain=!(!j||j[1]===zc[1]&&j[2]===zc[2]&&(j[3]||("http:"===j[1]?80:443))==(zc[3]||("http:"===zc[1]?80:443)))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=_.param(m.data,m.traditional)),A(Lc,m,c,w),2===u)return w;if(k=m.global,m.type=m.type.toUpperCase(),m.hasContent=!Ec.test(m.type),k&&0===_.active++&&_.event.trigger("ajaxStart"),!m.hasContent&&(m.data&&(m.url+=(Gc.test(m.url)?"&":"?")+m.data,delete m.data),e=m.url,m.cache===!1)){var x=_.now(),y=m.url.replace(Ic,"$1_="+x);m.url=y+(y===m.url?(Gc.test(m.url)?"&":"?")+"_="+x:"")}(m.data&&m.hasContent&&m.contentType!==!1||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),m.ifModified&&(e=e||m.url,_.lastModified[e]&&w.setRequestHeader("If-Modified-Since",_.lastModified[e]),_.etag[e]&&w.setRequestHeader("If-None-Match",_.etag[e])),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Nc+"; q=0.01":""):m.accepts["*"]);for(l in m.headers)w.setRequestHeader(l,m.headers[l]);if(!m.beforeSend||m.beforeSend.call(n,w,m)!==!1&&2!==u){v="abort";for(l in{success:1,error:1,complete:1})w[l](m[l]);if(h=A(Mc,m,c,w)){w.readyState=1,k&&o.trigger("ajaxSend",[w,m]),m.async&&m.timeout>0&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,h.send(s,d)}catch(z){if(!(2>u))throw z;d(-1,z)}}else d(-1,"No Transport");return w}return w.abort()},active:0,lastModified:{},etag:{}});var Pc=[],Qc=/\?/,Rc=/(=)\?(?=&|$)|\?\?/,Sc=_.now();_.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Pc.pop()||_.expando+"_"+Sc++;return this[a]=!0,a}}),_.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=c.jsonp!==!1,l=k&&Rc.test(j),m=k&&!l&&"string"==typeof i&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rc.test(i);return"jsonp"===c.dataTypes[0]||l||m?(f=c.jsonpCallback=_.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g=a[f],l?c.url=j.replace(Rc,"$1"+f):m?c.data=i.replace(Rc,"$1"+f):k&&(c.url+=(Qc.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||_.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,Pc.push(f)),h&&_.isFunction(g)&&g(h[0]),h=g=b}),"script"):void 0}),_.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return _.globalEval(a),a}}}),_.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),_.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=Q.head||Q.getElementsByTagName("head")[0]||Q.documentElement;return{send:function(e,f){c=Q.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){(e||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success"))},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var Tc,Uc=a.ActiveXObject?function(){for(var a in Tc)Tc[a](0,1)}:!1,Vc=0;_.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&E()||F()}:E,function(a){_.extend(_.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(_.ajaxSettings.xhr()),_.support.ajax&&_.ajaxTransport(function(c){if(!c.crossDomain||_.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();if(c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async),c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||4===i.readyState))if(d=b,g&&(i.onreadystatechange=_.noop,Uc&&delete Tc[g]),e)4!==i.readyState&&i.abort();else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(n){}try{j=i.statusText}catch(n){j=""}h||!c.isLocal||c.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async?4===i.readyState?setTimeout(d,0):(g=++Vc,Uc&&(Tc||(Tc={},_(a).unload(Uc)),Tc[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var Wc,Xc,Yc=/^(?:toggle|show|hide)$/,Zc=new RegExp("^(?:([-+])=|)("+ab+")([a-z%]*)$","i"),$c=/queueHooks$/,_c=[K],ad={"*":[function(a,b){var c,d,e=this.createTween(a,b),f=Zc.exec(b),g=e.cur(),h=+g||0,i=1,j=20;if(f){if(c=+f[2],d=f[3]||(_.cssNumber[a]?"":"px"),"px"!==d&&h){h=_.css(e.elem,a,!0)||c||1;do i=i||".5",h/=i,_.style(e.elem,a,h+d);while(i!==(i=e.cur()/g)&&1!==i&&--j)}e.unit=d,e.start=h,e.end=f[1]?h+(f[1]+1)*c:c}return e}]};_.Animation=_.extend(I,{tweener:function(a,b){_.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ad[c]=ad[c]||[],ad[c].unshift(b)},prefilter:function(a,b){b?_c.unshift(a):_c.push(a)}}),_.Tween=L,L.prototype={constructor:L,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(_.cssNumber[c]?"":"px")},cur:function(){var a=L.propHooks[this.prop];return a&&a.get?a.get(this):L.propHooks._default.get(this)},run:function(a){var b,c=L.propHooks[this.prop];return this.pos=b=this.options.duration?_.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=_.css(a.elem,a.prop,!1,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){_.fx.step[a.prop]?_.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[_.cssProps[a.prop]]||_.cssHooks[a.prop])?_.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},_.each(["toggle","show","hide"],function(a,b){var c=_.fn[b];_.fn[b]=function(d,e,f){return null==d||"boolean"==typeof d||!a&&_.isFunction(d)&&_.isFunction(e)?c.apply(this,arguments):this.animate(M(b,!0),d,e,f)}}),_.fn.extend({fadeTo:function(a,b,c,d){return this.filter(s).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=_.isEmptyObject(a),f=_.speed(b,c,d),g=function(){var b=I(this,_.extend({},a),f);e&&b.stop(!0)};return e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!=typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=_.timers,g=_._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&$c.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem===this&&(null==a||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&_.dequeue(this,a)})}}),_.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){_.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),_.speed=function(a,b,c){var d=a&&"object"==typeof a?_.extend({},a):{complete:c||!c&&b||_.isFunction(a)&&a,duration:a,easing:c&&b||b&&!_.isFunction(b)&&b};return d.duration=_.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in _.fx.speeds?_.fx.speeds[d.duration]:_.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){_.isFunction(d.old)&&d.old.call(this),d.queue&&_.dequeue(this,d.queue)},d},_.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},_.timers=[],_.fx=L.prototype.init,_.fx.tick=function(){var a,c=_.timers,d=0;for(Wc=_.now();d<c.length;d++)a=c[d],!a()&&c[d]===a&&c.splice(d--,1);c.length||_.fx.stop(),Wc=b},_.fx.timer=function(a){a()&&_.timers.push(a)&&!Xc&&(Xc=setInterval(_.fx.tick,_.fx.interval))},_.fx.interval=13,_.fx.stop=function(){clearInterval(Xc),Xc=null},_.fx.speeds={slow:600,fast:200,_default:400},_.fx.step={},_.expr&&_.expr.filters&&(_.expr.filters.animated=function(a){return _.grep(_.timers,function(b){return a===b.elem}).length});var bd=/^(?:body|html)$/i;_.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){_.offset.setOffset(this,a,b)});var c,d,e,f,g,h,i,j={top:0,left:0},k=this[0],l=k&&k.ownerDocument;if(l)return(d=l.body)===k?_.offset.bodyOffset(k):(c=l.documentElement,_.contains(c,k)?("undefined"!=typeof k.getBoundingClientRect&&(j=k.getBoundingClientRect()),e=N(l),f=c.clientTop||d.clientTop||0,g=c.clientLeft||d.clientLeft||0,h=e.pageYOffset||c.scrollTop,i=e.pageXOffset||c.scrollLeft,{top:j.top+h-f,left:j.left+i-g}):j)},_.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return _.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(_.css(a,"marginTop"))||0,c+=parseFloat(_.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=_.css(a,"position");"static"===d&&(a.style.position="relative");var e,f,g=_(a),h=g.offset(),i=_.css(a,"top"),j=_.css(a,"left"),k=("absolute"===d||"fixed"===d)&&_.inArray("auto",[i,j])>-1,l={},m={};k?(m=g.position(),e=m.top,f=m.left):(e=parseFloat(i)||0,f=parseFloat(j)||0),_.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(l.top=b.top-h.top+e),null!=b.left&&(l.left=b.left-h.left+f),"using"in b?b.using.call(a,l):g.css(l)}},_.fn.extend({position:function(){if(this[0]){var a=this[0],b=this.offsetParent(),c=this.offset(),d=bd.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(_.css(a,"marginTop"))||0,c.left-=parseFloat(_.css(a,"marginLeft"))||0,d.top+=parseFloat(_.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(_.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Q.body;a&&!bd.test(a.nodeName)&&"static"===_.css(a,"position");)a=a.offsetParent;return a||Q.body})}}),_.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);_.fn[a]=function(e){return _.access(this,function(a,e,f){var g=N(a);return f===b?g?c in g?g[c]:g.document.documentElement[e]:a[e]:void(g?g.scrollTo(d?_(g).scrollLeft():f,d?f:_(g).scrollTop()):a[e]=f)},a,e,arguments.length,null)}}),_.each({Height:"height",Width:"width"},function(a,c){_.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){_.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(e===!0||f===!0?"margin":"border");return _.access(this,function(c,d,e){var f;return _.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?_.css(c,d,e,h):_.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=_,"function"==typeof c&&c.amd&&c.amd.jQuery&&c("jquery",[],function(){return _})}(window),jQuery.noConflict(!0)}(),c("jqueryPlugins",["jquery"],function(a){a.fn.rotateCursorDown=function(){a("svg").animate({borderSpacing:-150,opacity:1},{step:function(b,c){"borderSpacing"==c.prop?a(this).css("-webkit-transform","rotate("+b+"deg)").css("-moz-transform","rotate("+b+"deg)").css("-ms-transform","rotate("+b+"deg)").css("-o-transform","rotate("+b+"deg)").css("transform","rotate("+b+"deg)"):a(this).css(c.prop,b)},duration:500},"linear").promise().then(function(){this.css("-webkit-transform",""),this.css("-moz-transform",""),this.css("-ms-transform",""),this.css("-o-transform",""),this.css("transform",""),this.css("opacity","")
})},a.fn.rotateCursorDown=function(){a(".togetherjs-cursor svg").animate({borderSpacing:0,opacity:1},{step:function(b,c){"borderSpacing"==c.prop?a(this).css("-webkit-transform","rotate("+b+"deg)").css("-moz-transform","rotate("+b+"deg)").css("-ms-transform","rotate("+b+"deg)").css("-o-transform","rotate("+b+"deg)").css("transform","rotate("+b+"deg)"):a(this).css(c.prop,b)},duration:500},"linear").promise().then(function(){this.css("-webkit-transform",""),this.css("-moz-transform",""),this.css("-ms-transform",""),this.css("-o-transform",""),this.css("transform",""),this.css("opacity","")})},a.fn.popinWindow=function(){a.browser.mobile?(this.css({left:"0px",opacity:1,zIndex:8888}),a("#togetherjs-window-pointer-right").css({left:"+=74px",opacity:1,zIndex:8888}),a("#togetherjs-window-pointer-right").animate({opacity:1,left:"-=78px"},{duration:60,easing:"linear"}),a("#togetherjs-window-pointer-right").queue(),a("#togetherjs-window-pointer-right").animate({left:"+=4px"},{duration:60,easing:"linear"}),this.animate({opacity:1,left:"0px"},{duration:60,easing:"linear"}),this.queue(),this.animate({left:"0px"},{duration:60,easing:"linear"})):(this.css({left:"+=74px",opacity:1,zIndex:8888}),a("#togetherjs-window-pointer-right").css({left:"+=74px",opacity:1,zIndex:8888}),a("#togetherjs-window-pointer-right").animate({opacity:1,left:"-=78px"},{duration:60,easing:"linear"}),a("#togetherjs-window-pointer-right").queue(),a("#togetherjs-window-pointer-right").animate({left:"+=4px"},{duration:60,easing:"linear"}),this.animate({opacity:1,left:"-=78px"},{duration:60,easing:"linear"}),this.queue(),this.animate({left:"+=4px"},{duration:60,easing:"linear"}))},a.fn.slideIn=function(){return this.css({left:"+=74px",opacity:0,zIndex:8888}),this.animate({left:"-=74px",opacity:1,zIndex:9999},"fast")},a.fn.fadeOut=function(){return this.animate({borderSpacing:-90,opacity:.5},{step:function(b,c){"borderSpacing"==c.prop?a(this).css("-webkit-transform","perspective( 600px ) rotateX("+b+"deg)").css("-moz-transform","perspective( 600px ) rotateX("+b+"deg)").css("-ms-transform","perspective( 600px ) rotateX("+b+"deg)").css("-o-transform","perspective( 600px ) rotateX("+b+"deg)").css("transform","perspective( 600px ) rotateX("+b+"deg)"):a(this).css(c.prop,b)},duration:500},"linear").promise().then(function(){this.css("-webkit-transform",""),this.css("-moz-transform",""),this.css("-ms-transform",""),this.css("-o-transform",""),this.css("transform",""),this.css("opacity","")}),this},a.fn.easeTo=function(a){return this.animate({scrollTop:a},{duration:400,easing:"swing"})},a.fn.animateDockEntry=function(){var a=this.height(),b=this.width(),c=a+4,d=parseInt(this.css("marginLeft"),10);this.css({marginLeft:d+b/2,height:0,width:0,backgroundSize:"0 0"});var e=this;return this.animate({marginLeft:d,height:a,width:b,backgroundSize:c},{duration:600}).promise().then(function(){e.css({marginLeft:"",height:"",width:"",backgroundSize:""})}),this},a.fn.animateDockExit=function(){var a=(this.height(),this.width()),b=parseInt(this.css("marginLeft"),10);return this.animate({marginLeft:b+a/2,height:0,width:0,backgroundSize:"0 0",opacity:0},600),this},a.fn.animateCursorEntry=function(){},a.fn.animateKeyboard=function(){var a=this.find(".togetherjs-typing-ellipse-one"),b=this.find(".togetherjs-typing-ellipse-two"),c=this.find(".togetherjs-typing-ellipse-three"),d=-1,e=function(){d=(d+1)%4,0===d?(a.css("opacity",.5),b.css("opacity",.5),c.css("opacity",.5)):1==d?a.css("opacity",1):2==d?b.css("opacity",1):c.css("opacity",1)}.bind(this);e();var f=setInterval(e,300);this.data("animateKeyboard",f)},a.fn.stopKeyboardAnimation=function(){clearTimeout(this.data("animateKeyboard")),this.data("animateKeyboard",null)},a.browser||(a.browser={}),a.browser.mobile=void 0!==window.orientation,-1!=navigator.userAgent.search(/mobile/i)&&(a.browser.mobile=!0),a.browser.mobile&&window.matchMedia&&!window.matchMedia("screen and (max-screen-width: 480px)").matches&&(document.body.className+=" togetherjs-mobile-browser")}),c("util",["jquery","jqueryPlugins"],function(a){var b={};return b.Deferred=a.Deferred,TogetherJS.$=a,b.Class=function(a,b){var c;if(void 0===b)b=a;else{a.prototype&&(a=a.prototype);var d=Object.create(a);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);b=d}var e=function(){var a=Object.create(b);return a.constructor.apply(a,arguments),a.constructor=e,a};if(e.prototype=b,b.constructor.name&&(e.className=b.constructor.name,e.toString=function(){return"[Class "+this.className+"]"}),b.classMethods)for(c in b.classMethods)b.classMethods.hasOwnProperty(c)&&(e[c]=b.classMethods[c]);return e},b.extend=TogetherJS._extend,b.forEachAttr=function(a,b,c){c=c||a;for(var d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d)},b.trim=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},b.safeClassName=function(a){return a.replace(/[^a-zA-Z0-9_\-]/g,"_")||"class"},b.AssertionError=function(a){return!this instanceof b.AssertionError?new b.AssertionError(a):(this.message=a,void(this.name="AssertionError"))},b.AssertionError.prototype=Error.prototype,b.assert=function(a){if(!a){var c=["Assertion error:"].concat(Array.prototype.slice.call(arguments,1));throw console.error.apply(console,c),console.trace&&console.trace(),new b.AssertionError(c.join(" "))}},b.generateId=function(a){a=a||10;for(var b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV0123456789",c="",d=0;a>d;d++)c+=b.charAt(Math.floor(Math.random()*b.length));return c},b.pickRandom=function(a){return a[Math.floor(Math.random()*a.length)]},b.mixinEvents=TogetherJS._mixinEvents,b.Module=b.Class({constructor:function(a){this._name=a},toString:function(){return"[Module "+this._name+"]"}}),b.blobToBase64=function(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return btoa(b)},b.truncateCommonDomain=function(a,b){if(!b)return a;var c=/^https?:\/\/[^\/]*/i,d=c.exec(a),e=c.exec(b);return d&&e&&d[0]==e[0]?a.substr(d[0].length):a},b.makeUrlAbsolute=function(a,c){if(0===a.search(/^(http|https|ws|wss):/i))return a;if(0===a.search(/^\/\/[^\/]/)){var d=/^(http|https|ws|wss):/i.exec(c);return b.assert(d,"No scheme on base URL",c),d[1]+":"+a}if(0===a.search(/^\//)){var e=/^(http|https|ws|wss):\/\/[^\/]+/i.exec(c);return b.assert(e,"No scheme/domain on base URL",c),e[0]+a}var f=/[^\/]+$/.exec(c);b.assert(f,"Does not appear to be a URL?",c);var g=c.substr(0,f.index);return g+a},b.assertValidUrl=function(a){b.assert("string"==typeof a,"URLs must be a string:",a),b.assert(0===a.search(/^(http:\/\/|https:\/\/|\/\/|data:)/i),"URL must have an http, https, data, or // scheme:",a),b.assert(-1===a.search(/[\)\'\"\ ]/),"URLs cannot contain ), ', \", or spaces:",JSON.stringify(a))},b.resolver=function(a,c){return b.assert(a.then,"Bad deferred:",a),b.assert("function"==typeof c,"Not a function:",c),function(){var b;try{b=c.apply(this,arguments)}catch(d){throw a.reject(d),d}return b&&b.then?b.then(function(){a.resolveWith(this,arguments)},function(){a.rejectWith(this,arguments)}):void 0===b?a.resolve():a.resolve(b),b}},b.isPromise=function(a){return"object"==typeof a&&a.then},b.makePromise=function(c){return b.isPromise(c)?c:a.Deferred(function(a){a.resolve(c)})},b.resolveMany=function(){var a,c=!1;return 1==arguments.length&&Array.isArray(arguments[0])?(c=!0,a=arguments[0]):a=Array.prototype.slice.call(arguments),b.Deferred(function(b){function d(){e||(g?c?b.reject(f):b.reject.apply(b,f):c?b.resolve(f):b.resolve.apply(b,f))}var e=a.length;if(!e)return void b.resolve();var f=[],g=!1;a.forEach(function(a,b){a.then(function(a){f[b]=a,e--,d()},function(a){f[b]=a,g=!0,e--,d()})})})},b.readFileImage=function(a){return b.Deferred(function(c){var d=new FileReader;d.onload=function(){c.resolve("data:image/jpeg;base64,"+b.blobToBase64(this.result))},d.onerror=function(){c.reject(this.error)},d.readAsArrayBuffer(a.files[0])})},b.matchElement=function(b,c){if(c===!0||!c)return!!c;try{return a(b).is(c)}catch(d){return console.warn("Bad selector:",c,"error:",d),!1}},b.testExpose=function(a){"undefined"!=typeof TogetherJSTestSpy&&b.forEachAttr(a,function(a,b){TogetherJSTestSpy[b]=a})},b}),c("analytics",["util"],function(a){var b=a.Module("analytics");return b.activate=function(){var a=TogetherJS.config.get("enableAnalytics"),b=TogetherJS.config.get("analyticsCode");if(TogetherJS.config.close("enableAnalytics"),TogetherJS.config.close("analyticsCode"),a&&b){var c=window._gaq||[];c.push(["_setAccount",b]),c.push(["_setDomainName",location.hostname]),c.push(["_trackPageview"]),window._gaq=c,function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}()}},b}),c("channels",["util"],function(a){var b=a.Module("channels"),c=a.mixinEvents({onmessage:null,rawdata:!1,onclose:null,closed:!1,baseConstructor:function(){this._buffer=[],this._setupConnection()},send:function(a){if(this.closed)throw"Cannot send to a closed connection";return"string"!=typeof a&&(a=JSON.stringify(a)),this._ready()?void this._send(a):void this._buffer.push(a)},_flush:function(){for(var a=0;a<this._buffer.length;a++)this._send(this._buffer[a]);this._buffer=[]},_incoming:function(a){if(!this.rawdata)try{a=JSON.parse(a)}catch(b){throw console.error("Got invalid JSON data:",a.substr(0,40)),b}this.onmessage&&this.onmessage(a),this.emit("message",a)}});b.WebSocketChannel=a.Class(c,{constructor:function(a){0===a.search(/^https?:/i)&&(a=a.replace(/^http/i,"ws")),this.address=a,this.socket=null,this._reopening=!1,this._lastConnectTime=0,this._backoff=0,this.baseConstructor()},backoffTime:50,maxBackoffTime:1500,backoffDetection:2e3,toString:function(){var a="[WebSocketChannel to "+this.address;return a+=this.socket?" readyState: "+this.socket.readyState:" (socket unopened)",this.closed&&(a+=" CLOSED"),a+"]"},close:function(){this.closed=!0,this.socket?this.socket.close():(this.onclose&&this.onclose(),this.emit("close"))},_send:function(a){this.socket.send(a)},_ready:function(){return this.socket&&this.socket.readyState==this.socket.OPEN},_setupConnection:function(){this.closed||(this._lastConnectTime=Date.now(),this.socket=new WebSocket(this.address),this.socket.onopen=function(){this._flush(),this._reopening=!1}.bind(this),this.socket.onclose=function(a){this.socket=null;var b="error";if(a.wasClean&&(b="log"),console[b]("WebSocket close",a.wasClean?"clean":"unclean","code:",a.code,"reason:",a.reason||"none"),!this.closed){this._reopening=!0,Date.now()-this._lastConnectTime>this.backoffDetection?this._backoff=0:this._backoff++;var c=Math.min(this._backoff*this.backoffTime,this.maxBackoffTime);setTimeout(function(){this._setupConnection()}.bind(this),c)}}.bind(this),this.socket.onmessage=function(a){this._incoming(a.data)}.bind(this),this.socket.onerror=function(a){console.error("WebSocket error:",a.data)}.bind(this))}}),b.PostMessageChannel=a.Class(c,{_pingPollPeriod:100,_pingPollIncrease:100,_pingMax:2e3,constructor:function(a,b){this.expectedOrigin=b,this._pingReceived=!1,this._receiveMessage=this._receiveMessage.bind(this),a&&this.bindWindow(a,!0),this._pingFailures=0,this.baseConstructor()},toString:function(){var a="[PostMessageChannel";return a+=this.window?" to window "+this.window:" not bound to a window",this.window&&!this._pingReceived&&(a+=" still establishing"),a+"]"},bindWindow:function(a,b){this.window&&(this.close(),this.closed=!1),a&&a.contentWindow&&(a=a.contentWindow),this.window=a;var c=this.window;"undefined"!=typeof window&&(c=window),c.addEventListener("message",this._receiveMessage,!1),b||this._setupConnection()},_send:function(a){this.window.postMessage(a,this.expectedOrigin||"*")},_ready:function(){return this.window&&this._pingReceived},_setupConnection:function(){if(!this.closed&&!this._pingReceived&&this.window){this._pingFailures++,this._send("hello");var a=this._pingPollPeriod+this._pingPollIncrease*this._pingFailures;a=a>this._pingPollMax?this._pingPollMax:a,this._pingTimeout=setTimeout(this._setupConnection.bind(this),a)}},_receiveMessage:function(a){return a.source===this.window?this.expectedOrigin&&a.origin!=this.expectedOrigin?void console.info("Expected message from",this.expectedOrigin,"but got message from",a.origin):(this.expectedOrigin||(this.expectedOrigin=a.origin),"hello"==a.data?(this._pingReceived=!0,this._pingTimeout&&(clearTimeout(this._pingTimeout),this._pingTimeout=null),void this._flush()):void this._incoming(a.data)):void 0},close:function(){this.closed=!0,this._pingReceived=!1,this._pingTimeout&&clearTimeout(this._pingTimeout),window.removeEventListener("message",this._receiveMessage,!1),this.onclose&&this.onclose(),this.emit("close")}}),b.PostMessageIncomingChannel=a.Class(c,{constructor:function(a){this.source=null,this.expectedOrigin=a,this._receiveMessage=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessage,!1),this.baseConstructor()},toString:function(){var a="[PostMessageIncomingChannel";return a+=this.source?" bound to source "+a:" awaiting source",a+"]"},_send:function(a){this.source.postMessage(a,this.expectedOrigin)},_ready:function(){return!!this.source},_setupConnection:function(){},_receiveMessage:function(a){return this.expectedOrigin&&"*"!=this.expectedOrigin&&a.origin!=this.expectedOrigin?void console.info("Expected message from",this.expectedOrigin,"but got message from",a.origin):(this.expectedOrigin||(this.expectedOrigin=a.origin),this.source||(this.source=a.source),"hello"==a.data?void this.source.postMessage("hello",this.expectedOrigin):void this._incoming(a.data))},close:function(){this.closed=!0,window.removeEventListener("message",this._receiveMessage,!1),this._pingTimeout&&clearTimeout(this._pingTimeout),this.onclose&&this.onclose(),this.emit("close")}}),b.Router=a.Class(a.mixinEvents({constructor:function(a){this._channelMessage=this._channelMessage.bind(this),this._channelClosed=this._channelClosed.bind(this),this._routes=Object.create(null),a&&this.bindChannel(a)},bindChannel:function(a){this.channel&&(this.channel.removeListener("message",this._channelMessage),this.channel.removeListener("close",this._channelClosed)),this.channel=a,this.channel.on("message",this._channelMessage.bind(this)),this.channel.on("close",this._channelClosed.bind(this))},_channelMessage:function(a){if("route"==a.type){var b=a.routeId,c=this._routes[b];if(!c)return void console.warn("No route with the id",b);a.close?this._closeRoute(c.id):(c.onmessage&&c.onmessage(a.message),c.emit("message",a.message))}},_channelClosed:function(){for(var a in this._routes)this._closeRoute(a)},_closeRoute:function(a){var b=this._routes[a];b.onclose&&b.onclose(),b.emit("close"),delete this._routes[a]},makeRoute:function(b){b=b||a.generateId();var c=d(this,b);return this._routes[b]=c,c}}));var d=a.Class(a.mixinEvents({constructor:function(a,b){this.router=a,this.id=b},send:function(a){this.router.channel.send({type:"route",routeId:this.id,message:a})},close:function(){this.router._routes[this.id]===this&&delete this.router._routes[this.id]}}));return b}),c("storage",["util"],function(a){var b=a.assert,c=a.Deferred,d={name:"",defaultName:"",avatar:null,stickyShare:null,color:null,seenIntroDialog:!1,seenWalkthrough:!1,dontShowRtcInfo:!1},e=!1,f=a.Class({constructor:function(a,b,c){this.name=a,this.storage=b,this.prefix=c},get:function(b,d){var f=this;return c(function(c){setTimeout(a.resolver(c,function(){b=f.prefix+b;var a=f.storage.getItem(b);return a?(a=JSON.parse(a),e&&console.debug("Get storage",b,"=",a)):(a=d,e&&console.debug("Get storage",b,"defaults to",a)),a}))})},set:function(a,b){var d=this;return void 0!==b&&(b=JSON.stringify(b)),c(function(c){a=d.prefix+a,void 0===b?(d.storage.removeItem(a),e&&console.debug("Delete storage",a)):(d.storage.setItem(a,b),e&&console.debug("Set storage",a,b)),setTimeout(c.resolve)})},clear:function(){var b=this,d=[];return c(function(c){this.keys().then(function(e){e.forEach(function(a){d.push(b.set(a,void 0))}),a.resolveMany(d).then(function(){c.resolve()})})}.bind(this))},keys:function(b,d){var e=this;return c(function(c){setTimeout(a.resolver(c,function(){b=b||"";for(var a=[],c=0;c<e.storage.length;c++){var f=e.storage.key(c);if(0===f.indexOf(e.prefix+b)){var g=f.substr(e.prefix.length);d&&(g=g.substr(b.length)),a.push(g)}}return a}))})},toString:function(){return"[storage for "+this.name+"]"}}),g=TogetherJS.config.get("storagePrefix");TogetherJS.config.close("storagePrefix");var h=f("localStorage",localStorage,g+".");return h.settings=a.mixinEvents({defaults:d,get:function(a){return b(h.settings.defaults.hasOwnProperty(a),"Unknown setting:",a),h.get("settings."+a,h.settings.defaults[a])},set:function(a,c){return b(h.settings.defaults.hasOwnProperty(a),"Unknown setting:",a),h.set("settings."+a,c)}}),h.tab=f("sessionStorage",sessionStorage,g+"-session."),h}),c("session",["require","util","channels","jquery","storage"],function(a,b,c,d,e){function f(){s(!t,"Attempt to re-open channel"),console.info("Connecting to",r.hubUrl(),location.href);var a=c.WebSocketChannel(r.hubUrl());a.onmessage=function(a){return y?(p&&-1==w.indexOf(a.type)&&console.info("In:",a),o?a.clientId||-1!=x.indexOf(a.type)?(a.clientId&&(a.peer=o.getPeer(a.clientId,a)),("hello"==a.type||"hello-back"==a.type||"peer-update"==a.type)&&a.peer.updateFromHello(a),a.peer&&(a.sameUrl=a.peer.url==v,a.peer.isSelf||a.peer.updateMessageDate(a)),r.hub.emit(a.type,a),void TogetherJS._onmessage(a)):void console.warn("Got message without clientId, where clientId is required",a):void console.warn("Message received before all modules loaded (ignoring):",a)):void(p&&console.info("In (but ignored for being early):",a))},t=a,r.router.bindChannel(t)}function g(b){if(!b.sameUrl){var c=b.url;b.urlHash&&(c+=b.urlHash),a("ui").showUrlChangeMessage(b.peer,c),location.href=c}}function h(a){var b=r.makeHelloMessage(a);a||(r.timeHelloSent=Date.now(),o.Self.url=b.url),r.send(b)}function i(a,b){var c=TogetherJS.config.get("hubBase").replace(/\/*$/,"")+"/findroom";return d.ajax({url:c,dataType:"json",data:{prefix:a,max:b}}).then(function(a){return a.name})}function j(){return b.Deferred(function(a){return r.identityId?void a.resolve():void e.get("identityId").then(function(c){c||(c=b.generateId(),e.set("identityId",c)),r.identityId=c,a.resolve()})})}function k(){return b.Deferred(function(a){var c,d=location.hash,f=r.shareId,g=!0,h=!0;if(r.firstRun=!TogetherJS.startup.continued,f||TogetherJS.startup._joinShareId&&(f=TogetherJS.startup._joinShareId),!f){var j=/&?togetherjs=([^&]*)/.exec(d);if(j){g=!j[1],f=j[2];var k=d.substr(0,j.index)+d.substr(j.index+j[0].length);location.hash=k}}return e.tab.get("status").then(function(d){var j=TogetherJS.config.get("findRoom");if(TogetherJS.config.close("findRoom"),j&&d&&j!=d.shareId?console.info("Ignoring findRoom in lieu of continued session"):j&&TogetherJS.startup._joinShareId&&console.info("Ignoring findRoom in lieu of explicit invite to session"),!j||"string"!=typeof j||d||TogetherJS.startup._joinShareId){if(j&&!d&&!TogetherJS.startup._joinShareId)return s(j.prefix&&"string"==typeof j.prefix,"Bad findRoom.prefix",j),s(j.max&&"number"==typeof j.max&&j.max>0,"Bad findRoom.max",j),c=b.generateId(),-1!=j.prefix.search(/[^a-zA-Z0-9]/)&&console.warn("Bad value for findRoom.prefix:",JSON.stringify(j.prefix)),void i(j.prefix,j.max).then(function(b){r.clientId=r.identityId+"."+c,e.tab.set("status",{reason:"joined",shareId:b,running:!0,date:Date.now(),sessionId:c}),r.isClient=!0,r.shareId=b,r.emit("shareId"),a.resolve(r.shareId)});if(TogetherJS.startup._launch)d?(g="joined"==d.reason,f||(f=d.shareId),c=d.sessionId):(g="joined"==TogetherJS.startup.reason,s(!c),c=b.generateId()),f||(f=b.generateId());else{if(!d)throw new b.AssertionError("No saved status, and no startup._launch request; why did TogetherJS start?");g="joined"==d.reason,TogetherJS.startup.reason=d.reason,TogetherJS.startup.continued=!0,f=d.shareId,c=d.sessionId,h=!d.running}}else g=!0,f=j,c=b.generateId();s(r.identityId),r.clientId=r.identityId+"."+c,h&&e.tab.set("status",{reason:TogetherJS.startup.reason,shareId:f,running:!0,date:Date.now(),sessionId:c}),r.isClient=g,r.shareId=f,r.emit("shareId"),a.resolve(r.shareId)})})}function l(){var a;return TogetherJS.startup.button?(a=TogetherJS.startup.button.id,void(a&&e.set("startTarget",a))):void e.get("startTarget").then(function(a){var b=document.getElementById(a);b&&(TogetherJS.startup.button=b)})}function m(){h(!1)}function n(){r.emit("resize")}var o,p=!0,q=1500,r=b.mixinEvents(b.Module("session")),s=b.assert;r.shareId=null,r.clientId=null,r.router=c.Router(),r.firstRun=!1;var t=null;r.AVATAR_SIZE=90;var u=TogetherJS.config.get("includeHashInUrl");TogetherJS.config.close("includeHashInUrl");var v=(location.href+"").replace(/\#.*$/,"");u&&(v=location.href),r.hubUrl=function(a){a=a||r.shareId,s(a,"URL cannot be resolved before TogetherJS.shareId has been initialized"),TogetherJS.config.close("hubBase");var b=TogetherJS.config.get("hubBase");return b.replace(/\/*$/,"")+"/hub/"+a},r.shareUrl=function(){s(r.shareId,"Attempted to access shareUrl() before shareId is set");var a=location.hash,b=/\?[^#]*/.exec(location.href),c="";return b&&(c=b[0]),a=a.replace(/&?togetherjs-[a-zA-Z0-9]+/,""),a=a||"#",location.protocol+"//"+location.host+location.pathname+c+a+"&togetherjs="+r.shareId},r.recordUrl=function(){s(r.shareId);var a=TogetherJS.baseUrl.replace(/\/*$/,"")+"/togetherjs/recorder.html";return a+="#&togetherjs="+r.shareId+"&hubBase="+TogetherJS.config.get("hubBase")},r.currentUrl=function(){return u?location.href:location.href.replace(/#.*/,"")},r.hub=b.mixinEvents({});var w=TogetherJS.config.get("ignoreMessages");w===!0&&(p=!1,w=[]);var x=["who","invite","init-connection"],y=!1;r.send=function(a){p&&-1==w.indexOf(a.type)&&console.info("Send:",a),a.clientId=r.clientId,t.send(a)},r.appSend=function(a){var b=a.type;0===b.search(/^togetherjs\./)?b=b.substr("togetherjs.".length):-1===b.search(/^app\./)&&(b="app."+b),a.type=b,r.send(a)},r.hub.on("hello hello-back",function(a){"hello"==a.type&&h(!0),r.isClient&&!a.isClient&&r.firstRun&&r.timeHelloSent&&Date.now()-r.timeHelloSent<q&&g(a)}),r.hub.on("who",function(){h(!0)}),r.timeHelloSent=null,r.makeHelloMessage=function(a){var b={name:o.Self.name||o.Self.defaultName,avatar:o.Self.avatar,color:o.Self.color,url:r.currentUrl(),urlHash:location.hash,title:document.title,rtcSupported:r.RTCSupported,isClient:r.isClient};return a?b.type="hello-back":(b.type="hello",b.clientVersion=TogetherJS.version),TogetherJS.startup.continued||(b.starting=!0),r.emit("prepare-hello",b),b};var z=["peers","ui","chat","webrtc","cursor","startup","videos","forms","visibilityApi","youtubeVideos"];return j.done=j(),r.start=function(){l(),j().then(function(){k().then(function(){y=!1,f(),a(["ui"],function(b){TogetherJS.running=!0,b.prepareUI(),a(z,function(){d(function(){o=a("peers");var c=a("startup");r.emit("start"),r.once("ui-ready",function(){y=!0,c.start()}),b.activateUI(),TogetherJS.config.close("enableAnalytics"),TogetherJS.config.get("enableAnalytics")&&a(["analytics"],function(a){a.activate()}),o._SelfLoaded.then(function(){h(!1)}),TogetherJS.emit("ready")})})})})})},r.close=function(a){TogetherJS.running=!1;var b={type:"bye"};a&&(b.reason=a),r.send(b),r.emit("close");var c=window.name;e.tab.get("status").then(function(a){a?(a.running=!1,a.date=Date.now(),e.tab.set("status",a)):console.warn("No session information saved in","status."+c),t.close(),t=null,r.shareId=null,r.emit("shareId"),TogetherJS.emit("close"),TogetherJS._teardown()})},r.on("start",function(){d(window).on("resize",n),u&&d(window).on("hashchange",m)}),r.on("close",function(){d(window).off("resize",n),u&&d(window).off("hashchange",m)}),TogetherJS.startup._launch&&setTimeout(r.start),b.testExpose({getChannel:function(){return t}}),r}),c("templates",["util"],function(a){function b(b){return b=b.replace(/[<][%]\s*\/\*[\S\s\r\n]*\*\/\s*[%][>]/,""),b=a.trim(b),b=b.replace(/http:\/\/localhost:8080/g,TogetherJS.baseUrl)}return{"interface":b('<% /*\n   This is basically all the markup and interface for TogetherJS.\n   Note all links should be like http://localhost:8080/togetherjs/*\n   these links are rewritten with the location where TogetherJS was deployed.\n\n   This file is inlined into togetherjs/templates.js\n*/ %>\n<div id="togetherjs-container" class="togetherjs">\n\n  <!-- This is the main set of buttons: -->\n  <div id="togetherjs-dock" class="togetherjs-dock-right">\n    <div id="togetherjs-dock-anchor" title="Move the dock">\n      <span id="togetherjs-dock-anchor-horizontal">\n        <img src="http://localhost:8080/togetherjs/images/icn-handle-circle@2x.png" alt="drag">\n      </span>\n      <span id="togetherjs-dock-anchor-vertical">\n        <img src="http://localhost:8080/togetherjs/images/icn-handle-circle@2x.png" alt="drag">\n      </span>\n    </div>\n    <div id="togetherjs-buttons">\n      <div style="display: none">\n        <button id="togetherjs-template-dock-person" class="togetherjs-button togetherjs-dock-person">\n          <div class="togetherjs-tooltip togetherjs-dock-person-tooltip">\n            <span class="togetherjs-person-name"></span>\n            <span class="togetherjs-person-tooltip-arrow-r"></span>\n          </div>\n          <div class="togetherjs-person togetherjs-person-status-overlay"></div>\n        </button>\n      </div>\n      <button id="togetherjs-profile-button" class="togetherjs-button" title="This is you">\n        <div class="togetherjs-person togetherjs-person-self"></div>\n        <div id="togetherjs-profile-arrow"></div>\n      </button>\n      <button id="togetherjs-share-button" class="togetherjs-button" title="Add a friend"></button>\n      <button id="togetherjs-audio-button" class="togetherjs-button" title="Turn on microphone">\n        <span id="togetherjs-audio-unavailable" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set">\n        </span>\n        <span id="togetherjs-audio-ready" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-outgoing" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-incoming" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-active" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-muted" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-error" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n      </button>\n      <button id="togetherjs-chat-button" class="togetherjs-button" title="Chat"></button>\n      <div id="togetherjs-dock-participants"></div>\n    </div>\n  </div>\n\n  <!-- The window for editing the avatar: -->\n  <div id="togetherjs-avatar-edit" class="togetherjs-modal"\n       style="display: none">\n    <header> Update avatar </header>\n    <section>\n      <div class="togetherjs-avatar-preview togetherjs-person togetherjs-person-self"></div>\n      <div id="togetherjs-avatar-buttons">\n        <input type="file" class="togetherjs-upload-avatar">\n        <!--<button id="togetherjs-upload-avatar" class="togetherjs-primary">Upload a picture</button>-->\n        <!--<button id="togetherjs-camera-avatar" class="togetherjs-default">Take a picture</button>-->\n      </div>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-cancel togetherjs-dismiss">Cancel</button>\n      <span class="togetherjs-alt-text">or</span>\n      <button class="togetherjs-avatar-save togetherjs-primary">Save</button>\n    </section>\n  </div>\n\n  <!-- The window for sharing the link: -->\n  <div id="togetherjs-share" class="togetherjs-window"\n       data-bind-to="#togetherjs-share-button" style="display: none">\n    <header> Invite a friend </header>\n    <section>\n      <div class="togetherjs-not-mobile">\n        <p>Copy and paste this link over IM or email:</p>\n        <input type="text" class="togetherjs-share-link">\n      </div>\n      <div class="togetherjs-only-mobile">\n        <p>Copy and paste this link over IM or email:</p>\n        <input type="text" class="togetherjs-share-link">\n        <!-- <a class="togetherjs-share-link" href="#">Press your thumb here.</a> -->\n      </div>\n    </section>\n  </div>\n\n  <!-- Participant Full List view template: -->\n  <div id="togetherjs-participantlist" class="togetherjs-window"\n       data-bind-to="#togetherjs-participantlist-button" style="display: none">\n    <header> Participants </header>\n    <section>\n      <div class="togetherjs-not-mobile">\n        <ul>\n          <li id="togetherjs-participant-item">\n            <img class="togetherjs-person togetherjs-person-small" src="http://localhost:8080/togetherjs/images/btn-menu-change-avatar.png">\n            <span class="tj-name togetherjs-person-name">Useronewith alongname</span>\n            <span class="tj-status">&#9679;</span>\n            <p class="tj-urllocation">Currently at: <a class="togetherjs-person-url togetherjs-person-url-title" href="">http://www.location.comwww.location.comwww.location.comasdfsafd</a></p>\n            <p class="tj-follow">Follow:\n              <label class="togetherjs-follow-question" for="togetherjs-person-status-follow">\n                <input type="checkbox" id="togetherjs-person-status-follow">\n              </label>\n            </p>\n            <section class="togetherjs-buttons">\n              <!-- Displayed when the peer is at a different URL: -->\n              <div class="togetherjs-different-url">\n                <a class="togetherjs-nudge togetherjs-default tj-btn-sm">Nudge them</a>\n                <a href="#" class="togetherjs-follow togetherjs-person-url togetherjs-primary tj-btn-sm">Join them</a>\n              </div>\n              <!-- Displayed when the peer is at your same URL: -->\n              <div class="togetherjs-same-url" style="display: none">\n                <span class="togetherjs-person-name"></span> is on the same page as you.\n              </div>\n            </section>\n          </li>\n        </ul>\n    </section>\n  </div>\n\n  <!-- Participant detail template: -->\n  <div id="togetherjs-template-participant-window" class="togetherjs-window" style="display: none">\n    <header><div class="togetherjs-person togetherjs-person-small"></div><span class="togetherjs-person-name"></span></header>\n\n    <section class="togetherjs-participant-window-main">\n      <p class="togetherjs-participant-window-row"><strong>Role:</strong>\n        <span class="togetherjs-person-role"></span>\n      </p>\n\n      <p class="togetherjs-participant-window-row"><strong>Currently at:</strong>\n        <a class="togetherjs-person-url togetherjs-person-url-title"></a>\n      </p>\n\n      <p class="togetherjs-participant-window-row"><strong>Status:</strong>\n        <span class="togetherjs-person-status"></span>\n      </p>\n\n      <p class="togetherjs-participant-window-row"><strong class="togetherjs-float-left">Follow this participant:</strong>\n        <label class="togetherjs-follow-question togetherjs-float-left" for="togetherjs-person-status-follow">\n          <input type="checkbox" id="togetherjs-person-status-follow">\n        </label>\n        <span class="togetherjs-clear"></span>\n      </p>\n\n    </section>\n\n    <section class="togetherjs-buttons">\n      <!-- Displayed when the peer is at a different URL: -->\n      <div class="togetherjs-different-url">\n        <a class="togetherjs-nudge togetherjs-default">Nudge them</a>\n        <a href="#" class="togetherjs-follow togetherjs-person-url togetherjs-primary">Join them</a>\n      </div>\n      <!-- Displayed when the peer is at your same URL: -->\n      <div class="togetherjs-same-url" style="display: none">\n        <span class="togetherjs-person-name"></span> is on the same page as you.\n      </div>\n    </section>\n  </div>\n\n  <!-- The chat screen: -->\n  <div id="togetherjs-chat" class="togetherjs-window" data-bind-to="#togetherjs-chat-button"\n       style="display: none">\n    <header> Chat </header>\n    <section class="togetherjs-subtitle">\n      <div id="togetherjs-chat-participants" data-toggles="#togetherjs-chat-no-participants" style="display: none">\n        <span id="togetherjs-chat-participant-list"></span>\n        &amp; You\n      </div>\n      <div id="togetherjs-chat-no-participants" data-toggles="#togetherjs-chat-participants">\n        No one else is here.\n      </div>\n    </section>\n\n    <div style="display: none">\n\n      <!-- Template for one message: -->\n      <div id="togetherjs-template-chat-message" class="togetherjs-chat-item togetherjs-chat-message">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-timestamp"><span class="togetherjs-time">HH:MM</span> <span class="togetherjs-ampm">AM/PM</span></div>\n        <div class="togetherjs-person-name-abbrev"></div>\n        <div class="togetherjs-chat-content togetherjs-sub-content"></div>\n      </div>\n\n      <!-- Template for when a person leaves: -->\n      <div id="togetherjs-template-chat-left" class="togetherjs-chat-item togetherjs-chat-left-item">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-ifnot-declinedJoin">\n          <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> left the session.</div>\n        </div>\n        <div class="togetherjs-if-declinedJoin">\n          <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> declined to join the session.</div>\n        </div>\n        <div class="togetherjs-clear"></div>\n      </div>\n\n      <!-- Template when a person joins the session: -->\n      <div id="togetherjs-template-chat-joined" class="togetherjs-chat-item togetherjs-chat-join-item">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> joined the session.</div>\n        <div class="togetherjs-clear"></div>\n      </div>\n\n      <!-- Template for system-derived messages: -->\n      <div id="togetherjs-template-chat-system" class="togetherjs-chat-item">\n        <span class="togetherjs-chat-content togetherjs-sub-content"></span>\n      </div>\n\n      <!-- Template when a person joins the session: -->\n      <!-- <div id="togetherjs-template-chat-joined" class="togetherjs-chat-item togetherjs-chat-join-item">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> joined the session.</div>\n        <div class="togetherjs-clear"></div>\n      </div> -->\n\n      <!-- Template for when someone goes to a new URL: -->\n      <div id="togetherjs-template-url-change" class="togetherjs-chat-item togetherjs-chat-url-change">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-inline-text">\n          <div class="togetherjs-if-sameUrl">\n            <span class="togetherjs-person-name"></span>\n            is on the same page as you.\n          </div>\n          <div class="togetherjs-ifnot-sameUrl">\n            <span class="togetherjs-person-name"></span>\n            has gone to: <a href="#" class="togetherjs-person-url togetherjs-person-url-title" target="_self"></a>\n            <section class="togetherjs-buttons togetherjs-buttons-notification-diff-url">\n              <!-- Displayed when the peer is at a different URL: -->\n              <div class="togetherjs-different-url togetherjs-notification-diff-url">\n                <a class="togetherjs-nudge togetherjs-default">Nudge them</a>\n                <a href="#" class="togetherjs-follow togetherjs-person-url togetherjs-primary">Join them</a>\n              </div>\n            </section>\n\n            <!-- <div>\n              <a class="togetherjs-nudge togetherjs-secondary">Nudge them</a>\n              <a href="" class="togetherjs-person-url togetherjs-follow togetherjs-primary">Join them</a>\n            </div> -->\n\n          </div>\n        </div>\n        <div class="togetherjs-clear"></div>\n      </div>\n    </div>\n\n    <section id="togetherjs-chat-messages">\n      <!-- FIX ME// need to have some dialogue that says something like - There are no chats yet! -->\n    </section>\n    <section id="togetherjs-chat-input-box">\n      <textarea id="togetherjs-chat-input" placeholder="Type your message here"></textarea>\n    </section>\n  </div>\n\n  <!-- this is a kind of warning popped up when you (successfully) start RTC: -->\n  <div id="togetherjs-rtc-info" class="togetherjs-window"\n       data-bind-to="#togetherjs-audio-button"\n       style="display: none">\n\n    <header> Audio Chat </header>\n    <section>\n      <p>\n        Activate your <strong>browser microphone</strong> near your URL bar above.\n      </p>\n      <p>\n        Talking on your microphone through your web browser is an experimental feature.\n      </p>\n      <p>\n        Read more about Audio Chat <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">here</a>.\n      </p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <label for="togetherjs-rtc-info-dismiss" style="display: inline;">\n        <input class="togetherjs-dont-show-again" id="togetherjs-rtc-info-dismiss" type="checkbox">\n        Don\'t show again.\n      </label>\n      <button class="togetherjs-default togetherjs-dismiss" type="button">Close</button>\n    </section>\n  </div>\n\n  <!-- this is popped up when you hit the audio button, but RTC isn\'t\n  supported: -->\n  <div id="togetherjs-rtc-not-supported" class="togetherjs-window"\n       data-bind-to="#togetherjs-audio-button"\n       style="display: none">\n    <header> Audio Chat </header>\n\n    <section>\n      <p>Audio chat requires you to use a <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">\n        newer browser\n      </a>!</p>\n      <p>\n        Live audio chat requires a newer (or different) browser than you\'re using.\n      </p>\n      <p>\n        See\n        <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">\n          this page\n        </a>\n        for more information and a list of supported browsers.\n      </p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <div class="togetherjs-rtc-dialog-btn">\n        <button class="togetherjs-default togetherjs-dismiss" type="button">Close</button>\n      </div>\n    </section>\n  </div>\n\n  <!-- The popup when a chat message comes in and the #togetherjs-chat window isn\'t open -->\n  <div id="togetherjs-chat-notifier" class="togetherjs-notification"\n       data-bind-to="#togetherjs-chat-button"\n       style="display: none">\n    <img src="http://localhost:8080/togetherjs/images/notification-togetherjs-logo.png" class="togetherjs-notification-logo" alt="">\n    <img src="http://localhost:8080/togetherjs/images/notification-btn-close.png" class="togetherjs-notification-closebtn togetherjs-dismiss" alt="[close]">\n    <section id="togetherjs-chat-notifier-message">\n    </section>\n  </div>\n\n  <!-- The menu when you click on the profile: -->\n  <div id="togetherjs-menu" class="togetherjs-menu" style="display: none">\n    <div class="togetherjs-menu-item togetherjs-menu-disabled" id="togetherjs-menu-profile">\n      <img id="togetherjs-menu-avatar">\n      <span class="togetherjs-person-name-self" id="togetherjs-self-name-display" data-toggles="#togetherjs-menu .togetherjs-self-name"></span>\n      <input class="togetherjs-self-name" type="text" data-toggles="#togetherjs-self-name-display" style="display: none" placeholder="Enter your name">\n    </div>\n    <div class="togetherjs-menu-hr-avatar"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-name"><img src="http://localhost:8080/togetherjs/images/button-pencil.png" alt=""> Update your name</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-avatar"><img src="http://localhost:8080/togetherjs/images/btn-menu-change-avatar.png" alt=""> Change avatar</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-color"><span class="togetherjs-person-bgcolor-self"></span> Pick profile color</div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-help">Help</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-feedback">Feedback</div>\n    <div id="togetherjs-invite" style="display: none">\n      <div class="togetherjs-hr"></div>\n      <div id="togetherjs-invite-users"></div>\n      <div class="togetherjs-menu-item" id="togetherjs-menu-refresh-invite">Refresh users</div>\n      <div class="togetherjs-menu-item" id="togetherjs-menu-invite-anyone">Invite anyone</div>\n    </div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-end"><img src="http://localhost:8080/togetherjs/images/button-end-session.png" alt=""> End <span class="togetherjs-tool-name">TogetherJS</span></div>\n  </div>\n\n  <!-- template for one person in the invite-users list -->\n  <div style="display: none">\n    <div id="togetherjs-template-invite-user-item" class="togetherjs-menu-item">\n      <!-- FIXME: should include avatar in some way -->\n      <span class="togetherjs-person-name"></span>\n    </div>\n  </div>\n\n  <!-- A window version of #togetherjs-menu, for use on mobile -->\n  <div id="togetherjs-menu-window" class="togetherjs-window" style="display: none">\n    <header>Settings and Profile</header>\n    <section>\n    <div class="togetherjs-menu-item">\n      <img class="togetherjs-menu-avatar">\n      <span class="togetherjs-person-name-self" id="togetherjs-self-name-display"></span>\n    </div>\n    <div class="togetherjs-menu-hr-avatar"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-name-button"><img src="http://localhost:8080/togetherjs/images/button-pencil.png" alt=""> Update your name</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-avatar-button"><img src="http://localhost:8080/togetherjs/images/btn-menu-change-avatar.png" alt=""> Change avatar</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-color-button"><span class="togetherjs-person-bgcolor-self"></span> Pick profile color</div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-help-button">Help</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-feedback-button">Feedback</div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-end-button"><img src="http://localhost:8080/togetherjs/images/button-end-session.png" alt=""> End <span class="togetherjs-tool-name">TogetherJS</span></div>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">OK</button>\n    </section>\n  </div>\n\n  <!-- The name editor, for use on mobile -->\n  <div id="togetherjs-edit-name-window" class="togetherjs-window" style="display: none">\n    <header>Update Name</header>\n    <section>\n      <div>\n        <input class="togetherjs-self-name" type="text" placeholder="Enter your name">\n      </div>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">OK</button>\n    </section>\n  </div>\n\n  <div class="togetherjs-menu" id="togetherjs-pick-color" style="display: none">\n    <div class="togetherjs-triangle-up"><img src="http://localhost:8080/togetherjs/images/icn-triangle-up.png"></div>\n    <div style="display: none">\n      <div id="togetherjs-template-swatch" class="togetherjs-swatch">\n      </div>\n    </div>\n  </div>\n\n  <!-- Invisible elements that handle the RTC audio: -->\n  <audio id="togetherjs-audio-element"></audio>\n  <audio id="togetherjs-local-audio" muted="true" volume="0.3"></audio>\n  <audio id="togetherjs-notification" src="http://localhost:8080/togetherjs/images/notification.ogg"></audio>\n\n  <!-- The intro screen for someone who joins a session the first time: -->\n  <div id="togetherjs-intro" class="togetherjs-modal" style="display: none">\n    <header>Join <span class="togetherjs-tool-name">TogetherJS</span> session?</header>\n    <section>\n      <p>Your friend has asked you to join their <a href="https://togetherjs.mozillalabs.com/" target="_blank"><span class="togetherjs-tool-name">TogetherJS</span></a> browser session to collaborate in real-time!</p>\n\n      <p>Would you like to join their session?</p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-destructive togetherjs-modal-dont-join">No, don\'t join</button>\n      <button class="togetherjs-primary togetherjs-dismiss">Yes, join session</button>\n    </section>\n  </div>\n\n  <!-- Shown when a web browser is completely incapable of running TogetherJS: -->\n  <div id="togetherjs-browser-broken" class="togetherjs-modal" style="display: none">\n    <header> Sorry </header>\n\n    <section>\n      <p>\n        We\'re sorry, <span class="togetherjs-tool-name">TogetherJS</span> doesn\'t work with this browser.  Please\n        <a href="https://github.com/mozilla/togetherjs/wiki/Supported-Browsers#supported-browsers">upgrade\n          to a supported browser</a> to try <span class="togetherjs-tool-name">TogetherJS</span>.\n      </p>\n\n      <p id="togetherjs-browser-broken-is-ie" style="display: none">\n        We need your help fixing TogetherJS on Internet Explorer!  Here are a list of IE <a href="https://github.com/mozilla/togetherjs/issues?labels=IE&milestone=&page=1&state=open" target="_blank">GitHub issues</a> we need fixed that you can work on.\n        Internet Explorer <a href="https://github.com/mozilla/togetherjs/wiki/Supported-Browsers#internet-explorer">is\n          currently not supported</a>.  If you do want to try out TogetherJS, we\'d suggest using Firefox or Chrome.\n      </p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">End <span class="togetherjs-tool-name">TogetherJS</span></button>\n    </section>\n\n  </div>\n\n  <!-- Shown when the browser has WebSockets, but is IE (i.e., IE10) -->\n  <div id="togetherjs-browser-unsupported" class="togetherjs-modal" style="display: none">\n    <header> Unsupported Browser </header>\n\n    <section>\n      <p>\n        We need your help fixing TogetherJS on Internet Explorer!  Here are a list of IE <a href="https://github.com/mozilla/togetherjs/issues?labels=IE&milestone=&page=1&state=open" target="_blank">GitHub issues</a> we need fixed that you can work on.\n        Internet Explorer <a href="https://github.com/mozilla/togetherjs/wiki/Supported-Browsers#internet-explorer">is not supported</a>\n        at this time.  While we may add support later, adding support is\n        not currently on our roadmap.  If you do want to try out TogetherJS, we\'d suggest using Firefox or Chrome.\n      </p>\n\n      <p>You can continue to try to use <span class="togetherjs-tool-name">TogetherJS</span>, but you are likely to hit\n        lots of bugs.  So be warned.</p>\n\n    </section>\n\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">End <span class="togetherjs-tool-name">TogetherJS</span></button>\n      <button class="togetherjs-dismiss togetherjs-secondary togetherjs-browser-unsupported-anyway">Try <span class="togetherjs-tool-name">TogetherJS</span> Anyway</button>\n    </section>\n\n  </div>\n\n  <div id="togetherjs-confirm-end" class="togetherjs-modal" style="display: none">\n    <header> End session? </header>\n    <section>\n      <p>\n        Are you sure you\'d like to end your <span class="togetherjs-tool-name">TogetherJS</span> session?\n      </p>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-cancel togetherjs-dismiss">Cancel</button>\n      <span class="togetherjs-alt-text">or</span>\n      <button id="togetherjs-end-session" class="togetherjs-destructive">End session</button>\n    </section>\n  </div>\n\n  <div id="togetherjs-feedback-form" class="togetherjs-modal" style="display: none;">\n    <header> Feedback </header>\n    <iframe src="https://docs.google.com/a/mozilla.com/forms/d/1lVE7JyRo_tjakN0mLG1Cd9X9vseBX9wci153z9JcNEs/viewform?embedded=true" width="400" height="300" frameborder="0" marginheight="0" marginwidth="0">Loading form...</iframe>\n    <!-- <p><button class="togetherjs-modal-close">Close</button></p> -->\n  </div>\n\n  <div style="display: none">\n    <!-- This is when you join a session and the other person has already changed to another URL: -->\n    <div id="togetherjs-template-url-change" class="togetherjs-modal">\n      <header> Following to new URL... </header>\n      <section>\n        <div class="togetherjs-person"></div>\n        Following\n        <span class="togetherjs-person-name"></span>\n        to <a href="" class="togetherjs-person-url togetherjs-person-url-title"></a>\n      </section>\n    </div>\n\n    <!-- This is when someone invites you to their session: -->\n    <div id="togetherjs-template-invite" class="togetherjs-chat-item">\n      <div class="togetherjs-person"></div>\n      <div>\n        <span class="togetherjs-person-name"></span>\n        has invited <strong class="togetherjs-if-forEveryone">anyone</strong>\n        <strong class="togetherjs-ifnot-forEveryone">you</strong>\n        to <a href="" data-togetherjs-subattr-href="href" class="togetherjs-sub-hrefTitle" target="_blank"></a>\n      </div>\n    </div>\n\n  </div>\n\n  <!-- The pointer at the side of a window: -->\n  <div id="togetherjs-window-pointer-right" style="display: none"></div>\n  <div id="togetherjs-window-pointer-left" style="display: none"></div>\n\n  <!-- The element that overlaps the background of the page during a modal dialog: -->\n  <div id="togetherjs-modal-background" style="display: none"></div>\n\n  <!-- Some miscellaneous templates -->\n  <div style="display: none">\n\n    <!-- This is the cursor: -->\n    <div id="togetherjs-template-cursor" class="togetherjs-cursor togetherjs">\n      <!-- Note: images/cursor.svg is a copy of this (for editing): -->\n      <!-- crossbrowser svg dropshadow http://demosthenes.info/blog/600/Creating-a-True-CrossBrowser-Drop-Shadow- -->\n      <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n      	 width="15px" height="22.838px" viewBox="96.344 146.692 15 22.838" enable-background="new 96.344 146.692 15 22.838"\n      	 xml:space="preserve">\n      <path fill="#231F20" d="M98.984,146.692c2.167,1.322,1.624,6.067,3.773,7.298c-0.072-0.488,2.512-0.931,3.097,0\n      	c0.503,0.337,1.104-0.846,2.653,0.443c0.555,0.593,3.258,2.179,1.001,8.851c-0.446,1.316,2.854,0.135,1.169,2.619\n      	c-3.748,5.521-9.455,2.787-9.062,1.746c1.06-2.809-6.889-4.885-4.97-9.896c0.834-2.559,2.898,0.653,2.923,0.29\n      	c-0.434-1.07-2.608-5.541-2.923-6.985C96.587,150.793,95.342,147.033,98.984,146.692z"/>\n      </svg>\n      <!-- <img class="togetherjs-cursor-img" src="http://localhost:8080/togetherjs/images/cursor.svg"> -->\n      <span class="togetherjs-cursor-container">\n        <span class="togetherjs-cursor-name"></span>\n        <span style="display:none" class="togetherjs-cursor-typing" id="togetherjs-cursor-typebox">\n          <span class="togetherjs-typing-ellipse-one">&#9679;</span><span class="togetherjs-typing-ellipse-two">&#9679;</span><span class="togetherjs-typing-ellipse-three">&#9679;</span>\n        </span>\n        <!-- Displayed when the cursor is below the screen: -->\n        <span class="togetherjs-cursor-down">\n\n        </span>\n        <!-- Displayed when the cursor is above the screen: -->\n        <span class="togetherjs-cursor-up">\n\n        </span>\n      </span>\n    </div>\n\n    <!-- This is the element that goes around focused form elements: -->\n    <div id="togetherjs-template-focus">\n      <div class="togetherjs-focus togetherjs-person-bordercolor"></div>\n    </div>\n\n    <!-- This is a click: -->\n    <div id="togetherjs-template-click" class="togetherjs-click togetherjs">\n    </div>\n  </div>\n</div>\n'),help:b('<% /*\n  This is used to show the help when you type /help.  Used in\n  TogetherJS.localChatMessage().\n\n*/ %>\n/help : this message\n/test : run an automated/randomized test (or stop one that is in progress)\n  /test start N : run N times (instead of default 100)\n  /test show : show what kind of actions the random test would take (or stop showing)\n  /test describe : describe the possible actions (instead of showing them)\n/clear : clear the chat area\n/record : open up a recorder for the session\n/playback URL : play back a session that was recorded (it\'s up to you to figure out how to host it)\n  /playback local:NAME : play a locally saved log\n/savelogs NAME : save the currently recorded logs under NAME (recorder must be open)\n/baseurl : set a local baseUrl to load TogetherJS from, for debugging a development version of TogetherJS.\n/config : override some TogetherJS configuration parameters\n  /config VAR VALUE : set TogetherJS.config("VAR", VALUE).  VALUE must be a legal Javascript/JSON literal.\n  /config clear : remove all overridden configuration\n'),walkthrough:b('<!--\n    Any elements with .togetherjs-walkthrough-firsttime will only be\n    displayed on during the first-time experience.  Any elements with\n    .togetherjs-walkthrough-not-firsttime will only be displayed when\n    the walkthrough is accessed through the Help menu.\n\n    Note you *cannot* use <section class="togetherjs-walkthrough-slide\n    togetherjs-walkthrough-firsttime">: the number of sections must be the\n    same regardless.\n  -->\n<div id="togetherjs-walkthrough" class="togetherjs-modal togetherjs-modal-wide">\n  <header>You\'re using <span class="togetherjs-tool-name">TogetherJS</span>!<button class="togetherjs-close"></button></header>\n\n  <div id="togetherjs-walkthrough-previous"></div>\n  <div id="togetherjs-walkthrough-next"></div>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-intro.png"></p>\n	<p><span class="togetherjs-tool-name">TogetherJS</span> is a service for your website that makes it easy to collaborate in real-time on: <strong class="togetherjs-site-name">[site name]</strong></p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <div class="togetherjs-walkthrough-firsttime">\n      <div class="togetherjs-walkthrough-main-image">\n        <div class="togetherjs-walkthrough-avatar-section">\n          <div class="togetherjs-avatar-preview togetherjs-person togetherjs-person-self"></div>\n          <div class="togetherjs-avatar-upload-input"><input type="file" class="togetherjs-upload-avatar"></div>\n        </div>\n        <input class="togetherjs-self-name" type="text" placeholder="Enter your name">\n        <div class="togetherjs-swatch togetherjs-person-bgcolor-self"></div>\n        <div class="togetherjs-save-settings">\n          <button class="togetherjs-avatar-save togetherjs-primary">\n            <span id="togetherjs-avatar-when-unsaved">Save</span>\n            <span id="togetherjs-avatar-when-saved" style="display: none">Saved!</span>\n          </button>\n        </div>\n      </div>\n      <p>Set up your avatar, name and user color above.  If you\'d like to update it later, you can click your Profile button.</p>\n    </div>\n    <div class="togetherjs-walkthrough-not-firsttime">\n      <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-profile.png"></p>\n      <p>Change your avatar, name and user color using the Profile button.</p>\n    </div>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image togetherjs-ifnot-creator"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-invite.png">\n    </p>\n    <p class="togetherjs-ifnot-creator">You can invite more friends to the session by sending the invite link in the <span class="togetherjs-tool-name">TogetherJS</span> dock.</p>\n    <p class="togetherjs-walkthrough-main-image togetherjs-if-creator">\n      <span class="togetherjs-walkthrough-sendlink">\n        Copy and paste this link into IM or email to invite friends.\n      </span>\n      <input type="text" class="togetherjs-share-link">\n    </p>\n    <p class="togetherjs-if-creator">Send the above link to a friend so they can join your session!  You can find this invite link on the <span class="togetherjs-tool-name">TogetherJS</span> dock as well.</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-participant.png"></p>\n    <p>Friends who join your <span class="togetherjs-tool-name">TogetherJS</span> session will appear here.  You can click their avatars to see more.</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-chat.png"></p>\n    <p>When your friends join you in your <span class="togetherjs-tool-name">TogetherJS</span> session, you can chat with them here!</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-rtc.png"></p>\n    <p>If your browser supports it, click the microphone icon to begin a audio chat. Learn more about this experimental feature <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">here</a>.</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-logo.png"></p>\n    <p>Alright, you\'re ready to use <span class="togetherjs-tool-name">TogetherJS</span>. Now start collaborating on <strong class="togetherjs-site-name">[site name]</strong>!</p>\n  </section>\n\n  <div style="display: none">\n    <!-- There is one of these created for each slide: -->\n    <span id="togetherjs-template-walkthrough-slide-progress" class="togetherjs-walkthrough-slide-progress">&#9679;</span>\n  </div>\n  <section id="togetherjs-walkthrough-progress">\n  </section>\n\n  <section class="togetherjs-buttons">\n    <button class="togetherjs-primary togetherjs-dismiss">I\'m ready!</button>\n  </section>\n\n</div><!-- /.togetherjs-modal -->\n')}
}),c("peers",["util","session","storage","require"],function(a,b,c,d){function e(){var b=[];return a.forEachAttr(q.peers,function(a){b.push(a.serialize())}),{peers:b}}function f(a){a&&a.peers.forEach(function(a){q.deserialize(a)})}function g(){var a=j.getAllPeers(),b=Date.now();a.forEach(function(a){"active"==a.idle&&b-a.lastMessageDate>m&&a.update({idle:"inactive"}),"bye"!=a.status&&b-a.lastMessageDate>o&&a.bye()})}function h(){c.tab.set("peerCache",e())}var i,j=a.Module("peers"),k=a.assert,l=1e4,m=18e4,n=12e4,o=6e5;d(["ui"],function(a){i=a});var p=["Student01","Student02","Student03","Student04","Student05","Student06","Student07","Student08","Student09","Student10","Student11","Student12","Student13","Student14","Student15","Student16","Student17","Student18","Student18","Student19","Student20","Student21","Student22","Student23","Student24","Student25"],q=a.Class({isSelf:!1,constructor:function(a,b){b=b||{},k(a),k(!q.peers[a]),this.id=a,this.identityId=b.identityId||null,this.status=b.status||"live",this.idle=b.status||"active",this.name=b.name||null,this.avatar=b.avatar||null,this.color=b.color||"#00FF00",this.view=i.PeerView(this),this.lastMessageDate=0,this.following=b.following||!1,q.peers[a]=this;var c=b.joined||!1;b.fromHelloMessage&&(this.updateFromHello(b.fromHelloMessage),"hello"==b.fromHelloMessage.type&&(c=!0)),j.emit("new-peer",this),c&&this.view.notifyJoined(),this.view.update()},repr:function(){return"Peer("+JSON.stringify(this.id)+")"},serialize:function(){return{id:this.id,status:this.status,idle:this.idle,url:this.url,hash:this.hash,title:this.title,identityId:this.identityId,rtcSupported:this.rtcSupported,name:this.name,avatar:this.avatar,color:this.color,following:this.following}},destroy:function(){this.view.destroy(),delete q.peers[this.id]},updateMessageDate:function(){"inactive"==this.idle&&this.update({idle:"active"}),"bye"==this.status&&this.unbye(),this.lastMessageDate=Date.now()},updateFromHello:function(c){var d=!1,e=!1;c.url&&c.url!=this.url&&(this.url=c.url,this.hash=null,this.title=null,d=!0),c.hash!=this.hash&&(this.hash=c.urlHash,d=!0),c.title!=this.title&&(this.title=c.title,d=!0),void 0!==c.rtcSupported&&(this.rtcSupported=c.rtcSupported),void 0!==c.identityId&&(this.identityId=c.identityId),c.name&&c.name!=this.name&&(this.name=c.name,e=!0),c.avatar&&c.avatar!=this.avatar&&(a.assertValidUrl(c.avatar),this.avatar=c.avatar,e=!0),c.color&&c.color!=this.color&&(this.color=c.color,e=!0),void 0!==c.isClient&&(this.isCreator=!c.isClient),"live"!=this.status&&(this.status="live",j.emit("status-updated",this)),"active"!=this.idle&&(this.idle="active",j.emit("idle-updated",this)),c.rtcSupported&&j.emit("rtc-supported",this),d&&j.emit("url-updated",this),e&&j.emit("identity-updated",this),this.following&&b.emit("follow-peer",this)},update:function(a){a.idle&&(this.idle=a.idle),a.status&&(this.status=a.status),this.view.update()},className:function(b){return b=b||"",b+a.safeClassName(this.id)},bye:function(){"bye"!=this.status&&(this.status="bye",j.emit("status-updated",this)),this.view.update()},unbye:function(){"bye"==this.status&&(this.status="live",j.emit("status-updated",this)),this.view.update()},nudge:function(){b.send({type:"url-change-nudge",url:location.href,to:this.id})},follow:function(){this.following||(j.getAllPeers().forEach(function(a){a.following&&a.unfollow()}),this.following=!0,h(),this.view.update(),b.emit("follow-peer",this))},unfollow:function(){this.following=!1,h(),this.view.update()}});b.on("follow-peer",function(a){if(a.url!=b.currentUrl()){var c=a.url;a.urlHash&&(c+=a.urlHash),location.href=c}}),q.peers={},q.deserialize=function(a){a.fromStorage=!0;q(a.id,a)},j.Self=void 0,b.on("start",function(){j.Self||(j.Self=a.mixinEvents({isSelf:!0,id:b.clientId,identityId:b.identityId,status:"live",idle:"active",name:null,avatar:null,color:null,defaultName:null,loaded:!1,isCreator:!b.isClient,update:function(d){var e=!1,f=!1,g={type:"peer-update"};"string"==typeof d.name&&d.name!=this.name&&(this.name=d.name,g.name=this.name,d.fromLoad||(c.settings.set("name",this.name),e=!0)),d.avatar&&d.avatar!=this.avatar&&(a.assertValidUrl(d.avatar),this.avatar=d.avatar,g.avatar=this.avatar,d.fromLoad||(c.settings.set("avatar",this.avatar),e=!0)),d.color&&d.color!=this.color&&(this.color=d.color,g.color=this.color,d.fromLoad||(c.settings.set("color",this.color),e=!0)),d.defaultName&&d.defaultName!=this.defaultName&&(this.defaultName=d.defaultName,d.fromLoad||(c.settings.set("defaultName",this.defaultName),e=!0)),d.status&&d.status!=this.status&&(this.status=d.status,j.emit("status-updated",this)),d.idle&&d.idle!=this.idle&&(this.idle=d.idle,f=!0,j.emit("idle-updated",this)),this.view.update(),e&&!d.fromLoad&&(b.emit("self-updated"),b.send(g)),f&&!d.fromLoad&&b.send({type:"idle-status",idle:this.idle})},className:function(a){return a=a||"",a+"self"},_loadFromSettings:function(){return a.resolveMany(c.settings.get("name"),c.settings.get("avatar"),c.settings.get("defaultName"),c.settings.get("color")).then(function(b,d,e,f){if(e||(e=a.pickRandom(p),c.settings.set("defaultName",e)),!f){for(f=Math.floor(16777215*Math.random()).toString(16);f.length<6;)f="0"+f;f="#"+f,c.settings.set("color",f)}d||(d=TogetherJS.baseUrl+"/togetherjs/images/default-avatar.png"),this.update({name:b,avatar:d,defaultName:e,color:f,fromLoad:!0}),j._SelfLoaded.resolve()}.bind(this))},_loadFromApp:function(){var a,b,c,d=TogetherJS.config.get("getUserName"),e=TogetherJS.config.get("getUserColor"),f=TogetherJS.config.get("getUserAvatar");d&&(a="string"==typeof d?d:d(),a&&"string"!=typeof a&&(console.warn("Error in getUserName(): should return a string (got",a,")"),a=null)),e&&(b="string"==typeof e?e:e(),b&&"string"!=typeof b&&(console.warn("Error in getUserColor(): should return a string (got",b,")"),b=null)),f&&(c="string"==typeof f?f:f(),c&&"string"!=typeof c&&(console.warn("Error in getUserAvatar(): should return a string (got",c,")"),c=null)),(a||b||c)&&this.update({name:a,color:b,avatar:c})}}),j.Self.view=i.PeerView(j.Self),c.tab.get("peerCache").then(f),j.Self._loadFromSettings().then(function(){j.Self._loadFromApp(),j.Self.view.update(),b.emit("self-updated")}))}),b.on("refresh-user-data",function(){j.Self&&j.Self._loadFromApp()}),TogetherJS.config.track("getUserName",TogetherJS.config.track("getUserColor",TogetherJS.config.track("getUserAvatar",function(){j.Self&&j.Self._loadFromApp()}))),j._SelfLoaded=a.Deferred(),j.getPeer=function(a,c){k(a);var d=q.peers[a];return a===b.clientId?j.Self:c&&!d?d=q(a,{fromHelloMessage:c}):(k(d,"No peer with id:",a),!c||"hello"!=c.type&&"hello-back"!=c.type&&"peer-update"!=c.type||(d.updateFromHello(c),d.view.update()),q.peers[a])},j.getAllPeers=function(b){var c=[];return a.forEachAttr(q.peers,function(a){b&&"live"!=a.status||c.push(a)}),c},b.hub.on("bye",function(a){var b=j.getPeer(a.clientId);b.bye()});var r=null;b.on("start",function(){r&&(console.warn("Old peers checkActivityTask left over?"),clearTimeout(r)),r=setInterval(g,l)}),b.on("close",function(){a.forEachAttr(q.peers,function(a){a.destroy()}),c.tab.set("peerCache",void 0),clearTimeout(r),r=null});var s=null;return b.on("visibility-change",function(a){a?(s&&clearTimeout(s),s=setTimeout(function(){j.Self.update({idle:"inactive"})},n)):(s&&clearTimeout(s),"inactive"==j.Self.idle&&j.Self.update({idle:"active"}))}),b.hub.on("idle-status",function(a){a.peer.update({idle:a.idle})}),b.hub.on("ping",function(){b.send({type:"ping-back"})}),window.addEventListener("pagehide",function(){h()},!1),a.mixinEvents(j),a.testExpose({setIdleTime:function(a){m=a,l=a/2,TogetherJS.running&&(clearTimeout(r),r=setInterval(g,l))}}),a.testExpose({setByeTime:function(a){o=a,l=Math.min(l,a/2),TogetherJS.running&&(clearTimeout(r),r=setInterval(g,l))}}),j}),c("windowing",["jquery","util","peers","session"],function(a,b,c,d){function e(b,c){if(!a.browser.mobile){b=a(b),h(c.length,"Cannot find binding:",c.selector,"from:",b.selector);var d="right",e=c.offset();e.height=c.height(),e.width=c.width();var f=j.height();e.top-=j.scrollTop(),e.left-=j.scrollLeft();var g,i,k=b.height()+5,l=b.width()+20;if("right"==d?(g=e.left-11-l,i=e.top+e.height/2-k/2):"left"==d?(g=e.left+e.width+15,i=e.top+e.height/2-k/2):"bottom"==d&&(g=e.left+e.width/2-l/2,i=e.top-10-k),i=Math.min(f-10-k,Math.max(10,i)),b.css({top:i+"px",left:g+"px"}),b.hasClass("togetherjs-window")){a("#togetherjs-window-pointer-right, #togetherjs-window-pointer-left").hide();var m=a("#togetherjs-window-pointer-"+d);m.show(),"right"==d?m.css({top:e.top+Math.floor(e.height/2)+"px",left:g+b.width()+9+"px"}):"left"==d?m.css({top:e.top+Math.floor(e.height/2)+"px",left:g-5+"px"}):console.warn("don't know how to deal with position:",d)}b.data("boundTo",c.selector||"#"+c.attr("id")),c.addClass("togetherjs-active")}}function f(b){b.find(".togetherjs-close, .togetherjs-dismiss").click(function(b){var c=a(b.target).closest(".togetherjs-window, .togetherjs-modal, .togetherjs-notification");return i.hide(c),b.stopPropagation(),!1})}function g(){if(g.element)return g.element;var b=a("#togetherjs-modal-background");return h(b.length),g.element=b,b.click(function(){i.hide()}),b}var h=b.assert,i=b.Module("windowing"),j=a(window),k=1e3;i.show=function(b,c){b=a(b),c=c||{},c.bind=c.bind||b.attr("data-bind-to");var f=b.hasClass("togetherjs-notification"),j=b.hasClass("togetherjs-modal");c.bind&&(c.bind=a(c.bind)),i.hide(),b.stop(),b.show(),b.css({opacity:"1"}),c.bind&&(h(!j,"Binding does not currently work with modals"),e(b,c.bind)),f?b.slideIn():j||b.popinWindow(),j&&(g().show(),m.bind()),l=c.onClose||null,d.emit("display-window",b.attr("id"),b)};var l=null;d.on("resize",function(){var b=a(".togetherjs-modal:visible, .togetherjs-window:visible");if(b.length){var c=b.data("boundTo");c&&(c=a(c),e(b,c))}}),i.hide=function(b){b=b||".togetherjs-window, .togetherjs-modal, .togetherjs-notification",b=a(b),b=b.filter(":visible"),b.filter(":not(.togetherjs-notification)").hide(),g().hide();var c=[];b.each(function(b,d){d=a(d),c.push(d);var e=d.data("boundTo");e&&(e=a(e),e.addClass("togetherjs-animated").addClass("togetherjs-color-pulse"),setTimeout(function(){e.removeClass("togetherjs-color-pulse").removeClass("togetherjs-animated")},k+10),d.data("boundTo",null),e.removeClass("togetherjs-active"),d.hasClass("togetherjs-notification")&&d.fadeOut().promise().then(function(){this.hide()}))}),a("#togetherjs-window-pointer-right, #togetherjs-window-pointer-left").hide(),l&&(l(),l=null),c.length&&d.emit("hide-window",c)},i.showNotification=function(b,c){b=a(b),c=c||{},h(!1)},i.toggle=function(b){b=a(b),b.is(":visible")?i.hide(b):i.show(b)};var m={bind:function(){a(document).keydown(m.onKeydown)},unbind:function(){a(document).unbind("keydown",m.onKeydown)},onKeydown:function(a){27==a.which&&i.hide()}};return d.on("close",function(){m.unbind()}),d.on("new-element",function(a){f(a)}),i}),c("templating",["jquery","util","peers","windowing","session"],function(a,b,c,d,e){var f=b.assert,g=b.Module("templating");return g.clone=function(b){b="#togetherjs-template-"+b;var c=a(b);return f(c.length,"No template found with id:",b),c=c.clone(),c.attr("id",null),c},g.sub=function(c,d){var h=g.clone(c);if(d=d||{},b.forEachAttr(d,function(b,c){var d=h.find(".togetherjs-sub-"+c).removeClass("togetherjs-sub-"+c);d.length&&("string"==typeof b?d.text(b):b instanceof a?d.append(b):f(!1,"Unknown variable value type:",c,"=",b));var e=h.find(".togetherjs-if-"+c).removeClass("togetherjs-sub-"+c);b||e.hide(),e=h.find(".togetherjs-ifnot-"+c).removeClass("togetherjs-ifnot-"+c),b&&e.hide();var g="data-togetherjs-subattr-"+c,i=h.find("["+g+"]");i.each(function(c,d){f("string"==typeof b),d=a(d);var e=d.attr(g);d.attr(g,null),d.attr(e,b)})}),d.peer&&d.peer.view.setElement(h),d.date){var i=d.date;"number"==typeof i&&(i=new Date(i));var j="AM",k=i.getHours();k>12&&(k-=12,j="PM");var l=i.getMinutes(),m=k+":";10>l&&(m+="0"),m+=l,h.find(".togetherjs-time").text(m),h.find(".togetherjs-ampm").text(j)}return e.emit("new-element",h),h},g}),c("linkify",[],function(){function a(a){function b(a){for(var c=a.childNodes.length,d=0;c>d;d++)a.childNodes[d].nodeType==document.ELEMENT_NODE&&b(a.childNodes[d]);var e=[];for(d=0;c>d;d++)a.childNodes[d].nodeType==document.TEXT_NODE&&e.push(a.childNodes[d]);e.forEach(function(c){if(c.nodeType==document.ELEMENT_NODE)b(c);else if(c.nodeType==document.TEXT_NODE)for(;;){var d=c.nodeValue,e=/\bhttps?:\/\/[a-z0-9\.\-_](:\d+)?[^ \n\t<>()\[\]]*/i,f=e.exec(d);if(!f)break;var g=document.createTextNode(d.substr(0,f.index));a.replaceChild(g,c);var h=document.createElement("a");h.setAttribute("target","_blank"),h.href=f[0],h.appendChild(document.createTextNode(f[0])),a.insertBefore(h,g.nextSibling);var i=document.createTextNode(d.substr(f.index+f[0].length));a.insertBefore(i,h.nextSibling),c=i}})}return a.jquery&&(a=a[0]),a.normalize(),b(a),a}return a}),function(a){function b(a,c){if(a=a?a:"","object"==typeof a&&a.hasOwnProperty("_tc_id"))return a;var e=d(a),g=e.r,i=e.g,k=e.b,m=e.a,n=x(100*m)/100,o=e.format;return 1>g&&(g=x(g)),1>i&&(i=x(i)),1>k&&(k=x(k)),{ok:e.ok,format:o,_tc_id:v++,alpha:m,toHsv:function(){var a=h(g,i,k);return{h:360*a.h,s:a.s,v:a.v,a:m}},toHsvString:function(){var a=h(g,i,k),b=x(360*a.h),c=x(100*a.s),d=x(100*a.v);return 1==m?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+n+")"},toHsl:function(){var a=f(g,i,k);return{h:360*a.h,s:a.s,l:a.l,a:m}},toHslString:function(){var a=f(g,i,k),b=x(360*a.h),c=x(100*a.s),d=x(100*a.l);return 1==m?"hsl("+b+", "+c+"%, "+d+"%)":"hsla("+b+", "+c+"%, "+d+"%, "+n+")"},toHex:function(){return j(g,i,k)},toHexString:function(){return"#"+j(g,i,k)},toRgb:function(){return{r:x(g),g:x(i),b:x(k),a:m}},toRgbString:function(){return 1==m?"rgb("+x(g)+", "+x(i)+", "+x(k)+")":"rgba("+x(g)+", "+x(i)+", "+x(k)+", "+n+")"},toPercentageRgb:function(){return{r:x(100*l(g,255))+"%",g:x(100*l(i,255))+"%",b:x(100*l(k,255))+"%",a:m}},toPercentageRgbString:function(){return 1==m?"rgb("+x(100*l(g,255))+"%, "+x(100*l(i,255))+"%, "+x(100*l(k,255))+"%)":"rgba("+x(100*l(g,255))+"%, "+x(100*l(i,255))+"%, "+x(100*l(k,255))+"%, "+n+")"},toName:function(){return C[j(g,i,k)]||!1},toFilter:function(){var a=j(g,i,k),d=a,e=Math.round(255*parseFloat(m)).toString(16),f=e,h=c&&c.gradientType?"GradientType = 1, ":"";if(secondColor){var l=b(secondColor);d=l.toHex(),f=Math.round(255*parseFloat(l.alpha)).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+h+"startColorstr=#"+q(e)+a+",endColorstr=#"+q(f)+d+")"},toString:function(a){a=a||this.format;var b=!1;return"rgb"===a&&(b=this.toRgbString()),"prgb"===a&&(b=this.toPercentageRgbString()),"hex"===a&&(b=this.toHexString()),"name"===a&&(b=this.toName()),"hsl"===a&&(b=this.toHslString()),"hsv"===a&&(b=this.toHsvString()),b||this.toHexString()}}}function d(a){var b={r:255,g:255,b:255},c=1,d=!1,f=!1;return"string"==typeof a&&(a=s(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(b=e(a.r,a.g,a.b),d=!0,f="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=r(a.s),a.v=r(a.v),b=i(a.h,a.s,a.v),d=!0,f="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=r(a.s),a.l=r(a.l),b=g(a.h,a.s,a.l),d=!0,f="hsl"),a.hasOwnProperty("a")&&(c=a.a)),c=parseFloat(c),(isNaN(c)||0>c||c>1)&&(c=1),{ok:d,format:a.format||f,r:y(255,z(b.r,0)),g:y(255,z(b.g,0)),b:y(255,z(b.b,0)),a:c}}function e(a,b,c){return{r:255*l(a,255),g:255*l(b,255),b:255*l(c,255)}}function f(a,b,c){a=l(a,255),b=l(b,255),c=l(c,255);var d,e,f=z(a,b,c),g=y(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function g(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=l(a,360),b=l(b,100),c=l(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function h(a,b,c){a=l(a,255),b=l(b,255),c=l(c,255);var d,e,f=z(a,b,c),g=y(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function i(a,b,c){a=6*l(a,360),b=l(b,100),c=l(c,100);var d=w.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],k=[h,c,c,g,f,f][i],m=[f,f,h,c,c,g][i];return{r:255*j,g:255*k,b:255*m}}function j(a,b,c){var d=[q(x(a).toString(16)),q(x(b).toString(16)),q(x(c).toString(16))];return d[0].charAt(0)==d[0].charAt(1)&&d[1].charAt(0)==d[1].charAt(1)&&d[2].charAt(0)==d[2].charAt(1)?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function k(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function l(a,b){o(a)&&(a="100%");var c=p(a);return a=y(b,z(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),w.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function m(a){return y(1,z(0,a))}function n(a){return parseInt(a,16)}function o(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function p(a){return"string"==typeof a&&-1!=a.indexOf("%")}function q(a){return 1==a.length?"0"+a:""+a}function r(a){return 1>=a&&(a=100*a+"%"),a}function s(a){a=a.replace(t,"").replace(u,"").toLowerCase();var b=!1;if(B[a])a=B[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0};var c;return(c=D.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=D.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=D.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=D.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=D.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=D.hex6.exec(a))?{r:n(c[1]),g:n(c[2]),b:n(c[3]),format:b?"name":"hex"}:(c=D.hex3.exec(a))?{r:n(c[1]+""+c[1]),g:n(c[2]+""+c[2]),b:n(c[3]+""+c[3]),format:b?"name":"hex"}:!1}var t=/^[\s,#]+/,u=/\s+$/,v=0,w=Math,x=w.round,y=w.min,z=w.max,A=w.random;b.fromRatio=function(a){if("object"==typeof a){var c={};for(var d in a)c[d]=r(a[d]);a=c}return b(a)},b.equals=function(a,c){return a&&c?b(a).toRgbString()==b(c).toRgbString():!1},b.random=function(){return b.fromRatio({r:A(),g:A(),b:A()})},b.desaturate=function(a,c){var d=b(a).toHsl();return d.s-=(c||10)/100,d.s=m(d.s),b(d)},b.saturate=function(a,c){var d=b(a).toHsl();return d.s+=(c||10)/100,d.s=m(d.s),b(d)},b.greyscale=function(a){return b.desaturate(a,100)},b.lighten=function(a,c){var d=b(a).toHsl();return d.l+=(c||10)/100,d.l=m(d.l),b(d)},b.darken=function(a,c){var d=b(a).toHsl();return d.l-=(c||10)/100,d.l=m(d.l),b(d)},b.complement=function(a){var c=b(a).toHsl();return c.h=(c.h+180)%360,b(c)},b.triad=function(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+120)%360,s:c.s,l:c.l}),b({h:(d+240)%360,s:c.s,l:c.l})]},b.tetrad=function(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+90)%360,s:c.s,l:c.l}),b({h:(d+180)%360,s:c.s,l:c.l}),b({h:(d+270)%360,s:c.s,l:c.l})]},b.splitcomplement=function(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+72)%360,s:c.s,l:c.l}),b({h:(d+216)%360,s:c.s,l:c.l})]},b.analogous=function(a,c,d){c=c||6,d=d||30;var e=b(a).toHsl(),f=360/d,g=[b(a)];for(e.h=(e.h-(f*c>>1)+720)%360;--c;)e.h=(e.h+f)%360,g.push(b(e));return g},b.monochromatic=function(a,c){c=c||6;for(var d=b(a).toHsv(),e=d.h,f=d.s,g=d.v,h=[],i=1/c;c--;)h.push(b({h:e,s:f,v:g})),g=(g+i)%1;return h},b.readability=function(a,c){var d=b(a).toRgb(),e=b(c).toRgb(),f=(299*d.r+587*d.g+114*d.b)/1e3,g=(299*e.r+587*e.g+114*e.b)/1e3,h=Math.max(d.r,e.r)-Math.min(d.r,e.r)+Math.max(d.g,e.g)-Math.min(d.g,e.g)+Math.max(d.b,e.b)-Math.min(d.b,e.b);return{brightness:Math.abs(f-g),color:h}},b.readable=function(a,c){var d=b.readability(a,c);return d.brightness>125&&d.color>500},b.mostReadable=function(a,c){for(var d,e=0,f=!1,g=0;g<c.length;g++){var h=b.readability(a,c[g]),i=h.brightness>125&&h.color>500,j=3*(h.brightness/125)+h.color/500;(i&&!f||i&&f&&j>e||!i&&!f&&j>e)&&(f=i,e=j,d=c[g])}return d};var B=b.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C=b.hexNames=k(B),D=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=b:"undefined"!=typeof c?c("tinycolor",[],function(){return b}):a.tinycolor=b}(this),c("elementFinder",["util","jquery"],function(a,b){var c=a.Module("elementFinder"),d=a.assert;return c.ignoreElement=function(a){for(a instanceof b&&(a=a[0]);a;){if(b(a).hasClass("togetherjs"))return!0;a=a.parentNode}return!1},c.elementLocation=function e(a){if(d(null!==a,"Got null element"),a instanceof b&&(a=a[0]),a[0]&&a.attr&&1==a[0].nodeType&&(a=a[0]),a.id)return"#"+a.id;if("BODY"==a.tagName)return"body";if("HEAD"==a.tagName)return"head";if(a===document)return"document";var c=a.parentNode;if(!c||c==a)throw console.warn("elementLocation(",a,") has null parent"),new Error("No locatable parent found");for(var f=e(c),g=c.childNodes,h=g.length,i=0,j=0;h>j&&g[j]!=a;j++)if(g[j].nodeType==document.ELEMENT_NODE){if(-1!=g[j].className.indexOf("togetherjs"))continue;i++}return f+":nth-child("+(i+1)+")"},c.CannotFind=a.Class({constructor:function(a,b,c){this.prefix="",this.location=a,this.reason=b,this.context=c},toString:function(){var a;try{a=c.elementLocation(this.context)}catch(b){a=this.context}return"[CannotFind "+this.prefix+"("+this.location+"): "+this.reason+" in "+a+"]"}}),c.findElement=function f(a,b){b=b||document;var d,e;if("body"===a)return document.body;if("head"===a)return document.head;if("document"===a)return document;if(0===a.indexOf("body")){d=document.body;try{return f(a.substr("body".length),d)}catch(g){throw g instanceof c.CannotFind&&(g.prefix="body"+g.prefix),g}}else if(0===a.indexOf("head")){d=document.head;try{return f(a.substr("head".length),d)}catch(g){throw g instanceof c.CannotFind&&(g.prefix="head"+g.prefix),g}}else if(0===a.indexOf("#")){var h;if(a=a.substr(1),-1===a.indexOf(":")?(h=a,e=""):(h=a.substr(0,a.indexOf(":")),e=a.substr(a.indexOf(":"))),d=document.getElementById(h),!d)throw c.CannotFind("#"+h,"No element by that id",b);if(!e)return d;try{return f(e,d)}catch(g){throw g instanceof c.CannotFind&&(g.prefix="#"+h+g.prefix),g}}else{if(0!==a.indexOf(":nth-child("))throw c.CannotFind(a,"Malformed location",b);if(a=a.substr(":nth-child(".length),-1==a.indexOf(")"))throw"Invalid location, missing ): "+a;var i=a.substr(0,a.indexOf(")"));i=parseInt(i,10);var j=i;a=a.substr(a.indexOf(")")+1);var k=b.childNodes;d=null;for(var l=0;l<k.length;l++){var m=k[l];if(m.nodeType==document.ELEMENT_NODE){if(-1!=m.className.indexOf("togetherjs"))continue;if(j--,0===j){d=m;break}}}if(!d)throw c.CannotFind(":nth-child("+i+")","container only has "+(i-j)+" elements",b);if(!a)return d;try{return c.findElement(a,d)}catch(g){throw g instanceof c.CannotFind&&(g.prefix=":nth-child("+i+")"+g.prefix),g}}},c.elementByPixel=function(a){function d(a,e){var f=null,g=a.children();return g.each(function(){var a=b(this);if(!a.hasClass("togetherjs")&&"fixed"!=a.css("position")&&a.is(":visible"))return a.offset().top>e?!1:void(f=a)}),g.length&&f?d(f,e):{location:c.elementLocation(a[0]),offset:e-a.offset().top,absoluteTop:e,documentHeight:b(document).height()}}return d(b(document.body),a)},c.pixelForPosition=function(a){if("body"==a.location)return a.offset;var d;try{d=c.findElement(a.location)}catch(e){if(e instanceof c.CannotFind&&a.absoluteTop){var f=a.absoluteTop/a.documentHeight;return b(document).height()*f}throw e}var g=b(d).offset().top;return g+a.offset},c}),c("visibilityApi",["util","session"],function(a,b){function c(){b.emit("visibility-change",document[d])}var d,e,f=a.Module("visibilityApi");return void 0!==document.hidden?(d="hidden",e="visibilitychange"):void 0!==document.mozHidden?(d="mozHidden",e="mozvisibilitychange"):void 0!==document.msHidden?(d="msHidden",e="msvisibilitychange"):void 0!==document.webkitHidden&&(d="webkitHidden",e="webkitvisibilitychange"),b.on("start",function(){document.addEventListener(e,c,!1)}),b.on("close",function(){document.removeEventListener(e,c,!1)}),f.hidden=function(){return document[d]},f}),c("ui",["require","jquery","util","session","templates","templating","linkify","peers","windowing","tinycolor","elementFinder","visibilityApi"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var a=b("#togetherjs-dock");if(a.hasClass("togetherjs-dock-right"))return"right";if(a.hasClass("togetherjs-dock-left"))return"left";if(a.hasClass("togetherjs-dock-bottom"))return"bottom";throw new F("#togetherjs-dock doesn't have positioning class")}function n(a){return function(){D.container&&a.apply(this,arguments);var b=this,c=Array.prototype.slice.call(arguments);d.once("ui-ready",function(){a.apply(b,c)})}}function o(a){return c.Deferred(function(c){var e=b("<canvas>");e[0].height=d.AVATAR_SIZE,e[0].width=d.AVATAR_SIZE;var f=e[0].getContext("2d"),g=new Image;g.src=a,setTimeout(function(){var a=g.naturalWidth||g.width,b=g.naturalHeight||g.height;a*=d.AVATAR_SIZE/b,b=d.AVATAR_SIZE,f.drawImage(g,0,0,a,b),c.resolve(e[0].toDataURL("image/png"))})})}function p(a){a.find(".togetherjs-person").each(function(){var a=b(this),c=a.find(".togetherjs-person-avatar-swatch");c.length||a.append('<div class="togetherjs-person-avatar-swatch"></div>')})}function q(){var a=b("#togetherjs-menu");E(a.length),a.show(),r(),b(document).bind("click",v)}function r(){var a=b("#togetherjs-menu:visible");if(a.length){var c=b("#togetherjs-profile-button"),d=c.offset();a.css({top:d.top+c.height()-G.scrollTop()+"px",left:d.left+c.width()-10-a.width()-G.scrollLeft()+"px"})}}function s(){var a=b("#togetherjs-pick-color:visible");if(a.length){var c=b("#togetherjs-menu-update-color"),d=c.offset();a.css({top:d.top+c.height(),left:d.left})}}function t(){b("#togetherjs-menu").is(":visible")?u():q()}function u(){var a=b("#togetherjs-menu");a.hide(),b(document).unbind("click",v),D.displayToggle("#togetherjs-self-name-display"),b("#togetherjs-pick-color").hide()}function v(a){for(var b=a.target;b;){if("togetherjs-menu"==b.id)return;b=b.parentNode}u()}function w(a){E("number"==typeof a),E(a&&Math.floor(a)==a);var c=b("#togetherjs-dock"),d=c.height()+H*a;E(d>=3*H,"Height went too low (",d,"), should never be less than 3 buttons high (",3*H,")"),c.css({height:d+"px"})}function x(){var a=b("input.togetherjs-share-link"),c=b("a.togetherjs-share-link"),e=b("#togetherjs-session-id");d.shareId?(a.val(d.shareUrl()),c.attr("href",d.shareUrl()),e.text(d.shareId)):(a.val(""),c.attr("href","#"),e.text("(none)"))}function y(){var a=h.getAllPeers(!0);a.length?(D.displayToggle("#togetherjs-chat-participants"),b("#togetherjs-chat-participant-list").text(a.map(function(a){return a.name}).join(", "))):D.displayToggle("#togetherjs-chat-no-participants")}function z(){var a=TogetherJS.config.get("inviteFromRoom");return E(a),c.makeUrlAbsolute(a,d.hubUrl())}function A(){P||(P=!0,a(["who"],function(a){function c(a,c){var d=f.sub("invite-user-item",{peer:a});d.attr("data-clientid",a.id),c?d.insertBefore(c):b("#togetherjs-invite-users").append(d),d.click(function(){B(a.clientId)})}function d(a,d){var e=[];for(var f in a)a.hasOwnProperty(f)&&e.push(a[f]);e.sort(function(a,b){return a.name<b.name?-1:1});var g=0;D.container.find("#togetherjs-invite-users .togetherjs-menu-item").each(function(){var f=b(this);if(d&&!a[f.attr("data-clientid")])return void f.remove();if(!(g>=e.length)){for(;g<e.length&&f.attr("data-clientid")!==e[g].id;)c(e[g],f),g++;for(;g<e.length&&f.attr("data-clientid")==e[g].id;)g++}});for(var h=g;h<e.length;h++)c(e[g])}var e=a.getList(z());e.then(function(a){d(a,!0),P=!1}),e.progress(d)}))}function B(b){a(["who"],function(a){a.invite(z(),b).then(function(){u()})})}var C,D=c.Module("ui"),E=c.assert,F=c.AssertionError,G=b(window),H=61,I=20,J=5,K=null,L=300,M=5e3,N=["#8A2BE2","#7FFF00","#DC143C","#00FFFF","#8FBC8F","#FF8C00","#FF00FF","#FFD700","#F08080","#90EE90","#FF6347"];a(["chat"],function(a){C=a}),D.displayToggle=function(a){a=b(a),E(a.length,"No element",arguments[0]);var c=b(a.attr("data-toggles"));E(c.length,"Cannot toggle",a[0],"selector",c.selector),c.hide(),a.show()},D.container=null;var O=null;D.prepareUI=function(){if("complete"!=document.readyState&&"interactive"!=document.readyState)return O="deferring",void document.addEventListener("DOMContentLoaded",function(){var a=O;O=null,D.prepareUI(),"activate"==a&&D.activateUI()});var a=D.container=b(e["interface"]);if(E(a.length),b("body").append(a),p(a),d.firstRun&&TogetherJS.startTarget){var c=L/1e3;K=Date.now()+L+50,setTimeout(function(){K=Date.now()+L+40;var d=a.find("#togetherjs-dock"),e=d.offset(),f=b(TogetherJS.startTarget).offset();f.top=Math.floor(f.top-e.top),f.left=Math.floor(f.left-e.left);var g="translate("+f.left+"px, "+f.top+"px)";d.css({MozTransform:g,WebkitTransform:g,transform:g,opacity:"0.0"}),setTimeout(function(){K=Date.now()+L+20;var a="transform "+c+"s ease-out, ";a+="opacity "+c+"s ease-out",d.css({opacity:"1.0",MozTransition:"-moz-"+a,MozTransform:"translate(0, 0)",WebkitTransition:"-webkit-"+a,WebkitTransform:"translate(0, 0)",transition:a,transform:"translate(0, 0)"}),setTimeout(function(){K=null,d.attr("style","")
},510)},5)},5)}if(TogetherJS.startTarget){var f=b(TogetherJS.startTarget),g=f.text().toLowerCase().replace(/\s+/g," ");g=g.replace(/^\s*/,"").replace(/\s*$/,""),"start togetherjs"==g&&f.attr("data-end-togetherjs-html","End TogetherJS"),f.attr("data-end-togetherjs-html")&&(f.attr("data-start-togetherjs-html",f.html()),f.html(f.attr("data-end-togetherjs-html"))),f.addClass("togetherjs-started")}D.container.find(".togetherjs-window > header, .togetherjs-modal > header").each(function(){b(this).append(b('<button class="togetherjs-close"></button>'))}),TogetherJS.config.track("disableWebRTC",function(a,b){a&&!b?(D.container.find("#togetherjs-audio-button").hide(),w(-1)):!a&&b&&(D.container.find("#togetherjs-audio-button").show(),w(1))})},D.activateUI=function(){function e(){var a=n.val();b.trim(a)&&(n.val(""),n.trigger("input").trigger("propertychange"),C.submit(a))}function g(){b(".togetherjs-window").animate({opacity:1}),b("#togetherjs-dock-participants").animate({opacity:1}),b("#togetherjs-dock #togetherjs-buttons").animate({opacity:1}),b(window).width()<480?b(".togetherjs-dock-right").animate({width:"204px"},{duration:60,easing:"linear"}):b(".togetherjs-dock-right").animate({width:"27%"},{duration:60,easing:"linear"});var a="/togetherjs/images/togetherjs-logo-close.png";b("#togetherjs-dock-anchor #togetherjs-dock-anchor-horizontal img").attr("src",a)}function k(){b("body").css({position:"",top:"",left:""});var a="/togetherjs/images/togetherjs-logo-open.png";b("#togetherjs-dock-anchor #togetherjs-dock-anchor-horizontal img").attr("src",a),b(".togetherjs-window").animate({opacity:0}),b("#togetherjs-dock-participants").animate({opacity:0}),b("#togetherjs-dock #togetherjs-buttons").animate({opacity:0}),b(".togetherjs-dock-right").animate({width:"40px"},{duration:60,easing:"linear"})}if(O)return console.warn("ui.activateUI called before document is ready; waiting..."),void(O="activate");D.container||D.prepareUI();var l=D.container;b.browser.mobile,D.prepareShareLink(l),l.find("input.togetherjs-share-link").on("keydown",function(a){return 27==a.which?(i.hide("#togetherjs-share"),!1):void 0}),d.on("shareId",x);var n=l.find("#togetherjs-chat-input");n.bind("keydown",function(a){return 13!=a.which||a.shiftKey?27==a.which?(i.hide("#togetherjs-chat"),!1):void 0:(e(),!1)}),n.on("input propertychange",function(){var a=b(this),c=a.height();a.height(I),this.scrollTop=0,this.scrollTop=9999;var d=this.scrollTop+a.height(),e=J*I;d>e?(d=e,this.style.overflowY="scroll"):this.style.overflowY="hidden",this.style.height=d+"px";var f=d-c;return b("#togetherjs-chat-input-box").height(b("#togetherjs-chat-input-box").height()+f),b("#togetherjs-chat-messages").height(b("#togetherjs-chat-messages").height()-f),!1}),c.testExpose({submitChat:e});var o=l.find("#togetherjs-dock-anchor");if(E(o.length),o=l.find("#togetherjs-dock-anchor-disabled"),o.mousedown(function(){function a(){return!1}function c(a){var b=G.width()+window.pageXOffset-a.pageX,c=a.pageX-window.pageXOffset,f=G.height()+window.pageYOffset-a.pageY;f=1e4;var g;g=b>c&&f>c?"left":c>b&&f>b?"right":"bottom",d.removeClass("togetherjs-dock-left"),d.removeClass("togetherjs-dock-right"),d.removeClass("togetherjs-dock-bottom"),d.addClass("togetherjs-dock-"+g),e&&g!=e&&(i.hide(),e=null)}var d=b("#togetherjs-dock"),e=m();return b(document).bind("mousemove",c),b(document).bind("selectstart",a),b(document).one("mouseup",function(){b(document).unbind("mousemove",c),b(document).unbind("selectstart",a)}),!1}),b.browser.mobile){b("#togetherjs-audio-button").click(function(){i.toggle("#togetherjs-rtc-not-supported")}),b("#togetherjs-profile-button").click(function(){i.toggle("#togetherjs-menu-window")});var p="/togetherjs/images/togetherjs-logo-close.png";b("#togetherjs-dock-anchor #togetherjs-dock-anchor-horizontal img").attr("src",p),b("#togetherjs-dock-anchor").toggle(function(){k()},function(){g()})}b("#togetherjs-share-button").click(function(){i.toggle("#togetherjs-share")}),b("#togetherjs-profile-button").click(function(a){return b.browser.mobile?(i.show("#togetherjs-menu-window"),!1):(t(),a.stopPropagation(),!1)}),b("#togetherjs-menu-feedback, #togetherjs-menu-feedback-button").click(function(){i.hide(),u(),i.show("#togetherjs-feedback-form")}),b("#togetherjs-menu-help, #togetherjs-menu-help-button").click(function(){i.hide(),u(),a(["walkthrough"],function(a){i.hide(),a.start(!1)})}),b("#togetherjs-menu-update-name").click(function(){var a=b("#togetherjs-menu .togetherjs-self-name");a.css({width:b("#togetherjs-menu").width()-32+"px"}),D.displayToggle("#togetherjs-menu .togetherjs-self-name"),b("#togetherjs-menu .togetherjs-self-name").focus()}),b("#togetherjs-menu-update-name-button").click(function(){i.show("#togetherjs-edit-name-window"),b("#togetherjs-edit-name-window input").focus()}),b("#togetherjs-menu .togetherjs-self-name").bind("keyup change",function(a){if(console.log("alrighty",a),13==a.which)return void D.displayToggle("#togetherjs-self-name-display");var c=b("#togetherjs-menu .togetherjs-self-name").val();console.log("values!!",c),c&&h.Self.update({name:c})}),b("#togetherjs-menu-update-avatar, #togetherjs-menu-update-avatar-button").click(function(){u(),i.show("#togetherjs-avatar-edit")}),b("#togetherjs-menu-end, #togetherjs-menu-end-button").click(function(){u(),i.show("#togetherjs-confirm-end")}),b("#togetherjs-end-session").click(function(){d.close()}),b("#togetherjs-menu-update-color").click(function(){var a=b("#togetherjs-pick-color");return a.is(":visible")?void a.hide():(a.show(),s(),a.find(".togetherjs-swatch-active").removeClass("togetherjs-swatch-active"),void a.find('.togetherjs-swatch[data-color="'+h.Self.color+'"]').addClass("togetherjs-swatch-active"))}),b("#togetherjs-pick-color").click(".togetherjs-swatch",function(a){var c=b(a.target),d=c.attr("data-color");return h.Self.update({color:d}),a.stopPropagation(),!1}),b("#togetherjs-pick-color").click(function(a){return b("#togetherjs-pick-color").hide(),a.stopPropagation(),!1}),N.forEach(function(a){var c=f.sub("swatch");c.attr("data-color",a);var d=j.darken(a);c.css({backgroundColor:a,borderColor:d}),b("#togetherjs-pick-color").append(c)}),b("#togetherjs-chat-button").click(function(){i.toggle("#togetherjs-chat")}),d.on("display-window",function(a,c){if("togetherjs-chat"==a)b.browser.mobile||b("#togetherjs-chat-input").focus();else if("togetherjs-share"==a){var d=c.find("input.togetherjs-share-link");d.is(":visible")&&d.focus().select()}}),l.find("#togetherjs-chat-notifier").click(function(a){b(a.target).is("a")||l.is(".togetherjs-close")||i.show("#togetherjs-chat")}),b(".togetherjs header.togetherjs-title").each(function(a,c){var d=b('<button class="togetherjs-minimize"></button>');d.click(function(){var a=d.closest(".togetherjs-window");i.hide(a)}),b(c).append(d)}),b("#togetherjs-avatar-done").click(function(){D.displayToggle("#togetherjs-no-avatar-edit")}),b("#togetherjs-self-color").css({backgroundColor:h.Self.color});var q=h.Self.avatar;q&&b("#togetherjs-self-avatar").attr("src",q);var r=b("#togetherjs-starter button");r.click(function(){i.show("#togetherjs-about")}).addClass("togetherjs-running"),"Start TogetherJS"==r.text()&&(r.attr("data-start-text",r.text()),r.text("End TogetherJS Session")),D.activateAvatarEdit(l,{onSave:function(){i.hide("#togetherjs-avatar-edit")}}),TogetherJS.config.track("inviteFromRoom",function(a){a?l.find("#togetherjs-invite").show():l.find("#togetherjs-invite").hide()}),l.find("#togetherjs-menu-refresh-invite").click(A),l.find("#togetherjs-menu-invite-anyone").click(function(){B(null)}),d.emit("new-element",D.container),K&&K>Date.now()?setTimeout(function(){K=null,d.emit("ui-ready",D)},K-Date.now()):d.emit("ui-ready",D)},D.activateAvatarEdit=function(a,b){b=b||{};var d=null;a.find(".togetherjs-avatar-save").prop("disabled",!0),a.find(".togetherjs-avatar-save").click(function(){d&&(h.Self.update({avatar:d}),a.find(".togetherjs-avatar-save").prop("disabled",!0),b.onSave&&b.onSave())}),a.find(".togetherjs-upload-avatar").on("change",function(){c.readFileImage(this).then(function(c){o(c).then(function(c){d=c,a.find(".togetherjs-avatar-preview").css({backgroundImage:"url("+d+")"}),a.find(".togetherjs-avatar-save").prop("disabled",!1),b.onPending&&b.onPending()})})})},D.prepareShareLink=function(a){a.find("input.togetherjs-share-link").click(function(){b(this).select()}).change(function(){x()}),a.find("a.togetherjs-share-link").click(function(){return!1}),x()},d.on("resize",function(){r(),s()}),d.on("close",function(){b.browser.mobile&&b("body").css({position:"",top:"",left:""}),D.container&&(D.container.remove(),D.container=null),b(".togetherjs").remove();var a=b("#togetherjs-starter button");if(a.removeClass("togetherjs-running"),a.attr("data-start-text")&&(a.text(a.attr("data-start-text")),a.attr("data-start-text","")),TogetherJS.startTarget){var c=b(TogetherJS.startTarget);c.attr("data-start-togetherjs-html")&&c.html(c.attr("data-start-togetherjs-html")),c.removeClass("togetherjs-started")}}),D.chat={text:function(a){E("string"==typeof a.text),E(a.peer),E(a.messageId);var c=a.date||Date.now(),d=D.container.find("#togetherjs-chat .togetherjs-chat-message");d.length&&(d=b(d[d.length-1]));var e=null;if(d&&(e=parseInt(d.attr("data-date"),10)),d&&d.attr("data-person")==a.peer.id&&e&&e+M>c){d.attr("data-date",c);var h=d.find(".togetherjs-chat-content");E(h.length),a.text=h.text()+"\n"+a.text,a.messageId=d.attr("data-message-id"),d.remove()}var i=f.sub("chat-message",{peer:a.peer,content:a.text,date:c});g(i.find(".togetherjs-chat-content")),i.attr("data-person",a.peer.id).attr("data-date",c).attr("data-message-id",a.messageId),D.chat.add(i,a.messageId,a.notify)},joinedSession:function(a){E(a.peer);var b=a.date||Date.now(),c=f.sub("chat-joined",{peer:a.peer,date:b});D.chat.add(c,a.peer.className("join-message-"),4e3)},leftSession:function(a){E(a.peer);var b=a.date||Date.now(),c=f.sub("chat-left",{peer:a.peer,date:b,declinedJoin:a.declinedJoin});D.chat.add(c,a.peer.className("join-message-"),4e3)},system:function(a){E(!a.peer),E("string"==typeof a.text);var b=a.date||Date.now(),c=f.sub("chat-system",{content:a.text,date:b});D.chat.add(c,void 0,!0)},clear:n(function(){var a=D.container.find("#togetherjs-chat-messages");a.empty()}),urlChange:function(a){E(a.peer),E("string"==typeof a.url),E("boolean"==typeof a.sameUrl);var c,d=a.peer.className("url-change-"),e="togetherjs-chat-"+d,g=a.date||Date.now();c=a.title?a.title+" ("+a.url+")":a.url;var h=f.sub("url-change",{peer:a.peer,date:g,href:a.url,title:c,sameUrl:a.sameUrl});h.find(".togetherjs-nudge").click(function(){return a.peer.nudge(),!1}),h.find(".togetherjs-follow").click(function(){var b=a.peers.url;a.peer.urlHash&&(b+=a.peer.urlHash),location.href=b});var i=!a.sameUrl;(!a.sameUrl||b("#"+e).length)&&D.chat.add(h,d,i)},invite:function(a){E(a.peer),E("string"==typeof a.url);var b=a.peer.className("invite-"),c=a.date||Date.now(),d=a.url.replace(/\#?&togetherjs=.*/,"").replace(/^\w+:\/\//,""),e=f.sub("invite",{peer:a.peer,date:c,href:a.url,hrefTitle:d,forEveryone:a.forEveryone});a.forEveryone&&e.find("a").click(function(){C.submit("Followed link to "+a.url)}),D.chat.add(e,b,!0)},hideTimeout:null,add:n(function(a,b,d){b&&a.attr("id","togetherjs-chat-"+c.safeClassName(b));var e=D.container.find("#togetherjs-chat-messages");E(e.length);var f=D.container.find("#togetherjs-chat-notifier");e.append(a),D.chat.scroll();var g=!!d,h=f.find("#togetherjs-chat-notifier-message");d&&l.hidden()&&D.container.find("#togetherjs-notification")[0].play(),b&&h.data("message-id")==b&&(g=!0),e.is(":visible")&&(g=!1),g&&(h.empty(),h.append(a.clone(!0,!0)),h.data("message-id")!=b?(h.data("message-id",b||""),i.show(f)):f.is(":visible")||i.show(f),"number"==typeof d&&(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null),this.hideTimeout=setTimeout(function(){i.hide(f),this.hideTimeout=null}.bind(this),d)))}),scroll:n(function(){var a=D.container.find("#togetherjs-chat-messages")[0];a.scrollTop=a.scrollHeight})},d.on("display-window",function(a){"togetherjs-chat"==a&&(D.chat.scroll(),i.hide("#togetherjs-chat-notifier"))}),D.PeerView=c.Class({constructor:function(a){E(void 0!==a.isSelf,"PeerView instantiated with non-Peer object"),this.peer=a,this.dockClick=this.dockClick.bind(this)},setElement:function(a){var b=0,c=["togetherjs-person","togetherjs-person-status","togetherjs-person-name","togetherjs-person-name-abbrev","togetherjs-person-bgcolor","togetherjs-person-swatch","togetherjs-person-status","togetherjs-person-role","togetherjs-person-url","togetherjs-person-url-title","togetherjs-person-bordercolor"];c.forEach(function(c){var d=a.find("."+c);d.addClass(this.peer.className(c+"-")),b+=d.length},this),b||console.warn("setElement(",a,") doesn't contain any person items"),this.updateDisplay(a)},updateDisplay:n(function(a){a=a||D.container;var e=this.peer.name;this.peer.isSelf&&(e="me"),a.find("."+this.peer.className("togetherjs-person-name-")).text(this.peer.name||""),a.find("."+this.peer.className("togetherjs-person-name-abbrev-")).text(e);var f=a.find("."+this.peer.className("togetherjs-person-"));if(this.peer.avatar&&(c.assertValidUrl(this.peer.avatar),f.css({backgroundImage:"url("+this.peer.avatar+")"})),"inactive"==this.peer.idle?f.addClass("togetherjs-person-inactive"):f.removeClass("togetherjs-person-inactive"),f.attr("title",this.peer.name),this.peer.color&&(f.css({borderColor:this.peer.color}),f.find(".togetherjs-person-avatar-swatch").css({borderTopColor:this.peer.color,borderRightColor:this.peer.color})),this.peer.color){var g=a.find("."+this.peer.className("togetherjs-person-bgcolor-"));g.css({backgroundColor:this.peer.color}),g=a.find("."+this.peer.className("togetherjs-person-bordercolor-")),g.css({borderColor:this.peer.color})}a.find("."+this.peer.className("togetherjs-person-role-")).text(this.peer.isCreator?"Creator":"Participant");var h=this.peer.title||"";this.peer.title&&(h+=" ("),h+=c.truncateCommonDomain(this.peer.url,location.href),this.peer.title&&(h+=")"),a.find("."+this.peer.className("togetherjs-person-url-title-")).text(h);var i=this.peer.url;if(this.peer.urlHash&&(i+=this.peer.urlHash),a.find("."+this.peer.className("togetherjs-person-url-")).attr("href",i),a.find("."+this.peer.className("togetherjs-person-status-")).text("active"==this.peer.idle?"Active":"Inactive"),this.peer.isSelf){var j=b(".togetherjs-self-name");j.each(function(a,c){c=b(c),c.val()!=this.peer.name&&c.val(this.peer.name)}.bind(this)),b("#togetherjs-menu-avatar").attr("src",this.peer.avatar),this.peer.name||b("#togetherjs-menu .togetherjs-person-name-self").text(this.peer.defaultName)}this.peer.url!=d.currentUrl()?a.find("."+this.peer.className("togetherjs-person-")).addClass("togetherjs-person-other-url"):a.find("."+this.peer.className("togetherjs-person-")).removeClass("togetherjs-person-other-url"),this.peer.following?this.followCheckbox&&this.followCheckbox.prop("checked",!0):this.followCheckbox&&this.followCheckbox.prop("checked",!1),y(),this.updateFollow()}),update:function(){this.peer.isSelf||("live"==this.peer.status?this.dock():this.undock()),this.updateDisplay(),this.updateUrlDisplay()},updateUrlDisplay:function(a){var b=this.peer.url;if(b&&(b!=this._lastUpdateUrlDisplay||a)){this._lastUpdateUrlDisplay=b;var c=b==d.currentUrl();D.chat.urlChange({peer:this.peer,url:this.peer.url,title:this.peer.title,sameUrl:c})}},urlNudge:function(){this.updateUrlDisplay(!0)},notifyJoined:function(){D.chat.joinedSession({peer:this.peer})},dock:n(function(){h.getAllPeers().length;if(!this.dockElement){this.dockElement=f.sub("dock-person",{peer:this.peer}),this.dockElement.attr("id",this.peer.className("togetherjs-dock-element-")),D.container.find("#togetherjs-dock-participants").append(this.dockElement),this.dockElement.find(".togetherjs-person").animateDockEntry(),w(1),this.detailElement=f.sub("participant-window",{peer:this.peer});var a=this.peer.className("togetherjs-person-status-follow-");this.detailElement.find('[for="togetherjs-person-status-follow"]').attr("for",a),this.detailElement.find("#togetherjs-person-status-follow").attr("id",a),this.detailElement.find(".togetherjs-follow").click(function(){location.href=b(this).attr("href")}),this.detailElement.find(".togetherjs-nudge").click(function(){this.peer.nudge()}.bind(this)),this.followCheckbox=this.detailElement.find("#"+a),this.followCheckbox.change(function(){this.checked||this.peer.unfollow()}),this.maybeHideDetailWindow=this.maybeHideDetailWindow.bind(this),d.on("hide-window",this.maybeHideDetailWindow),D.container.append(this.detailElement),this.dockElement.click(function(){this.detailElement.is(":visible")?i.hide(this.detailElement):(i.show(this.detailElement,{bind:this.dockElement}),this.scrollTo(),this.cursor().element.animate({opacity:.3}).animate({opacity:1}).animate({opacity:.3}).animate({opacity:1}))}.bind(this)),this.updateFollow()}}),undock:function(){this.dockElement&&this.dockElement.animateDockExit().promise().then(function(){this.dockElement.remove(),this.dockElement=null,this.detailElement.remove(),this.detailElement=null,w(-1)}.bind(this))},scrollTo:function(){if(this.peer.url==d.currentUrl()){var a=this.peer.scrollPosition;if(!a)return void console.warn("Peer has no scroll position:",this.peer);a=k.pixelForPosition(a),b("html, body").easeTo(a)}},updateFollow:function(){if(this.peer.url&&this.detailElement){var a=this.detailElement.find(".togetherjs-same-url"),b=this.detailElement.find(".togetherjs-different-url");this.peer.url==d.currentUrl()?(a.show(),b.hide()):(a.hide(),b.show())}},maybeHideDetailWindow:function(a){this.detailElement&&a[0]&&a[0][0]===this.detailElement[0]&&(this.followCheckbox[0].checked?this.peer.follow():this.peer.unfollow())},dockClick:function(){},cursor:function(){return a("cursor").getClient(this.peer.id)},destroy:function(){d.off("hide-window",this.maybeHideDetailWindow)}});var P=!1;d.hub.on("invite",function(b){b.forClientId&&b.clientId!=h.Self.id||a(["who"],function(a){var c=a.ExternalPeer(b.userInfo.clientId,b.userInfo);D.chat.invite({peer:c,url:b.url,forEveryone:!b.forClientId})})}),D.showUrlChangeMessage=n(function(a){var b=f.sub("url-change",{peer:a});D.container.append(b),i.show(b)}),d.hub.on("url-change-nudge",function(a){a.to&&a.to!=d.clientId||a.peer.urlNudge()}),d.on("new-element",function(a){TogetherJS.config.get("toolName")&&D.updateToolName(a)});var Q=!1;return D.updateToolName=function(a){a=a||b(document.body);var c=TogetherJS.config.get("toolName");Q&&!c&&(c="TogetherJS"),c&&(a.find(".togetherjs-tool-name").text(c),Q=!0)},TogetherJS.config.track("toolName",function(){D.updateToolName(D.container)}),D}),c("playback",["jquery","util","session","storage","require"],function(a,b,c,d){function e(a){a=a.replace(/\r\n/g,"\n"),a=a.split(/\n/g);for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d=d.replace(/^\s+/,"").replace(/\s+$/,""),0===d.search(/\/\*/)){var e=d.search(/\*\//);if(-1==e){console.warn("bad line:",d);continue}d=d.substr(e+2)}d=d.replace(/^\s+/,""),d&&(d=JSON.parse(d),b.push(d))}return h(b)}var f=b.Module("playback"),g=(b.assert,{"cursor-update":!0,"scroll-update":!0});f.getLogs=function(b){return a.Deferred(0===b.search(/^local:/)?function(a){d.get("recording."+b.substr("local:".length)).then(function(b){return b?(b=e(b),void a.resolve(b)):void a.resolve(null)},function(b){a.reject(b)})}:function(c){a.ajax({url:b,dataType:"text"}).then(function(a){a=e(a),c.resolve(a)},function(a){c.reject(a)})})};var h=b.Class({constructor:function(a,b){this.logs=a,this.fromStorage=b,this.pos=0},play:function(){if(this.start=Date.now(),this.pos>=this.logs.length)return void this.unload();if(0!==this.pos){for(var a=[],b=!1,c=this.pos-1;c>=0;c--){var d=this.logs[c];if(g[d.type]&&a.push(d),"hello"==d.type||"hello-back"==d.type){this.playItem(d),b=!0;break}}for(b||console.warn("No hello message found before position",this.pos),a.reverse(),c=0;c<a.length;c++)this.playItem(a[c])}this.playOne()},cancel:function(){this.playTimer&&(clearTimeout(this.playTimer),this.playTimer=null),this.start=null,this.pos=0,this.unload()},pause:function(){this.playTimer&&(clearTimeout(this.playTimer),this.playTimer=null)},playOne:function(){if(this.playTimer=null,this.pos>=this.logs.length)return void this.unload();var a=this.logs[this.pos];if(this.playItem(a),this.pos++,this.pos>=this.logs.length)return void this.unload();var b=this.logs[this.pos],c=b.date-a.date;this.playTimer=setTimeout(this.playOne.bind(this),c),this.fromStorage&&this.savePos()},playItem:function(a){"hello"==a.type&&a.url!=(location.href+"").replace(/\#.*/,"")&&this.pause();try{c._getChannel().onmessage(a)}catch(b){console.warn("Could not play back message:",a,"error:",b)}},save:function(){this.fromStorage=!0,d.set("playback.logs",this.logs),this.savePos()},savePos:function(){d.set("playback.pos",this.pos)},unload:function(){this.fromStorage&&(d.set("playback.logs",void 0),d.set("playback.pos",void 0))}});return f.getRunningLogs=function(){return d.get("playback.logs").then(function(a){if(!a)return null;var b=h(a,!0);return d.get("playback.pos").then(function(a){return a=a||0,b.pos=a,b})})},f}),c("chat",["require","jquery","util","session","ui","templates","playback","storage","peers","windowing"],function(a,b,c,d,e,f,g,h,i,j){function k(a){o(a.peerId),o(a.messageId),o(a.date),o("string"==typeof a.text),l().then(function(b){for(var c=b.length-1;c>=0;c--)if(b[c].messageId===a.messageId)return;b.push(a),b.length>r&&b.splice(0,b.length-r),h.tab.set(q,b)})}function l(){return h.tab.get(q,[])}var m,n=c.Module("chat"),o=c.assert;d.hub.on("chat",function(a){e.chat.text({text:a.text,peer:a.peer,messageId:a.messageId,notify:!0}),k({text:a.text,date:Date.now(),peerId:a.peer.id,messageId:a.messageId})}),d.hub.on("bye",function(a){e.chat.leftSession({peer:a.peer,declinedJoin:"declined-join"==a.reason})}),n.submit=function(a){var b=a.split(/ /);if("/"==b[0].charAt(0)){var c=b[0].substr(1).toLowerCase(),f=p["command_"+c];if(f)return void f.apply(null,b.slice(1))}var g=d.clientId+"-"+Date.now();d.send({type:"chat",text:a,messageId:g}),e.chat.text({text:a,peer:i.Self,messageId:g,notify:!1}),k({text:a,date:Date.now(),peerId:i.Self.id,messageId:g})};var p={command_help:function(){var a=c.trim(f.help);e.chat.system({text:a})},command_test:function(d){if(!m)return void a(["walkabout"],function(a){m=a,this.command_test(d)}.bind(this));if(d=c.trim(d||"").split(/\s+/g),""!==d[0]&&d.length||(d=this._testCancel?["cancel"]:["start"]),"cancel"==d[0])return e.chat.system({text:"Aborting test"}),this._testCancel(),void(this._testCancel=null);if("start"==d[0]){var g=parseInt(d[1],10);(isNaN(g)||!g)&&(g=100),e.chat.system({text:"Testing with walkabout.js"});var h=b(f.walkabout),i=e.container.find(".togetherjs-test-container");i.empty(),i.append(h),i.show();var j=i.find(".togetherjs-status");return j.text("starting..."),void(this._testCancel=m.runManyActions({ondone:function(){j.text("done"),j.one("click",function(){i.hide()}),this._testCancel=null},onstatus:function(a){var b="actions: "+a.actions.length+" running: "+(a.times-a.remaining)+" / "+a.times;j.text(b)}}))}if("show"!=d[0])return"describe"==d[0]?void m.findActions().forEach(function(a){e.chat.system({text:a.description()})},this):void e.chat.system({text:"Did not understand: "+d.join(" ")});if(this._testShow.length)this._testShow.forEach(function(a){a&&a.remove()},this),this._testShow=[];else{var k=m.findActions();k.forEach(function(a){this._testShow.push(a.show())},this)}},_testCancel:null,_testShow:[],command_clear:function(){e.chat.clear()},command_exec:function(){var a,b=Array.prototype.slice.call(arguments).join(" "),c=eval;try{a=c(b)}catch(d){e.chat.system({text:"Error: "+d})}void 0!==a&&e.chat.system({text:""+a})},command_record:function(){e.chat.system({text:"When you see the robot appear, the recording will have started"}),window.open(d.recordUrl(),"_blank","left,width="+b(window).width()/2)},playing:null,command_playback:function(a){if(this.playing)return this.playing.cancel(),this.playing.unload(),this.playing=null,void e.chat.system({text:"playback cancelled"});if(!a)return void e.chat.system({text:"Nothing is playing"});var b=g.getLogs(a);b.then(function(a){return a?(a.save(),this.playing=a,void a.play()):void e.chat.system({text:"No logs found."})}.bind(this),function(b){e.chat.system({text:"Error fetching "+a+":\n"+JSON.stringify(b,null,"  ")})}),j.hide("#togetherjs-chat")},command_savelogs:function(a){function b(c){c.request.forClient==d.clientId&&c.request.saveAs==a&&h.set("recording."+a,c.logs).then(function(){d.hub.off("logs",b),e.chat.system({text:"Saved as local:"+a})})}d.send({type:"get-logs",forClient:d.clientId,saveAs:a}),d.hub.on("logs",b)},command_baseurl:function(a){return a?(a=a.replace(/\/*$/,""),e.chat.system({text:"If this goes wrong, do this in the console to reset:\n  localStorage.setItem('togetherjs.baseUrlOverride', null)"}),void h.set("baseUrlOverride",{baseUrl:a,expiresAt:Date.now()+864e5}).then(function(){e.chat.system({text:"baseUrl overridden (to "+a+"), will last for one day."})})):void h.get("baseUrlOverride").then(function(a){e.chat.system(a?{text:"Set to: "+a.baseUrl}:{text:"No baseUrl override set"})})},command_config:function(a,b){if(!a&&!b)return void h.get("configOverride").then(function(a){a?(c.forEachAttr(a,function(a,b){"expiresAt"!=b&&e.chat.system({text:"  "+b+" = "+JSON.stringify(a)})}),e.chat.system({text:"Config expires at "+new Date(a.expiresAt)})):e.chat.system({text:"No config override"})});if("clear"==a)return h.set("configOverride",void 0),void e.chat.system({text:"Clearing all overridden configuration"});if(console.log("config",[a,b]),!a||!b)return void e.chat.system({text:"Error: must provide /config VAR VALUE"});try{b=JSON.parse(b)}catch(d){return void e.chat.system({text:"Error: value ("+b+") could not be parsed: "+d})}TogetherJS._defaultConfiguration.hasOwnProperty(a)||e.chat.system({text:"Warning: variable "+a+" is unknown"}),h.get("configOverride").then(function(c){c=c||{},c[a]=b,c.expiresAt=Date.now()+864e5,h.set("configOverride",c).then(function(){e.chat.system({text:"Variable "+a+" = "+JSON.stringify(b)+"\nValue will be set for one day."})})})}},q="chatlog",r=100;return d.once("ui-ready",function(){l().then(function(a){if(a)for(var b=0;b<a.length;b++){var c=i.getPeer(a[b].peerId);e.chat.text({text:a[b].text,date:a[b].date,peer:c,messageId:a[b].messageId})}})}),d.on("close",function(){h.tab.set(q,void 0)}),n}),c("console",["util"],function(a){function b(a,b,c){for(a+="",c=c||" ";a.length<b;)a+=c;return a}function c(a,b,c){for(a+="",c=c||" ";a.length<b;)a=c+a;return a}function d(a,b,c){var d;if(a+="",-1==a.indexOf("\n"))return a;c=c||" ";var e="";for(d=0;b>d;d++)e+=c;for(a=a.split(/\n/g),d=1;d<a.length;d++)a[d]=e+a[d];return a.join("\n")}function e(a,b){return function(){this.write.apply(this,[b].concat(Array.prototype.slice.call(arguments)))}}var f=window.console||{log:function(){}},g=a.Class({constructor:function(){this.messages=[],this.level=this.levels.log},messageLimit:100,levels:{debug:1,log:2,info:3,notify:4,warn:5,error:6,fatal:7},maxLevel:0,consoleLevels:[[],f.debug||[],f.log||[],f.info||[],f.notify||[],f.warn||[],f.error||[],f.fatal||[]],levelNames:{},setLevel:function(a){var b;if("string"==typeof a){if(b=this.levels[a],void 0===b)throw new Error("Tried to set Console level to unknown level string: "+a);a=b}if("function"==typeof a){if(b=this.consoleLevels.indexOf(a),-1==b)throw new Error("Tried to set Console level based on unknown console function: "+a);a=b}if("number"==typeof a){if(0>a)throw new Error("Console level must be 0 or larger: "+a);if(a>this.maxLevel)throw new Error("Console level must be "+this.maxLevel+" or smaller: "+a)}this.level=a},write:function(a){try{this.messages.push([Date.now(),a,this._stringify(Array.prototype.slice.call(arguments,1))])}catch(b){f.warn("Error stringifying argument:",b)}if("suppress"!=a&&this.level<=a){var c=f[this.levelNames[a]];c||(c=f.log),c.apply(f,Array.prototype.slice.call(arguments,1))}},suppressedWrite:function(){this.write.apply(this,["suppress"].concat(Array.prototype.slice.call(arguments)))},trace:function(a){a=a||"log",f.trace&&(a="suppressedWrite");try{throw new Error}catch(b){var c=b.stack;c=c.replace(/^[^\n]*\n/,""),this[a](c)}f.trace&&f.trace()},_browserInfo:function(){return["TogetherJS base URL: "+TogetherJS.baseUrl,"User Agent: "+navigator.userAgent,"Page loaded: "+this._formatDate(TogetherJS.pageLoaded),"Age: "+this._formatMinutes(Date.now()-TogetherJS.pageLoaded)+" minutes","URL: "+location.href,"------+------+----------------------------------------------"]},_stringify:function(a){for(var b="",c=0;c<a.length;c++)b&&(b+=" "),b+=this._stringifyItem(a[c]);return b},_stringifyItem:function(a){if("string"==typeof a)return""===a?'""':a;if("object"==typeof a&&a.repr)try{return a.repr()}catch(b){f.warn("Error getting object repr:",a,b)}return null!==a&&"object"==typeof a&&(a=JSON.stringify(a)),a.toString()},_formatDate:function(a){return new Date(a).toISOString()},_formatTime:function(a){return((a-TogetherJS.pageLoaded)/1e3).toFixed(2)},_formatMinutes:function(a){var b=Math.floor(a/1e3/60),d=a-1e3*b*60;if(b>10)return b;var e=Math.floor(d/1e3)+"";return b+=":",e=c(e,2,"0"),b+=e,"0:00"==b&&(b+=((d/1e3).toFixed(3)+"").substr(1)),b},_formatLevel:function(a){return"suppress"===a?"":this.levelNames[a]},toString:function(){try{var a=this._browserInfo();return this.messages.forEach(function(e){a.push(c(this._formatTime(e[0]),6)+" "+b(this._formatLevel(e[1]),6)+" "+d(e[2],14))},this),a.join("\n")}catch(e){throw f.warn("Error running console.toString():",e),e}},submit:function(b){return a.Deferred(function(){b=b||{};var a=b.site||TogetherJS.config.get("pasteSite")||"https://www.friendpaste.com/",c=new XMLHttpRequest;c.open("POST",a),c.setRequestHeader("Content-Type","application/json"),c.send(JSON.stringify({title:b.title||"TogetherJS log file",snippet:this.toString(),language:"text"})),c.onreadystatechange=function(){if(4===c.readyState){JSON.parse(c.responseText)}}})}});a.forEachAttr(g.prototype.levels,function(a,b){g.prototype[b]=e(b,a),g.prototype.maxLevel=Math.max(g.prototype.maxLevel,a)}),a.forEachAttr(g.prototype.levels,function(a,b){g.prototype.levelNames[a]=b});var h=g();return h.ConsoleClass=g,h}),c("eventMaker",["jquery","util"],function(a,b){var c=b.Module("eventMaker");return c.performClick=function(b){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),c.togetherjsInternal=!0,b=a(b)[0];var d=b.dispatchEvent(c);if(!d&&"A"==b.tagName){var e=b.href;if(e)return void(location.href=e)}},c.fireChange=function(b){b=a(b)[0];var c=document.createEvent("HTMLEvents");c.initEvent("change",!0,!0),b.dispatchEvent(c)},c}),c("cursor",["jquery","ui","util","session","elementFinder","tinycolor","eventMaker","peers","templating"],function(a,b,c,d,e,f,g,h,i){function j(b){var c=Date.now();if(!(z>c-y)){y=c;var f=b.pageX,g=b.pageY;if(!(Math.abs(A-f)<3&&Math.abs(B-g)<3)){A=f,B=g;var h=b.target,i=a(h).closest(".togetherjs-window, .togetherjs-popup, #togetherjs-dock");if(i.length?h=i[0]:e.ignoreElement(h)&&(h=null),!h||h==document.documentElement||h==document.body)return C={type:"cursor-update",top:g,left:f},void d.send(C);h=a(h);var j=h.offset();if(!j)return void console.warn("Could not get offset of element:",h[0]);var k=f-j.left,l=g-j.top;C={type:"cursor-update",element:e.elementLocation(h),offsetX:Math.floor(k),offsetY:Math.floor(l)},d.send(C)}}}function k(b){var c=a("<canvas></canvas>");c.attr("height",t),c.attr("width",v);var d=c[0].getContext("2d");return d.fillStyle=b,d.moveTo(0,0),d.beginPath(),d.lineTo(0,t/1.2),d.lineTo(Math.sin(u/2)*t/1.5,Math.cos(u/2)*t/1.5),d.lineTo(Math.sin(u)*t/1.2,Math.cos(u)*t/1.2),d.lineTo(0,0),d.shadowColor="rgba(0,0,0,0.3)",d.shadowBlur=2,d.shadowOffsetX=1,d.shadowOffsetY=2,d.strokeStyle="#ffffff",d.stroke(),d.fill(),c[0].toDataURL("image/png")}function l(){var a=Date.now();if(D){if(!(G>a-E))return;clearTimeout(D)}D=setTimeout(m,F),E||(E=a)
}function m(){D=null,E=0,x.forEach(function(a){a.refresh()}),H={type:"scroll-update",position:e.elementByPixel(a(window).scrollTop())},d.send(H)}function n(b){b.togetherjsInternal||setTimeout(function(){if(TogetherJS.running){var f=b.target;if(f==document.documentElement&&(f=document.body),!e.ignoreElement(f)&&"video"!==f.nodeName.toLowerCase()){var g=TogetherJS.config.get("dontShowClicks"),i=TogetherJS.config.get("cloneClicks");if(c.matchElement(f,i)||!c.matchElement(f,g)){var j=e.elementLocation(f),k=a(f).offset(),l=b.pageX-k.left,m=b.pageY-k.top;d.send({type:"cursor-click",element:j,offsetX:l,offsetY:m}),c.matchElement(f,g)||o({top:b.pageY,left:b.pageX},h.Self.color)}}}})}function o(b,c){var d=i.clone("click");a(document.body).append(d),d.css({top:b.top,left:b.left,borderColor:c}),setTimeout(function(){d.addClass("togetherjs-clicking")},100),setTimeout(function(){d.remove()},J)}function p(){setTimeout(function(){var a=Date.now();L>a-K||(K=a,d.send({type:"keydown"}))})}var q=c.assert,r=c.Module("cursor"),s=["#111","#eee"],t=50,u=35/180*Math.PI,v=Math.ceil(Math.sin(u)*t),w=2e3;d.hub.on("cursor-update",function(a){a.sameUrl?x.getClient(a.clientId).updatePosition(a):x.getClient(a.clientId).hideOtherUrl()});var x=c.Class({constructor:function(b){this.clientId=b,this.element=i.clone("cursor"),this.elementClass="togetherjs-scrolled-normal",this.element.addClass(this.elementClass),this.updatePeer(h.getPeer(b)),this.lastTop=this.lastLeft=null,a(document.body).append(this.element),this.element.animateCursorEntry(),this.keydownTimeout=null,this.clearKeydown=this.clearKeydown.bind(this),this.atOtherUrl=!1},KEYDOWN_WAIT_TIME:2e3,updatePeer:function(a){this.element.css({color:a.color});var b=this.element.find("img.togetherjs-cursor-img");b.attr("src",k(a.color));var c=this.element.find(".togetherjs-cursor-name"),d=this.element.find(".togetherjs-cursor-container");q(c.length),c.text(a.name),d.css({backgroundColor:a.color,color:f.mostReadable(a.color,s)});var e=this.element.find("svg path");e.attr("fill",a.color),"live"!=a.status?(this.element.find("svg").animate({opacity:0},350),this.element.find(".togetherjs-cursor-container").animate({width:34,height:20,padding:12,margin:0},200).animate({width:0,height:0,padding:0,opacity:0},200)):this.element.animate({opacity:.3}).animate({opacity:1})},setClass:function(a){a!=this.elementClass&&(this.element.removeClass(this.elementClass).addClass(a),this.elementClass=a)},updatePosition:function(b){var c,d;if(this.atOtherUrl&&(this.element.show(),this.atOtherUrl=!1),b.element){var f=a(e.findElement(b.element)),g=f.offset();c=g.top+b.offsetY,d=g.left+b.offsetX}else c=b.top,d=b.left;this.lastTop=c,this.lastLeft=d,this.setPosition(c,d)},hideOtherUrl:function(){this.atOtherUrl||(this.atOtherUrl=!0,this.element.hide())},rotateCursorDown:function(){var b=a(this.element).find("svg");b.animate({borderSpacing:-150,opacity:1},{step:function(a,c){"borderSpacing"==c.prop?b.css("-webkit-transform","rotate("+a+"deg)").css("-moz-transform","rotate("+a+"deg)").css("-ms-transform","rotate("+a+"deg)").css("-o-transform","rotate("+a+"deg)").css("transform","rotate("+a+"deg)"):b.css(c.prop,a)},duration:500},"linear").promise().then(function(){b.css("-webkit-transform","").css("-moz-transform","").css("-ms-transform","").css("-o-transform","").css("transform","").css("opacity","")})},setPosition:function(b,c){var d=a(window).scrollTop(),e=a(window).height();d>b?(b=25,this.setClass("togetherjs-scrolled-above")):b>d+e-t?(b=e-t-5,this.setClass("togetherjs-scrolled-below")):this.setClass("togetherjs-scrolled-normal"),this.element.css({top:b,left:c})},refresh:function(){null!==this.lastTop&&this.setPosition(this.lastTop,this.lastLeft)},setKeydown:function(){this.keydownTimeout?clearTimeout(this.keydownTimeout):this.element.find(".togetherjs-cursor-typing").show().animateKeyboard(),this.keydownTimeout=setTimeout(this.clearKeydown,this.KEYDOWN_WAIT_TIME)},clearKeydown:function(){this.keydownTimeout=null,this.element.find(".togetherjs-cursor-typing").hide().stopKeyboardAnimation()},_destroy:function(){this.element.remove(),this.element=null}});x._cursors={},r.getClient=x.getClient=function(a){var b=x._cursors[a];return b||(b=x._cursors[a]=x(a)),b},x.forEach=function(a,b){b=b||null;for(var c in x._cursors)x._cursors.hasOwnProperty(c)&&a.call(b,x._cursors[c],c)},x.destroy=function(a){x._cursors[a]._destroy(),delete x._cursors[a]},h.on("new-peer identity-updated status-updated",function(a){var b=x.getClient(a.id);b.updatePeer(a)});var y=0,z=100,A=-1,B=-1,C=null,D=null,E=0,F=75,G=300,H=null;d.on("prepare-hello",function(a){H&&(a.scrollPosition=H.position)}),d.hub.on("scroll-update",function(a){a.peer.scrollPosition=a.position,a.peer.following&&a.peer.view.scrollTo()});var I=!1;d.hub.on("hello-back hello",function(a){"hello"==a.type&&(I=!0),a.scrollPosition&&(a.peer.scrollPosition=a.scrollPosition,!I&&a.sameUrl&&Date.now()-d.timeHelloSent<w&&(I=!0,a.peer.view.scrollTo()))}),d.on("ui-ready",function(){a(document).mousemove(j),document.addEventListener("click",n,!0),document.addEventListener("keydown",p,!0),a(window).scroll(l),l()}),d.on("close",function(){x.forEach(function(a,b){x.destroy(b)}),a(document).unbind("mousemove",j),document.removeEventListener("click",n,!0),document.removeEventListener("keydown",p,!0),a(window).unbind("scroll",l)}),d.hub.on("hello",function(){C&&d.send(C),H&&d.send(H)});var J=3e3;d.hub.on("cursor-click",function(b){if(b.sameUrl){x.getClient(b.clientId).updatePosition(b);var d=a(e.findElement(b.element)),f=d.offset(),h=f.top+b.offsetY,i=f.left+b.offsetX,j=TogetherJS.config.get("cloneClicks");c.matchElement(d,j)&&g.performClick(d);var k=TogetherJS.config.get("dontShowClicks");c.matchElement(d,k)||o({top:h,left:i},b.peer.color)}});var K=0,L=500;return d.hub.on("keydown",function(a){var b=x.getClient(a.clientId);b.setKeydown()}),c.testExpose({Cursor:x}),r}),c("ot",["util"],function(a){var b=a.Module("ot"),c=a.assert,d=a.Class({constructor:function(){this._items={},this._count=0},contains:function(a){return c("string"==typeof a),this._items.hasOwnProperty(a)},add:function(a){c("string"==typeof a),this.contains(a)||(this._items[a]=null,this._count++)},remove:function(a){c("string"==typeof a),this.contains(a)&&(delete this._items[a],this._count++)},isEmpty:function(){return!this._count}}),e=a.Class({constructor:function(a){this._q=[],this._size=a,this._deleted=0},_trim:function(){this._size&&this._q.length>this._size&&(this._q.splice(0,this._q.length-this._size),this._deleted+=this._q.length-this._size)},push:function(a){this._q.push(a),this._trim()},last:function(){return this._q[this._q.length-1]},walkBack:function(a,b){for(var c=!0,d=this._q.length-1;d>=0;d--){var e=this._q[d];if(c=a.call(b,e,d+this._deleted),c===!1)return c;c||(c=!0)}return c},walkForward:function(a,b,c){for(var d=!0,e=a;e<this._q.length;e++){var f=this._q[e-this._deleted];if(d=b.call(c,f,e),d===!1)return d;d||(d=!0)}return d},insert:function(a,b){this._q.splice(a-this._deleted,0,b)}}),f=a.Class({constructor:function(a,b,d,e,f){this.version=a,this.clientId=b,this.delta=d,this.known=e,this.outOfOrder=!!f,c("number"==typeof a&&"string"==typeof b,"Bad Change():",a,b)},toString:function(){var a="[Change "+this.version+"."+this.clientId+": ";a+=this.delta+" ",this.outOfOrder&&(a+="(out of order) ");var b=[];for(var c in this.known)this.known.hasOwnProperty(c)&&b.push(c);return b.sort(),a+="{",b.length?b.forEach(function(b,c){c&&(a+=";"),a+=b+":"+this.known[b]},this):a+="nothing known",a+"}]"},clone:function(){return f(this.version,this.clientId,this.delta.clone(),a.extend(this.known),this.outOfOrder)},isBefore:function(a){return c(a!==this,"Tried to compare a change to itself",this),a.version>this.version||a.version==this.version&&a.clientId>this.clientId},knowsAboutAll:function(a){for(var b in a)if(a.hasOwnProperty(b)&&a[b]&&(!this.known[b]||this.known[b]<a[b]))return!1;return!0},knowsAboutChange:function(a){return a.clientId==this.clientId||this.known[a.clientId]&&this.known[a.clientId]>=a.version},knowsAboutVersion:function(a,b){return a&&b!=this.clientId?this.known[b]&&this.known[b]>=a:!0},maybeMissingChanges:function(a,b){return a?this.known[b]?this.known[b]>=a?!1:b>this.clientId&&this.known[b]>=this.version-1||b<this.clientId&&this.known[b]==this.version?!1:!0:!0:!1}});return b.SimpleHistory=a.Class({constructor:function(a,b,c){this.clientId=a,this.committed=b,this.current=b,this.basis=c,this.queue=[],this.deltaId=1,this.selection=null},setSelection:function(a){this.selection=a?b.TextReplace(a[0],a[1]-a[0],"@"):null},getSelection:function(){return this.selection?[this.selection.start,this.selection.start+this.selection.del]:null},add:function(a){var b={id:this.clientId+"."+this.deltaId++,delta:a};return this.queue.length||(b.basis=this.basis),this.queue.push(b),this.current=a.apply(this.current),!!b.basis},commit:function(a){if(a.basis!==this.basis)return!1;if(this.queue.length&&this.queue[0].id===a.id)return c(a.basis===this.queue[0].basis),this.committed=this.queue.shift().delta.apply(this.committed),this.basis++,this.queue.length&&(this.queue[0].basis=this.basis),!1;var b=a.delta;return this.queue=this.queue.map(function(a){var c=a.delta.transpose(b);return b=c[1],{id:a.id,delta:c[0]}}),this.selection&&(this.selection=this.selection.transpose(b)[0]),this.committed=a.delta.apply(this.committed),this.basis++,this.queue.length&&(this.queue[0].basis=this.basis),this.current=this.committed,this.queue.forEach(function(a){this.current=a.delta.apply(this.current)}.bind(this)),!0},getNextToSend:function(){var a=this.queue[0];return a?a.sent?null:(c(a.basis),a.sent=!0,a):null}}),b.History=a.Class({constructor:function(a,b){this._history=e(),this._history.push({clientId:"init",state:b}),this.clientId=a,this.known={},this.mostRecentLocalChange=null},add:function(a){if(a.clientId==this.clientId)return this._history.push(a),this.mostRecentLocalChange=a.version,a.delta;c(!this.known[a.clientId]||this.known[a.clientId]<a.version,"Got a change",a,"that appears older (or same as) a known change",this.known[a.clientId]);var b=this._history.last();if(("init"==b.clientId||b.isBefore(a))&&a.knowsAboutAll(this.known)&&a.knowsAboutVersion(this.mostRecentLocalChange,this.clientId))return this._history.push(a),this.known[a.clientId]=a.version,a.delta;this.logHistory("//");var e=d();for(var f in this.known)this.known.hasOwnProperty(f)&&a.maybeMissingChanges(this.known[f],f)&&e.add(f);if(a.maybeMissingChanges(this.mostRecentLocalChange,this.clientId)&&e.add(this.clientId),!e.isEmpty()){var g=null;this._history.walkBack(function(b,c){return g=c,"init"==b.clientId?!1:e.contains(b.clientId)&&!a.maybeMissingChanges(b.version,b.clientId)&&(e.remove(b.clientId),e.isEmpty())?!1:!0},this),this._history.walkForward(g,function(b,c){if("init"==b.clientId)return!0;if(a.isBefore(b))return!1;if(!a.knowsAboutChange(b)){var d=this.promoteDelta(b.delta,c,a);!d.equals(b.delta),this.logChange("->rebase",a,function(){var c=a.delta.transpose(d);a.delta=c[0],a.known[b.clientId]=b.version},"with:",b)}return!0},this)}var h=null;this._history.walkBack(function(b,c){return"init"==b.clientId||b.isBefore(a)?(h=c+1,!1):!0},this),c(h),this._history.insert(h,a);var i=a.delta;return this._history.walkForward(h+1,function(b){if(!b.knowsAboutChange(a)){{b.clone()}this.logChange("^^fix",b,function(){var c=b.delta.transpose(i);console.log("  ^^real");var d=b.delta.transpose(i);b.delta=d[0],b.known[a.clientId]=a.version,i=c[1]},"clone:",a.delta+""),console.log("(trans)",i+""),c(b.knowsAboutChange(a))}},this),this.logHistory("!!"),i},promoteDelta:function(a,b,c){return this._history.walkForward(b+1,function(b){if(c.isBefore(b))return!1;if(c.knowsAboutChange(b)){var d=b.delta.transpose(a);a=d[1]}return!0}),a},logHistory:function(a){a=a||"";var b=Array.prototype.slice.call(arguments,1);console.log.apply(console,[a+"history",this.clientId,":"].concat(b)),console.log(a+" state:",JSON.stringify(this.getStateSafe()));var d;this._history.walkForward(0,function(b,e){if(e){try{d=b.delta.apply(d)}catch(f){d="Error: "+f}console.log(a+"  ",e,b+"",JSON.stringify(d))}else c("init"==b.clientId),console.log(a+" init:",JSON.stringify(b.state)),d=b.state})},logChange:function(a,b,c){a=a||"before";var d=Array.prototype.slice.call(arguments,3);console.log.apply(console,[a,this.clientId,":",b+""].concat(d).concat([JSON.stringify(this.getStateSafe(!0))]));try{c()}finally{console.log(a+" after:",b+"",JSON.stringify(this.getStateSafe()))}},addDelta:function(b){var c=this._createVersion(),d=f(c,this.clientId,b,a.extend(this.knownVersions));return this.add(d),d},_createVersion:function(){var a=1;for(var b in this.knownVersions)a=Math.max(a,this.knownVersions[b]);return a=Math.max(a,this.mostRecentLocalChange),a+1},fault:function(){throw new Error("Fault")},getState:function(){var a;return this._history.walkForward(0,function(b){a="init"==b.clientId?b.state:b.delta.apply(a)},this),a},getStateSafe:function(){try{return this.getState()}catch(a){return"Error: "+a}}}),b.TextReplace=a.Class({constructor:function(a,b,d){c("number"==typeof a&&"number"==typeof b&&"string"==typeof d,a,b,d),c(a>=0&&b>=0,a,b),this.start=a,this.del=b,this.text=d},toString:function(){return this.empty()?"[no-op]":this.del?this.text?"[replace "+this.del+" chars with "+JSON.stringify(this.text)+" @"+this.start+"]":"[delete "+this.del+" chars @"+this.start+"]":"[insert "+JSON.stringify(this.text)+" @"+this.start+"]"},equals:function(a){return a.constructor===this.constructor&&a.del===this.del&&a.start===this.start&&a.text===this.text},clone:function(a,c,d){return void 0===a&&(a=this.start),void 0===c&&(c=this.del),void 0===d&&(d=this.text),b.TextReplace(a,c,d)},empty:function(){return!this.del&&!this.text},apply:function(b){if(this.empty())return b;if(this.start>b.length)throw console.trace(),new a.AssertionError("Start after end of text ("+JSON.stringify(b)+"/"+b.length+"): "+this);if(this.start+this.del>b.length)throw new a.AssertionError("Start+del after end of text ("+JSON.stringify(b)+"/"+b.length+"): "+this);return b.substr(0,this.start)+this.text+b.substr(this.start+this.del)},transpose:function(a){var d;return c(a instanceof b.TextReplace,"Transposing with non-TextReplace:",a),this.empty()?[this.clone(),a.clone()]:a.empty()?[this.clone(),a.clone()]:a.before(this)?[this.clone(this.start+a.text.length-a.del),a.clone()]:this.before(a)?[this.clone(),a.clone(a.start+this.text.length-this.del)]:a.sameRange(this)?[this.clone(this.start+a.text.length,0),a.clone(void 0,0)]:a.contains(this)?[this.clone(a.start+a.text.length,0,this.text),a.clone(void 0,a.del-this.del+this.text.length,a.text+this.text)]:this.contains(a)?[this.clone(void 0,this.del-a.del+a.text.length,a.text+this.text),a.clone(this.start,0,a.text)]:this.overlapsStart(a)?(d=this.start+this.del-a.start,[this.clone(void 0,this.del-d),a.clone(this.start+this.text.length,a.del-d)]):(c(a.overlapsStart(this),a+"","does not overlap start of",this+"",a.before(this)),d=a.start+a.del-this.start,[this.clone(a.start+a.text.length,this.del-d),a.clone(void 0,a.del-d)])},before:function(a){return this.start+this.del<=a.start},contains:function(a){return a.start>=this.start&&a.start+a.del<this.start+this.del},sameRange:function(a){return a.start==this.start&&a.del==this.del},overlapsStart:function(a){return this.start<a.start&&this.start+this.del>a.start},classMethods:{fromChange:function(a,b){c("string"==typeof a),c("string"==typeof b);for(var d=0;d<b.length&&b.charAt(d)==a.charAt(d);)d++;for(var e=0;e<b.length-d&&e<a.length-d&&b.charAt(b.length-e-1)==a.charAt(a.length-e-1);)e++;var f=a.substr(d,a.length-d-e),g=b.substr(d,b.length-d-e);return f.length||g?this(d,f.length,g):null},random:function(a,b){var c,d,e,f=["ins","del","repl"];switch(a.length||(f=["ins"]),b.pick(f)){case"ins":return c=b.string(b.number(2)?b.number(3)+1:1),d=b.number(4)?b.number(3)?b.number(a.length):a.length-1:0,this(d,0,c);case"del":return b.number(20)?(d=b.number(a.length-1),e=b.number(2)?b.number(5)+1:1,e=Math.min(e,a.length-d),this(d,e,"")):this(0,a.length,"");case"repl":return d=b.number(a.length-1),e=b.number(5),e=Math.min(e,a.length-d),c=b.string(b.number(2)+1),this(d,e,c)}throw"Unreachable"}}}),b}),c("forms",["jquery","util","session","elementFinder","eventMaker","templating","ot"],function(a,b,c,d,e,f,g){function h(b){var c=TogetherJS.config.get("ignoreForms");return c===!0?!0:a(b).is(c.join(","))}function i(a){var b=a.target.tagName;("TEXTAREA"==b||"INPUT"==b)&&j(a)}function j(a){k({element:a.target,value:r(a.target)})}function k(b){var e=a(b.element);B(e);var f=b.tracker,i=b.value;if(!D&&!(d.ignoreElement(e)||o(e)&&!f||h(e))){var j=d.elementLocation(e),k={type:"form-update",element:j};if(q(e)||f){var l=e.data("togetherjsHistory");if(l){if(l.current==i)return;var m=g.TextReplace.fromChange(l.current,i);return B(m),l.add(m),void u(k.element,l,f)}k.value=i,k.basis=1,e.data("togetherjsHistory",g.SimpleHistory(c.clientId,i,1))}else k.value=i;c.send(k)}}function l(b){b=a(b);var c=(b.prop("type")||"text").toLowerCase();return"INPUT"==b.prop("tagName")&&-1!=["radio","checkbox"].indexOf(c)?!0:!1}function m(){B(!F.length),b.forEachAttr(E,function(b){var d=b.scan();d&&a.each(d,function(){var d=new b(this);a(this).data("togetherjsHistory",g.SimpleHistory(c.clientId,d.getContent(),1)),F.push(d)})})}function n(){F.forEach(function(a){a.destroy()}),F=[]}function o(a){var c=!1;return b.forEachAttr(E,function(b){b.tracked(a)&&(c=!0)}),c}function p(b,c){b=a(b)[0];for(var d=0;d<F.length;d++){var e=F[d];if(e.tracked(b))return B(!c||c==e.trackerName,"Expected to map to a tracker type",c,"but got",e.trackerName),e}return null}function q(b){b=a(b);var c=b.prop("tagName"),d=(b.prop("type")||"text").toLowerCase();return"TEXTAREA"==c?!0:"INPUT"==c&&-1!=J.indexOf(d)?!0:!1}function r(b){return b=a(b),l(b)?b.prop("checked"):b.val()}function s(b){return b=a(b)[0],"TEXTAREA"==b.tagName?"textarea":"SELECT"==b.tagName?"select":"INPUT"==b.tagName?(b.getAttribute("type")||"text").toLowerCase():"?"}function t(b,c){b=a(b);var d=!1;if(l(b)){var f=!!b.prop("checked");c=!!c,f!=c&&(d=!0,b.prop("checked",c))}else b.val()!=c&&(d=!0,b.val(c));d&&e.fireChange(b)}function u(a,b,d){var e=b.getNextToSend();if(e){var f={type:"form-update",element:a,"server-echo":!0,replace:{id:e.id,basis:e.basis,delta:{start:e.delta.start,del:e.delta.del,text:e.delta.text}}};d&&(f.tracker=d),c.send(f)}}function v(){K=!0;var b={type:"form-init",pageAge:Date.now()-TogetherJS.pageLoaded,updates:[]},e=a("textarea, input, select");e.each(function(){if(!(d.ignoreElement(this)||o(this)||h(this))){var c=a(this),e=r(c),f={element:d.elementLocation(this),value:e,elementType:s(c)};if(q(c)){var g=c.data("togetherjsHistory");g&&(f.value=g.committed,f.basis=g.basis)}b.updates.push(f)}}),F.forEach(function(c){var e=c.makeInit();B(c.tracked(e.element));var f=a(e.element).data("togetherjsHistory");f&&(e.value=f.committed,e.basis=f.basis),e.element=d.elementLocation(a(e.element)),b.updates.push(e)}),b.updates.length&&c.send(b)}function w(){var b=a("textarea, input, select");b.each(function(){if(!o(this)&&!d.ignoreElement(this)){var b=a(this),e=r(b);b.data("togetherjsHistory",g.SimpleHistory(c.clientId,e,1))}}),n(),m()}function x(a){var b=a.target;return d.ignoreElement(b)||o(b)?void y(a):void(b!=L&&(L=b,c.send({type:"form-focus",element:d.elementLocation(b)})))}function y(a){a.target;L&&(L=null,c.send({type:"form-focus",element:null}))}function z(b,c){c=a(c);var d=c.offset();if(!d)return console.warn("Could not get offset of element:",c[0]),null;var e=f.sub("focus",{peer:b});return e=e.find(".togetherjs-focus"),e.css({top:d.top-C+"px",left:d.left-C+"px",width:c.outerWidth()+2*C+"px",height:c.outerHeight()+2*C+"px"}),a(document.body).append(e),e}var A=b.Module("forms"),B=b.assert,C=5,D=!1,E={},F=[];TogetherJS.addTracker=function(a,b){B("function"==typeof a,"You must pass in a class"),B("string"==typeof a.prototype.trackerName,"Needs a .prototype.trackerName string"),"destroy update init makeInit tracked".split(/ /).forEach(function(b){B("function"==typeof a.prototype[b],"Missing required tracker method: "+b)}),"scan tracked".split(/ /).forEach(function(b){B("function"==typeof a[b],"Missing required tracker class method: "+b)}),E[a.prototype.trackerName]=a,b||w()};var G=b.Class({trackerName:"AceEditor",constructor:function(b){this.element=a(b)[0],B(a(this.element).hasClass("ace_editor")),this._change=this._change.bind(this),this._editor().document.on("change",this._change)},tracked:function(b){return this.element===a(b)[0]},destroy:function(){this._editor().document.removeListener("change",this._change)},update:function(a){this._editor().document.setValue(a.value)},init:function(a){this.update(a)},makeInit:function(){return{element:this.element,tracker:this.trackerName,value:this._editor().document.getValue()}},_editor:function(){return this.element.env},_change:function(){D||k({tracker:this.trackerName,element:this.element,value:this.getContent()})},getContent:function(){return this._editor().document.getValue()}});G.scan=function(){return a(".ace_editor")},G.tracked=function(b){return!!a(b).closest(".ace_editor").length},TogetherJS.addTracker(G,!0);var H=b.Class({trackerName:"CodeMirrorEditor",constructor:function(b){this.element=a(b)[0],B(this.element.CodeMirror),this._change=this._change.bind(this),this._editor().on("change",this._change)},tracked:function(b){return this.element===a(b)[0]},destroy:function(){this._editor().off("change",this._change)},update:function(a){this._editor().setValue(a.value)},init:function(a){a.value&&this.update(a)},makeInit:function(){return{element:this.element,tracker:this.trackerName,value:this._editor().getValue()}},_change:function(){D||k({tracker:this.trackerName,element:this.element,value:this.getContent()})},_editor:function(){return this.element.CodeMirror},getContent:function(){return this._editor().getValue()}});H.scan=function(){for(var b=[],c=document.body.getElementsByTagName("*"),d=c.length,e=0;d>e;e++){var f=c[e];f.CodeMirror&&b.push(f)}return a(b)},H.tracked=function(b){for(b=a(b)[0];b;){if(b.CodeMirror)return!0;b=b.parentNode}return!1},TogetherJS.addTracker(H,!0);var I=b.Class({trackerName:"CKEditor",constructor:function(b){this.element=a(b)[0],B(CKEDITOR),B(CKEDITOR.dom.element.get(this.element)),this._change=this._change.bind(this),this._editor().on("change",this._change)},tracked:function(b){return this.element===a(b)[0]},destroy:function(){this._editor().removeListener("change",this._change)},update:function(a){this._editor().editable().setHtml(a.value)},init:function(a){this.update(a)},makeInit:function(){return{element:this.element,tracker:this.trackerName,value:this.getContent()}},_change:function(){D||k({tracker:this.trackerName,element:this.element,value:this.getContent()})},_editor:function(){return CKEDITOR.dom.element.get(this.element).getEditor()},getContent:function(){return this._editor().getData()}});I.scan=function(){var b=[];if("undefined"!=typeof CKEDITOR){var c;for(var d in CKEDITOR.instances)c=document.getElementById(d)||document.getElementsByName(d)[0],c&&b.push(c);return a(b)}},I.tracked=function(b){return"undefined"==typeof CKEDITOR?!1:(b=a(b)[0],!(!CKEDITOR.dom.element.get(b)||!CKEDITOR.dom.element.get(b).getEditor()))},TogetherJS.addTracker(I,!0);var J="color date datetime datetime-local email tel text time week".split(/ /g);c.hub.on("form-update",function(b){if(b.sameUrl){var c,e=a(d.findElement(b.element));b.tracker&&(c=p(e,b.tracker),B(c));var f,h=e[0].ownerDocument.activeElement;q(h)&&(f=[h.selectionStart,h.selectionEnd]);var i;q(e)&&(i=[e[0].selectionStart,e[0].selectionEnd]);var j;if(b.replace){var k=e.data("togetherjsHistory");if(!k)return void console.warn("form update received for uninitialized form element");k.setSelection(i),b.replace.delta=g.TextReplace(b.replace.delta.start,b.replace.delta.del,b.replace.delta.text);var l=k.commit(b.replace),m=null;if("undefined"!=typeof c&&(m=c.trackerName),u(b.element,k,m),!l)return;j=k.current,i=k.getSelection()}else j=b.value;D=!0;try{c?c.update({value:j}):t(e,j),q(e)&&(e[0].selectionStart=i[0],e[0].selectionEnd=i[1]),h!=e[0]&&(h.focus(),q(h)&&(h.selectionStart=f[0],h.selectionEnd=f[1]))}finally{D=!1}}});var K=!1;c.on("reinitialize",w),c.on("ui-ready",w),c.on("close",n),c.hub.on("form-init",function(b){if(b.sameUrl){if(K){var e=Date.now()-TogetherJS.pageLoaded;if(b.pageAge<e)return}b.updates.forEach(function(e){var f;try{f=d.findElement(e.element)}catch(h){return void console.warn(h)}D=!0;try{if(e.tracker){var i=p(f,e.tracker);B(i),i.init(e,b)}else t(f,e.value);if(e.basis){var j=a(f).data("togetherjsHistory");j&&j.basis===e.basis&&1!==j.basis||a(f).data("togetherjsHistory",g.SimpleHistory(c.clientId,e.value,e.basis))}}finally{D=!1}})}});var L=null,M={};return c.hub.on("form-focus",function(a){var b=M[a.peer.id];if(b&&(b.remove(),b=null),a.element){var c=d.findElement(a.element),e=z(a.peer,c);e&&(M[a.peer.id]=e)}}),c.hub.on("hello",function(){L&&setTimeout(function(){L&&c.send({type:"form-focus",element:d.elementLocation(L)})})}),c.on("ui-ready",function(){a(document).on("change",j),a(document).on("input keyup cut paste",i),a(document).on("focusin",x),a(document).on("focusout",y)}),c.on("close",function(){a(document).off("change",j),a(document).off("input keyup cut paste",i),a(document).off("focusin",x),a(document).off("focusout",y)}),c.hub.on("hello",function(a){a.sameUrl&&setTimeout(v)}),A}),c("startup",["util","require","jquery","windowing","storage"],function(a,b,c,d,e){var f=(a.assert,a.Module("startup")),g=null,h=["browserBroken","browserUnsupported","sessionIntro","walkthrough","share"],i=null;f.start=function(){if(!g)return void b(["session"],function(a){g=a,f.start()});var a=-1;return i&&(a=h.indexOf(i)),a++,a>=h.length?void g.emit("startup-ready"):(i=h[a],void j[i](f.start))};var j={browserBroken:function(a){return window.WebSocket?void a():(d.show("#togetherjs-browser-broken",{onClose:function(){g.close()}}),void(c.browser.msie&&c("#togetherjs-browser-broken-is-ie").show()))},browserUnsupported:function(a){if(!c.browser.msie)return void a();var b=!0;d.show("#togetherjs-browser-unsupported",{onClose:function(){b?g.close():a()}}),c("#togetherjs-browser-unsupported-anyway").click(function(){b=!1})},sessionIntro:function(a){if(!g.isClient||!g.firstRun)return void a();if(TogetherJS.config.close("suppressJoinConfirmation"),TogetherJS.config.get("suppressJoinConfirmation"))return void a();var b=!1;d.show("#togetherjs-intro",{onClose:function(){b||a()}}),c("#togetherjs-intro .togetherjs-modal-dont-join").click(function(){b=!0,d.hide(),g.close("declined-join")})},walkthrough:function(a){e.settings.get("seenIntroDialog").then(function(c){return c?void a():void b(["walkthrough"],function(b){b.start(!0,function(){e.settings.set("seenIntroDialog",!0),a()})})})},share:function(a){return TogetherJS.config.close("suppressInvite"),g.isClient||!g.firstRun||TogetherJS.config.get("suppressInvite")?void a():void b(["windowing"],function(a){a.show("#togetherjs-share")})}};return f}),c("videos",["jquery","util","session","elementFinder"],function(a,b,c,d){function e(){var b=a("video");f(b),h(b)}function f(a){var b;p.forEach(function(c){b=g(c),a.on(c,b),n.push({name:c,listener:b})})}function g(a){return function(b,e){var f=b.target;e||(e={}),e.silent||c.send({type:"video-"+a,location:d.elementLocation(f),position:f.currentTime})}}function h(b){b.each(function(b,c){var d=i();a(c).on(o,d),n.push({name:o,listener:d})})}function i(){var a=0;return function(b){var c=b.target.currentTime;j(c,a)&&g(o)(b),a=c}}function j(a,b){var c=Math.abs(a-b),d=1e3*c;return d>q}function k(){var b=a("video");n.forEach(function(a){b.off(a.name,a.listener)}),n=[]}function l(b){return a(d.findElement(b))}function m(a,b){a.prop("currentTime",b)}var n=[],o="timeupdate",p=["play","pause"],q=3e3;c.on("reinitialize",function(){k(),e()}),c.on("ui-ready",e),c.on("close",k),c.hub.on("video-timeupdate",function(a){var b=l(a.location),c=b.prop("currentTime"),d=a.position;j(c,d)&&m(b,a.position)}),p.forEach(function(a){c.hub.on("video-"+a,function(b){var c=l(b.location);m(c,b.position),c.trigger(a,{silent:!0})})})}),c("walkthrough",["util","ui","jquery","windowing","templates","templating","session","peers"],function(a,b,c,d,e,f,g,h){function i(a){q.hide(),c(q[a]).show();var b=p.find("#togetherjs-walkthrough-progress .togetherjs-walkthrough-slide-progress");b.removeClass("togetherjs-active"),c(b[a]).addClass("togetherjs-active");var d=c("#togetherjs-walkthrough-next").removeClass("togetherjs-disabled"),e=c("#togetherjs-walkthrough-previous").removeClass("togetherjs-disabled");a==q.length-1?d.addClass("togetherjs-disabled"):0===a&&e.addClass("togetherjs-disabled")}function j(){var a=l();a--,0>a&&(a=0),i(a)}function k(){var a=l();a++,a>=q.length&&(a=q.length-1),i(a)}function l(){var a=q.filter(":visible");if(!a.length)return 0;for(var b=0;b<q.length;b++)if(q[b]==a[0])return b;return 0}var m=a.assert,n=a.Module("walkthrough"),o=null,p=null,q=null;return n.start=function(a,l){if(!p){p=c(e.walkthrough),p.hide(),b.container.append(p),q=p.find(".togetherjs-walkthrough-slide"),q.hide();var n=c("#togetherjs-walkthrough-progress");q.each(function(a){var b=f.sub("walkthrough-slide-progress");n.append(b),b.click(function(){i(a)})}),p.find("#togetherjs-walkthrough-previous").click(j),p.find("#togetherjs-walkthrough-next").click(k),b.prepareShareLink(p),p.find(".togetherjs-self-name").bind("keyup",function(a){var b=c(a.target).val();h.Self.update({name:b})}),p.find(".togetherjs-swatch").click(function(){var a=c("#togetherjs-pick-color");if(a.is(":visible"))return void a.hide();a.show(),a.find(".togetherjs-swatch-active").removeClass("togetherjs-swatch-active"),a.find('.togetherjs-swatch[data-color="'+h.Self.color+'"]').addClass("togetherjs-swatch-active");var b=p.find(".togetherjs-swatch").offset();a.css({top:b.top,left:b.left-7})}),g.isClient?(p.find(".togetherjs-if-creator").remove(),p.find(".togetherjs-ifnot-creator").show()):(p.find(".togetherjs-if-creator").show(),p.find(".togetherjs-ifnot-creator").remove()),TogetherJS.config.track("siteName",function(a){a=a||document.title,p.find(".togetherjs-site-name").text(a)}),b.activateAvatarEdit(p,{onSave:function(){p.find("#togetherjs-avatar-when-saved").show(),p.find("#togetherjs-avatar-when-unsaved").hide()},onPending:function(){p.find("#togetherjs-avatar-when-saved").hide(),p.find("#togetherjs-avatar-when-unsaved").show()}}),h.Self.update({}),g.emit("new-element",p)}m("boolean"==typeof a,"You must provide a firstTime boolean parameter"),a?(p.find(".togetherjs-walkthrough-firsttime").show(),p.find(".togetherjs-walkthrough-not-firsttime").hide()):(p.find(".togetherjs-walkthrough-firsttime").hide(),p.find(".togetherjs-walkthrough-not-firsttime").show()),o=l,i(0),d.show(p)},n.stop=function(){d.hide(p),o&&(o(),o=null)},g.on("hide-window",function(){o&&(o(),o=null)}),n}),c("webrtc",["require","jquery","util","session","ui","peers","storage","windowing"],function(a,b,c,d,e,f,g,h){function i(){if(window.webkitRTCPeerConnection)return new webkitRTCPeerConnection({iceServers:[{url:"stun:stun.l.google.com:19302"}]},{optional:[{DtlsSrtpKeyAgreement:!0}]});if(window.mozRTCPeerConnection)return new mozRTCPeerConnection({iceServers:[{url:"stun:23.21.150.121"}]},{optional:[]});throw new c.AssertionError("Called makePeerConnection() without supported connection")}function j(a){if(!window.mozRTCPeerConnection)return a;for(var b=a.split("\r\n"),c=[],d=0;d<b.length;d++)c.push(b[d]),-1!==b[d].search("m=")&&c.push("a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA");return a=c.join("\r\n")}function k(a,b,c){c=c||function(a){console.error("Error in getUserMedia:",a)},(navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia).call(navigator,a,b,c)}function l(a){e.displayToggle(a),"#togetherjs-audio-incoming"==a?b("#togetherjs-audio-button").addClass("togetherjs-animated").addClass("togetherjs-color-alert"):b("#togetherjs-audio-button").removeClass("togetherjs-animated").removeClass("togetherjs-color-alert")
}var m=c.Module("webrtc"),n=c.assert;if(d.RTCSupported=!!(window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection),d.RTCSupported&&b.browser.mozilla&&parseInt(b.browser.version,10)<=19)try{!function(){new window.mozRTCPeerConnection}()}catch(o){d.RTCSupported=!1}var p={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};window.mozRTCPeerConnection&&(p.mandatory.MozDontOfferDataChannel=!0);var q=window.webkitURL||window.URL,r=window.mozRTCSessionDescription||window.webkitRTCSessionDescription||window.RTCSessionDescription,s=window.mozRTCIceCandidate||window.webkitRTCIceCandidate||window.RTCIceCandidate;return d.on("ui-ready",function(){function a(a){j=a,l.attr("src",j),m.attr("disabled",null)}function g(){k({video:!0,audio:!1},function(a){t=!0,r[0].src=q.createObjectURL(a),r[0].play()},function(a){console.error("getUserMedia error:",a)})}function h(){n(t);var c=r[0].videoHeight,e=r[0].videoWidth;e*=d.AVATAR_SIZE/c,c=d.AVATAR_SIZE;var f=b("<canvas>");f[0].height=d.AVATAR_SIZE,f[0].width=d.AVATAR_SIZE;var g=f[0].getContext("2d");g.arc(d.AVATAR_SIZE/2,d.AVATAR_SIZE/2,d.AVATAR_SIZE/2,0,2*Math.PI),g.closePath(),g.clip(),g.drawImage(r[0],(d.AVATAR_SIZE-e)/2,0,e,c),a(f[0].toDataURL("image/png"))}function i(a,c){var e=b("<canvas>");e[0].height=d.AVATAR_SIZE,e[0].width=d.AVATAR_SIZE;var f=e[0].getContext("2d"),g=new Image;g.src=a,setTimeout(function(){var a=g.naturalWidth||g.width,b=g.naturalHeight||g.height;a*=d.AVATAR_SIZE/b,b=d.AVATAR_SIZE,f.drawImage(g,0,0,a,b),c(e[0].toDataURL("image/png"))})}b("#togetherjs-self-avatar").click(function(){var a=f.Self.avatar;a&&l.attr("src",a),e.displayToggle("#togetherjs-avatar-edit")}),d.RTCSupported||b("#togetherjs-avatar-edit-rtc").hide();var j=null,l=b("#togetherjs-self-avatar-preview"),m=b("#togetherjs-self-avatar-accept"),o=b("#togetherjs-self-avatar-cancel"),p=b("#togetherjs-avatar-use-camera"),r=b("#togetherjs-avatar-video"),s=b("#togetherjs-avatar-upload");p.click(function(){return t?void h():void g()}),m.click(function(){f.Self.update({avatar:j}),e.displayToggle("#togetherjs-no-avatar-edit"),b("#togetherjs-participants-other").show(),m.attr("disabled","1")}),o.click(function(){e.displayToggle("#togetherjs-no-avatar-edit"),b("#togetherjs-participants-other").show()});var t=!1;s.on("change",function(){var b=new FileReader;b.onload=function(){var b="data:image/jpeg;base64,"+c.blobToBase64(this.result);i(b,function(b){a(b)})},b.onerror=function(){console.error("Error reading file:",this.error)},b.readAsArrayBuffer(this.files[0])})}),d.on("ui-ready",function(){function a(){return y=!0,g.settings.get("dontShowRtcInfo").then(function(a){a||h.show("#togetherjs-rtc-info")}),x?(z||u(),void v()):void f(u)}function c(){console.warn.apply(console,arguments);for(var a="",c=0;c<arguments.length;c++){a&&(a+=" ");var d=arguments[c];if("string"==typeof d)a+=d;else{var e;try{e=JSON.stringify(d)}catch(f){}e||(e=""+d),a+=e}}l("#togetherjs-audio-error"),b("#togetherjs-audio-error").attr("title",a)}function f(a){k({video:!1,audio:!0},function(b){x=b,m("#togetherjs-local-audio",b),a&&a()},function(a){a&&1==a.code||c("getUserMedia error:",a)})}function m(a,c){a=b(a)[0],console.log("Attaching",c,"to",a),window.mozRTCPeerConnection?(a.mozSrcObject=c,a.play()):(a.autoplay=!0,a.src=q.createObjectURL(c))}function o(){if(n(x),H)return H;try{H=i()}catch(a){throw c("Error creating PeerConnection:",a),a}return H.onaddstream=function(a){console.log("got event",a,a.type),m(A,a.stream),l("#togetherjs-audio-active")},H.onstatechange=function(){console.log("state change",H.readyState),"closed"==H.readyState&&l("#togetherjs-audio-ready")},H.onicecandidate=function(a){a.candidate&&d.send({type:"rtc-ice-candidate",candidate:{sdpMLineIndex:a.candidate.sdpMLineIndex,sdpMid:a.candidate.sdpMid,candidate:a.candidate.candidate}})},H.addStream(x),H}function t(){I&&(console.log("adding ice",I),H.addIceCandidate(new s(I)))}function u(){var a=o();if(C&&!D)return void a.setRemoteDescription(new r({type:"offer",sdp:C}),function(){D=!0,t(),u()},function(a){c("Error doing RTC setRemoteDescription:",a)});if(B||C){if(!E&&!F){var b=setTimeout(function(){E||c("createAnswer Timed out; reload or restart browser")},2e3);a.createAnswer(function(e){e.sdp=j(e.sdp),clearTimeout(b),a.setLocalDescription(e,function(){d.send({type:"rtc-answer",answer:e.sdp}),E=e},function(a){clearTimeout(b),c("Error doing RTC setLocalDescription:",a)},p)},function(a){c("Error doing RTC createAnswer:",a)})}}else a.createOffer(function(b){console.log("made offer",b),b.sdp=j(b.sdp),a.setLocalDescription(b,function(){d.send({type:"rtc-offer",offer:b.sdp}),B=b,l("#togetherjs-audio-outgoing")},function(a){c("Error doing RTC setLocalDescription:",a)},p)},function(a){c("Error doing RTC createOffer:",a)})}function v(){}function w(){E=F=B=C=null,G=D=!1,H=null,A[0].removeAttribute("src")}if(b("#togetherjs-audio-button").click(function(){return b("#togetherjs-rtc-info").is(":visible")?void h.hide():void(d.RTCSupported?a():h.show("#togetherjs-rtc-not-supported"))}),!d.RTCSupported)return void l("#togetherjs-audio-unavailable");l("#togetherjs-audio-ready");var x=null,y=!1,z=!1,A=b("#togetherjs-audio-element"),B=null,C=null,D=!1,E=null,F=null,G=!1,H=null,I=null;e.container.find("#togetherjs-rtc-info .togetherjs-dont-show-again").change(function(){g.settings.set("dontShowRtcInfo",this.checked)}),d.hub.on("rtc-offer",function(a){function b(){var a=o();a.setRemoteDescription(new r({type:"offer",sdp:C}),function(){D=!0,t(),u()},function(a){c("Error doing RTC setRemoteDescription:",a)})}return(C||E||F||B)&&w(),C=a.offer,y?void(x?b():f(b)):void l("#togetherjs-audio-incoming")}),d.hub.on("rtc-answer",function(a){if(E||F||C||!B)return w(),void d.send({type:"rtc-abort"});F=a.answer,n(B),n(x);var b=o();b.setRemoteDescription(new r({type:"answer",sdp:F}),function(){G=!0,u()},function(a){c("Error doing RTC setRemoteDescription:",a)})}),d.hub.on("rtc-ice-candidate",function(a){I=a.candidate,(D||G)&&t()}),d.hub.on("rtc-abort",function(){w(),y&&(x?u():f(function(){u()}))}),d.hub.on("hello",function(){l("#togetherjs-audio-ready"),y&&(B||E)&&(w(),u())})}),m}),c("who",["util","channels","session","ui"],function(a,b,c,d){var e=a.assert,f=a.Module("who"),g=5e3,h=2e3;return f.getList=function(c){return a.Deferred(function(a){function d(){n&&clearTimeout(n),i&&clearTimeout(i),j.close(),a.resolve(k)}var e,i,j=b.WebSocketChannel(c),k={},l=0,m=0;j.onmessage=function(b){"init-connection"==b.type&&(e=b.peerCount),"who"==b.type&&(m=setTimeout(function(){d()},h)),"hello-back"==b.type&&(k[b.clientId]||(k[b.clientId]=f.ExternalPeer(b.clientId,b),l++,e&&l>=e?d():a.notify(k))),console.log("users",k)},j.send({type:"who","server-echo":!0,clientId:null});var n=setTimeout(function(){d()},g)})},f.invite=function(d,e){return a.Deferred(function(f){var g=b.WebSocketChannel(d),h=a.generateId();g.onmessage=function(a){"invite"==a.type&&a.inviteId==h&&(g.close(),f.resolve())};var i=c.makeHelloMessage(!1);delete i.type,i.clientId=c.clientId,g.send({type:"invite",inviteId:h,url:c.shareUrl(),userInfo:i,forClientId:e,clientId:null,"server-echo":!0})})},f.ExternalPeer=a.Class({isSelf:!1,isExternal:!0,constructor:function(a,b){b=b||{},e(a),this.id=a,this.identityId=b.identityId||null,this.status=b.status||"live",this.idle=b.status||"active",this.name=b.name||null,this.avatar=b.avatar||null,this.color=b.color||"#00FF00",this.lastMessageDate=0,this.view=d.PeerView(this)},className:function(b){return b=b||"",b+a.safeClassName(this.id)}}),f}),c("youtubeVideos",["jquery","util","session","elementFinder"],function(a,b,c,d){function e(){function b(){var b=a("iframe");b.each(function(b,c){-1==(a(c).attr("src")||"").indexOf("youtube")||a(c).attr("id")||(a(c).attr("id","youtube-player"+b),a(c).attr("enablejsapi",1),m[b]=c)})}function c(b){var c=b.target,d=c.a;if(!a(d).data("togetherjs-player")){a(d).data("togetherjs-player",c),a(d).data("dontPublish",!1);var e=j(c.getVideoUrl());a(d).data("currentVideoId",e)}}if(b(),window.onYouTubeIframeAPIReady=function(){a(m).each(function(a,b){new YT.Player(b.id,{events:{onReady:c,onStateChange:f}})})},void 0===window.YT){var d=document.createElement("script");d.src="https://www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e)}else onYouTubeIframeAPIReady()}function f(b){var e=b.target,f=e.a,h=a(f).data("togetherjs-player"),j=e.k.currentTime,k=d.elementLocation(f);if(a(h).data("seek"))return void a(h).removeData("seek");if(a(f).data("dontPublish"))return void a(f).data("dontPublish",!1);if(b.data==YT.PlayerState.PLAYING){var l=i(f);l?(g(k,l),a(f).data("currentVideoId",l)):c.send({type:"playerStateChange",element:k,playerState:1,playerTime:j})}else{if(b.data!=YT.PlayerState.PAUSED)return;c.send({type:"playerStateChange",element:k,playerState:2,playerTime:j})}}function g(a,b){c.send({type:"differentVideoLoaded",videoId:b,element:a})}function h(){m.forEach(function(b){var e=a(b).data("togetherjs-player"),f=j(e.getVideoUrl()),g=e.getPlayerState(),h=e.getCurrentTime(),i=d.elementLocation(b);c.send({type:"synchronizeVideosOfLateGuest",element:i,videoId:f,playerState:g,playerTime:h})})}function i(b){var c=a(b).data("currentVideoId"),d=a(b).data("togetherjs-player"),e=j(d.getVideoUrl());return e!=c?e:!1}function j(a){var b=a.split("v=")[1],c=b.indexOf("&");return-1!=c&&(b=b.substring(0,c)),b}function k(a,b){var c=Math.abs(a-b),d=1e3*c;return d>l}var l=3e3,m=[],n=2e3;c.on("reinitialize",function(){TogetherJS.config.get("youtube")&&e()}),c.on("close",function(){a(m).each(function(b,c){a(c).removeData("togetherjs-player"),a(c).removeData("dontPublish"),a(c).removeData("currentVideoId"),a(c).removeAttr("enablejsapi");var d=a(c).attr("id")||"";0===d.indexOf("youtube-player")&&a(c).removeAttr("id"),m=[]})}),TogetherJS.config.track("youtube",function(a,b){a&&!b&&(e(),TogetherJS.config.close("youtube"))}),c.hub.on("playerStateChange",function(b){var c=d.findElement(b.element),e=a(c).data("togetherjs-player"),f=e.getCurrentTime(),g=e.getPlayerState();g!=b.playerState&&a(c).data("dontPublish",!0),1==b.playerState?(e.playVideo(),k(f,b.playerTime)&&e.seekTo(b.playerTime,!0)):2==b.playerState&&(e.pauseVideo(),k(f,b.playerTime)&&(a(e).data("seek",!0),e.seekTo(b.playerTime,!0)))}),c.hub.on("hello",function(){setTimeout(h,n)}),c.hub.on("synchronizeVideosOfLateGuest",function(b){var c=d.findElement(b.element),e=a(c).data("togetherjs-player"),f=a(c).data("currentVideoId");b.videoId!=f?(a(c).data("currentVideoId",b.videoId),e.loadVideoById(b.videoId,b.playerTime,"default")):5!=b.playerState&&e.seekTo(b.playerTime,!0)}),c.hub.on("differentVideoLoaded",function(b){var c=d.findElement(b.element),e=a(c).data("togetherjs-player");e.loadVideoById(b.videoId,0,"default"),a(c).data("currentVideoId",b.videoId)})}),TogetherJS.require=TogetherJS._requireObject=b,TogetherJS._loaded=!0,b(["session"])}();